;1	08.12.2016 13:38:32	jlawrie2	
X0 24e32f4 0 24e5168 0 0 0 0

X0 24e5168 24e32f4 24e69a8 0 0 0 0
-- All Test Cases --
X0 24e69a8 24e5168 24e6a70 24e6d00 0 0 0
-- Premium Solve Results --
X39 24e6a70 24e69a8 0 0 0 0 2
Solve Test Initial Premium Guess
0//'Solve Test Initial Premium Guess'(1000000; "C"; 1000000; 65; 65; 3.5; 0.01; 0.001; 999)
0
INPUT Policy ProductCode
UL1PA
INPUT TransEffDate
01/01/2006
INPUT Calling System
I1
INPUT Policy CarrierCode
00
INPUT Policy Jurisdiction
51
INPUT Policy EffDate
01/01/2006
INPUT Policy Coverage ProductCode
UL1PA
INPUT Policy Coverage IndicatorCode
1
INPUT Policy Coverage LifeCovTypeCode
9
INPUT Policy LifeParticipant IssueAge
35
INPUT Policy LifeParticipant IssueGender
1
INPUT Policy LifeParticipant UnderwritingClass
1
INPUT Policy LifeParticipant TobaccoPremiumBasis
1
INPUT Policy Coverage BandCode
3
INPUT Policy Coverage DeathBenefitOptType
1
INPUT Policy LifeParticipant PermTableRating
1
INPUT Policy LifeParticipant PermFlatExtraAmount
0
INPUT Policy LifeParticipant TempFlatExtraAmount
0
INPUT Policy LifeParticipant number of SubstandardRating
0
INPUT Message Language
9
INPUT Policy number of Coverage
1
INPUT Policy Coverage CurrentNumberOfUnits
1000
INPUT Policy Coverage LifeCovStatus
1
INPUT Policy Coverage EffDate
01/01/2006
INPUT Policy Coverage TermDate
01/01/2071
INPUT Policy Coverage TargetPremAmount
1000000
INPUT Policy number of CoverageOption
0
INPUT Calling Program
VPMSTEST
INPUT Illus FaceAmtDesignType
1000500001
INPUT Policy Coverage TargetPremAmt
1000
INPUT Policy ProductVersionCode

INPUT Policy Coverage RequestedMaturityDur
20
INPUT Policy Coverage ProductVersionCode
1
INPUT Policy LifeParticipant PermFlatExtraAmt
0
INPUT Policy LifeParticipant TempFlatExtraAmt
0
INPUT Policy Coverage RequestedEffDur
1
INPUT Policy ProductType
0
INPUT Policy LifeParticipant SpecialClassCode
0
X38 24e6d00 24e5168 0 24e7490 0 0 2
Solve Test Initial Premium Guess
0//'Solve Test Initial Premium Guess'(1000000; "GLP"; 1000000; 65; 65; 4; 0.01; 0.001; 999)
0
INPUT Policy Coverage ProductCode
UL1PA
INPUT Policy EffDate
01/01/2006
INPUT Calling System
I1
INPUT Policy CarrierCode
00
INPUT Policy Jurisdiction
1000
INPUT Policy Coverage IndicatorCode
1
INPUT Policy Coverage EffDate
01/01/2006
INPUT Policy ProductCode
UL1PA
INPUT Policy Coverage LifeCovTypeCode
9
INPUT TransEffDate
01/01/2006
INPUT Policy LifeParticipant IssueAge
35
INPUT Policy LifeParticipant IssueGender
1
INPUT Policy LifeParticipant UnderwritingClass
1
INPUT Policy LifeParticipant TobaccoPremiumBasis
1
INPUT Policy Coverage BandCode
3
INPUT Policy Coverage DeathBenefitOptType
1
INPUT Policy LifeParticipant PermTableRating
1
INPUT Policy LifeParticipant PermFlatExtraAmount
0
INPUT Policy LifeParticipant TempFlatExtraAmount
0
INPUT Policy LifeParticipant number of SubstandardRating
0
INPUT Message Language
9
INPUT Policy number of Coverage
1
INPUT Policy Coverage LifeCovStatus
1
INPUT Policy Coverage TermDate
01/01/2071
INPUT Policy Coverage CurrentNumberOfUnits
1000
INPUT Policy number of CoverageOption
0
INPUT Policy Coverage TargetPremAmount
1000
INPUT Calling Program
VPMSTEST
INPUT Illus FaceAmtDesignType
1000500001
INPUT Policy Coverage TargetPremAmt
1000
INPUT Policy ProductVersionCode

INPUT Policy Coverage RequestedMaturityDur
20
INPUT Policy Coverage ProductVersionCode
1
INPUT Policy LifeParticipant PermFlatExtraAmt
0
INPUT Policy LifeParticipant TempFlatExtraAmt
0
INPUT Policy Coverage RequestedEffDur
1
INPUT Policy ProductType
0
X1 24e7490 24e5168 0 0 0 0 2
Duration Year
'Duration Year'("01/01/2008"; "01/01/2006")
3
O0 24e31a4 0 0 0 0 0 0

E0 24e3214 0 0 0 0 0 0

L0 24e3284 0 0 0 0 0 0

B0 24e3444 0 0 0 0 0 0

P3 24e3364 0 24e7f68 0 0 0 2

--description
Common sub-model containing common premium solve functions used throughout the models.Š ŠPremium solve, initial premium guess, vector extraction, and test/debug functions are some of the functionality included here.Š ŠRELEASE LOG:ŠRELEASE 1301 - SCARAB/JIRA issues PAD1213ŠRELEASE 1301 - PAC029 Integrated Term RiderŠRELEASE 1301 - wmA-J DevelopmentŠRELEASE wmA 1001 - ENH922ŠRELEASE 1101 - PAC013 calcType
LICENSENAME
"csc us internal use only - workbench"
COMPILERVERSION
"4.5.4"
P13 24e7f68 24e3364 0 0 0 0 2
Solve Model
IncType
mandatory
IncRule

IncValue

OUTPUT Comment
"Model:   Common solve model.  Contains functions for iterative solves.Š Author:  John HeumannŠ Date:     12/04/2006 Š Modification Log:Š Date              Modeler               Change DescriptionŠ 12/04/2006     John Heumann     Created model.Š"
OUTPUT Runtime Version
"1.0.0"
OUTPUT Runtime Date
"04/22/2016"
OUTPUT Source Version Computer
"VPMS_SERVER"
OUTPUT Source Version File
"Solve.pms"
OUTPUT Source Version Number
'GEN VersionInfo'
OUTPUT Source Version Date
"04/22/2016"
OUTPUT Source Version Author
"CC"
OUTPUT Source Version Comment
"PA1603 Delivery"
OUTPUT Audit History Block
"04/22/2016 PA1601 Delivery"
F0 24e33d4 0 24e83b0 0 0 0 0

F1 24e83b0 24e33d4 24e8338 0 0 0 2
:Solve
Funktion

F1 24e8338 24e83b0 24e84f8 2648198 0 0 2
-- Premium Solve Test Functions --
Funktion

F1 24e84f8 24e8338 24e85b0 24e8f60 0 0 2
Solve Test Initial Premium Guess(baseFace; calcType; targetCashValue; targetDuration; premiumDuration; int_rate; cashValueTolerance; premiumValueTolerance; stopIteration)
Funktion
'Solve Initial Premium Guess'('SharedVector SolveParms MakeFaceAmount'(calcType;baseFace);v_(calcType;targetCashValue;targetDuration;premiumDuration;int_rate;cashValueTolerance;premiumValueTolerance;stopIteration;'Solve Test CVAddlInfo Vector'(calcType)))
F1 24e85b0 24e84f8 24e8668 24e8840 0 0 2
Solve Test Init Guess Annualize PV Charges(baseFace; calcType; targetCashValue; targetDuration; premiumDuration; int_rate; cashValueTolerance; premiumValueTolerance; stopIteration)
Funktion
'Solve Init Guess Annualize PV Charges'(baseFace;v_(calcType;targetCashValue;targetDuration;premiumDuration;int_rate;cashValueTolerance;premiumValueTolerance;stopIteration;'Solve Test CVAddlInfo Vector'(calcType)))
F1 24e8668 24e85b0 0 0 0 0 2
Solve Test Init Guess Total Charges(baseFace; calcType; targetCashValue; targetDuration; premiumDuration; int_rate; cashValueTolerance; premiumValueTolerance; stopIteration; yearIndex)
Funktion
'Solve Init Guess Total Charges'(baseFace;v_(calcType;targetCashValue;targetDuration;premiumDuration;int_rate;cashValueTolerance;premiumValueTolerance;stopIteration;'Solve Test CVAddlInfo Vector'(calcType));yearIndex)
F1 24e8840 24e84f8 24e8a18 0 0 0 2
Solve Test Annualize PV Payment Factor(calcType; targetCashValue; targetDuration; premiumDuration; int_rate; cashValueTolerance; premiumValueTolerance; stopIteration)
Funktion
'Solve Init Guess Annualize PV Payment Factor'(v_(calcType;targetCashValue;targetDuration;premiumDuration;int_rate;cashValueTolerance;premiumValueTolerance;stopIteration;'Solve Test CVAddlInfo Vector'(calcType));'GEN Vector Blank')
F1 24e8a18 24e8840 0 24e8d28 0 0 2
Solve Test Net Premium Factor(baseFace; calcType; targetCashValue; targetDuration; premiumDuration; int_rate; cashValueTolerance; premiumValueTolerance; stopIteration; yearIndex)
Funktion
'Solve Net Premium Factor'(v_(calcType;targetCashValue;targetDuration;premiumDuration;int_rate;cashValueTolerance;premiumValueTolerance;stopIteration;'GEN Vector Blank');yearIndex;1)
F1 24e8d28 24e8840 0 0 0 0 2
SLV Test Premium Load Premium Guess(baseFace; calcType; targetCashValue; targetDuration; premiumDuration; int_rate; cashValueTolerance; premiumValueTolerance; stopIteration; yearIndex)
Funktion
'SLV IG Premium Load Premium Guess'(calcType;baseFace;v_(calcType;targetCashValue;targetDuration;premiumDuration;int_rate;cashValueTolerance;premiumValueTolerance;stopIteration;'GEN Vector Blank'))
F1 24e8f60 24e8338 24e9bd8 24e9d88 0 0 2
Solve Test Iterative Premium Solve(baseFace; calcType; targetCashValue; targetDuration; premiumDuration; int_rate; cashValueTolerance; premiumValueTolerance; stopIteration; elemNum)
Funktion
e_('Solve Iterative Premium Solve Rec'( // Current premium guessŠ'Solve Initial Premium Guess'('SharedVector SolveParms MakeFaceAmount'(calcType;baseFace);'Vector SLV Premium Solve Search Criteria'(calcType;targetCashValue;targetDuration;premiumDuration;int_rate;cashValueTolerance;premiumValueTolerance;stopIteration;'Solve Test CVAddlInfo Vector'(calcType))); // Current cash valueŠ'CVProjection Monthly End Of Month Cash Value Rec'(calcType;'SharedVector SolveParms MakePremium'('Solve Initial Premium Guess'('SharedVector SolveParms MakeFaceAmount'(calcType;baseFace);'Vector SLV Premium Solve Search Criteria'(calcType;targetCashValue;targetDuration;premiumDuration;int_rate;cashValueTolerance;premiumValueTolerance;stopIteration;'Solve Test CVAddlInfo Vector'(calcType)));premiumDuration);int_rate;'Solve Test CVAddlInfo Vector'(calcType);targetDuration;12);0; //prev prem guessŠ0; //prevCashValueŠ'Solve Initial Premium Guess'('SharedVector SolveParms MakeFaceAmount'(calcType;baseFace);'Vector SLV Premium Solve Search Criteria'(calcType;targetCashValue;targetDuration;premiumDuration;int_rate;cashValueTolerance;premiumValueTolerance;stopIteration;'Solve Test CVAddlInfo Vector'(calcType))) * 0.9; //low boundŠ'Solve Initial Premium Guess'('SharedVector SolveParms MakeFaceAmount'(calcType;baseFace);'Vector SLV Premium Solve Search Criteria'(calcType;targetCashValue;targetDuration;premiumDuration;int_rate;cashValueTolerance;premiumValueTolerance;stopIteration;'Solve Test CVAddlInfo Vector'(calcType))) * 1.1; //low boundŠ1;'Vector SLV Premium Solve Search Criteria'( //vectorSearchCriteriaŠv_(calcType;0;0);targetCashValue;targetDuration;premiumDuration;int_rate;cashValueTolerance;premiumValueTolerance;stopIteration;'Solve Test CVAddlInfo Vector'(calcType));'SharedVector SolveParms MakeFaceAmount'(calcType;baseFace));elemNum //element no. to be extracted from the vector that the f_Iterative_Premium_Solve_Rec function returnsŠ) // i.e from v_(currPremGuess; currCashValue; lowBound; highBound; iteration_num)Š
F1 24e9bd8 24e8f60 0 0 0 0 2
Solve Test CVAddlInfo Vector(calcType)
Funktion
V_(0;0;0;'GEN Vector Blank';0;'GEN Vector Blank';IF ('CalcType LTGT Is Active'(calcType) ; Š  'GEN Vector Blank' ; Š   // Else‰ŠVECTORX(cov;0;'Policy Number Of Coverage'(calcType;TransEffDur) - 1;V_('Policy Coverage TargetPremAmt'(#cov);#cov + 1))Š);'Duration Year'(TransEffDate;'Policy EffDate');1)
F1 24e9d88 24e8338 24e9e40 0 0 0 2
Solve Test FuncRef Iterative Premium Solve(baseFace; calcType; targetCashValue; targetDuration; premiumDuration; int_rate; cashValueTolerance; premiumValueTolerance; stopIteration; elemNum)
Funktion
e_('Solve Test Iterative Premium Solve Rec'( // Current premium guessŠ'Solve Initial Premium Guess'('SharedVector SolveParms MakeFaceAmount'(calcType;baseFace);'Vector SLV Premium Solve Search Criteria'(calcType;targetCashValue;targetDuration;premiumDuration;int_rate;cashValueTolerance;premiumValueTolerance;stopIteration;v_(0;0;0;'GEN Vector Blank';0;'GEN Vector Blank';'GEN Vector Blank'))); // Current cash valueŠ'Solve Test CV Projection'(calcType;'SharedVector SolveParms MakePremium'('Solve Initial Premium Guess'('SharedVector SolveParms MakeFaceAmount'(calcType;baseFace);'Vector SLV Premium Solve Search Criteria'(calcType;targetCashValue;targetDuration;premiumDuration;int_rate;cashValueTolerance;premiumValueTolerance;stopIteration;v_(0;0;0;'GEN Vector Blank';0;'GEN Vector Blank';'GEN Vector Blank')));premiumDuration);int_rate;v_(0;0;0;'GEN Vector Blank';0;'GEN Vector Blank';'GEN Vector Blank');targetDuration;12);0; //prev prem guessŠ0; //prevCashValueŠ0; //low boundŠ'Policy Coverage InitCovAmt'(calcType;0); //high boundŠ1;'Vector SLV Premium Solve Search Criteria'( //vectorSearchCriteriaŠv_(calcType;0;0);targetCashValue;targetDuration;premiumDuration;int_rate;cashValueTolerance;premiumValueTolerance;stopIteration;v_(0;0;0;'GEN Vector Blank';0;'GEN Vector Blank';'GEN Vector Blank')));elemNum //element no. to be extracted from the vector that the f_Iterative_Premium_Solve_Rec function returnsŠ) // i.e from v_(currPremGuess; currCashValue; lowBound; highBound; iteration_num)Š
F1 24e9e40 24e9d88 2648098 0 0 0 2
Solve Test Iterative Premium Solve Rec(currPremGuess; currCashValue; prevPremiumGuess; prevCashValue; lowBound; highBound; iteration_num; vectorSearchCriteria)
Funktion
IF ((ABS(currCashValue - 'Solve Criteria Target CV'(vectorSearchCriteria)) < 'Solve Criteria CV Tolerance'(vectorSearchCriteria)) || (ABS(prevPremiumGuess - currPremGuess) < 'Solve Criteria Premium Tolerance'(vectorSearchCriteria)) || (iteration_num >= 'Solve Criteria Requested Stop Duration'(vectorSearchCriteria)) ; Š   // Either the premium was successfully found, or the requested stop iteration (used for debugging purposes) was reachedŠv_(currPremGuess;currCashValue;prevPremiumGuess;prevCashValue;lowBound;highBound;iteration_num) ; Š   //  Else give up if we can't get a successful result after 100 iterationsŠIF (iteration_num > 100 ; Š    'Messages SystemMessage'("CA1044";'Message Language';'GEN Vector Blank') ; Š     // Else call this function recursively againŠ'Solve Test Iterative Premium Solve Rec'( // New current premium guessŠ'Solve Premium Guess'(currPremGuess;currCashValue;prevPremiumGuess;prevCashValue;'Solve Criteria Target CV'(vectorSearchCriteria);'Solve Criteria Premium Tolerance'(vectorSearchCriteria);lowBound;highBound;iteration_num); // New current cash valueŠ'Solve Test CV Projection'('CalcType SolveCriteria'(vectorSearchCriteria);'SharedVector SolveParms MakePremium'('Solve Premium Guess'(currPremGuess;currCashValue;prevPremiumGuess;prevCashValue;'Solve Criteria Target CV'(vectorSearchCriteria);'Solve Criteria Premium Tolerance'(vectorSearchCriteria);lowBound;highBound;iteration_num);'Solve Criteria Premium Duration'(vectorSearchCriteria));'Solve Criteria Interest Rate'(vectorSearchCriteria;0);'GEN Vector Blank';'Solve Criteria Target Duration'(vectorSearchCriteria);12); // New previous premium guess   ŠcurrPremGuess; // New previous cash valueŠcurrCashValue; // lowBound‰ŠIF (currCashValue < 'Solve Criteria Target CV'(vectorSearchCriteria) ; Š       // Premium guess was too low, increase lower boundŠMAX(lowBound;currPremGuess) ; Š       // Else premium guess was too high.  Keep lower bound the sameŠlowBoundŠ    ); // highBoundŠIF (currCashValue > 'Solve Criteria Target CV'(vectorSearchCriteria) ; Š     // Premium guess was too high, lower high bound‰ŠMIN(highBound;currPremGuess) ; Š     // Else premium guess was too low.  Keep high bound the sameŠhighBoundŠ  );iteration_num + 1;vectorSearchCriteria)Š)Š)
F1 2648098 24e9e40 0 0 0 0 2
Solve Test CV Projection(calcType; vectorSolveParms; projInterestRate; vectorAddlInfo; yearIndex; monthIndex)
Funktion
IF ('CalcType LTGT Is Active'(calcType) ; Š  docall(funcref('CVProjection Annualize EOY Cash Value Rec');calcType;vectorSolveParms;projInterestRate;vectorAddlInfo;yearIndex) ; Š  docall(funcref('CVProjection Monthly End Of Month Cash Value Rec');calcType;vectorSolveParms;projInterestRate;vectorAddlInfo;yearIndex;monthIndex)Š)
F1 2648198 24e83b0 2648360 264b278 0 0 2
-- Premium Solve Functions --
Funktion

F1 2648360 2648198 0 2648f00 0 0 2
Solve Iterative Premium Solve Rec(currPremGuess; currCashValue; prevPremiumGuess; prevCashValue; lowBound; highBound; iteration_num; vectorSearchCriteria; vectorSolveParms)
Funktion
IF ( /*Tolerance reached*/ (ABS(currCashValue - 'Solve Criteria Target CV'(vectorSearchCriteria)) < 'Solve Criteria CV Tolerance'(vectorSearchCriteria)) || (ABS(prevPremiumGuess - currPremGuess) < 'Solve Criteria Premium Tolerance'(vectorSearchCriteria)) || (iteration_num >= 'Solve Criteria Requested Stop Duration'(vectorSearchCriteria)) ; Š   // Either the premium was successfully found, or the requested stop iteration (used for debugging purposes) was reachedŠv_(currPremGuess;currCashValue;prevPremiumGuess;prevCashValue;lowBound;highBound;iteration_num) ; Š   //  Else give up if we can't get a successful result after 100 iterationsŠIF ( /*Too many iterations?*/ iteration_num > 100 ; Š     /*return error message*/ 'Messages SystemMessage'("CA1044";'Message Language';'GEN Vector Blank') ; Š     // Else call this function recursively againŠ'Solve Iterative Premium Solve Rec'( // New current premium guessŠ'Solve Premium Guess'(currPremGuess;currCashValue;prevPremiumGuess;prevCashValue;'Solve Criteria Target CV'(vectorSearchCriteria);'Solve Criteria Premium Tolerance'(vectorSearchCriteria);lowBound;highBound;iteration_num); // New current cash valueŠ'CVProjection Monthly End Of Month Cash Value Rec'('CalcType SolveCriteria'(vectorSearchCriteria);'SharedVector SolveParms ReplacePremium'('Solve Premium Guess'(currPremGuess;currCashValue;prevPremiumGuess;prevCashValue;'Solve Criteria Target CV'(vectorSearchCriteria);'Solve Criteria Premium Tolerance'(vectorSearchCriteria);lowBound;highBound;iteration_num);'Solve Criteria Premium Duration'(vectorSearchCriteria);vectorSolveParms);'Solve Criteria Interest Rate'(vectorSearchCriteria;0);'Solve Criteria Addl Info'(vectorSearchCriteria);'Solve Criteria Target Duration'(vectorSearchCriteria);12); // New previous premium guess   ŠcurrPremGuess; // New previous cash valueŠcurrCashValue; // lowBound‰ŠIF ( /*Premium guess too low*/ currCashValue < 'Solve Criteria Target CV'(vectorSearchCriteria) ; Š       // Premium guess was too low, increase lower boundŠMAX(lowBound;currPremGuess) ; Š       // Else premium guess was too high.  Keep lower bound the sameŠlowBoundŠ    ); // highBoundŠIF ( /*Premium gues too high*/ currCashValue > 'Solve Criteria Target CV'(vectorSearchCriteria) ; Š     // Premium guess was too high, lower high bound‰ŠMIN(highBound;currPremGuess) ; Š     // Else premium guess was too low.  Keep high bound the sameŠhighBoundŠ  );iteration_num + 1;vectorSearchCriteria;vectorSolveParms)Š)Š)
F1 2648f00 2648198 7d5f33e9 2649b68 0 0 2
Solve Iterative Premium Solve Rec2(currPremGuess; currCashValue; prevPremGuess; prevCashValue; lowBound; highBound; iteration_num; vectorSearchCriteria; vectorSolveParms)
Funktion
IF ( /*Tolerance reached*/ (ABS(currCashValue /*- 'Solve Criteria Target CV'(vectorSearchCriteria)*/ ) < 'Solve Criteria CV Tolerance'(vectorSearchCriteria)) || (ABS(currPremGuess - prevPremGuess) < 'Solve Criteria Premium Tolerance'(vectorSearchCriteria)) || (iteration_num >= 'Solve Criteria Requested Stop Duration'(vectorSearchCriteria)) ; Š   // Either the premium was successfully found, or the requested stop iteration (used for debugging purposes) was reachedŠv_(currPremGuess;currCashValue;prevPremGuess;prevCashValue;lowBound;highBound;iteration_num) ; Š   //  Else give up if we can't get a successful result after 100 iterationsŠIF ( /*Too many iterations?*/ iteration_num > 100 ; Š     /*return error message*/ 'Messages SystemMessage'("CA1044";'Message Language';v_('Solve Model Name';"'Solve Iterative Premium Solve Rec2'")) ; Š     // Else call this function recursively againŠ'Solve Iterative Premium Solve Rec2'( // New current premium guessŠ'Solve Premium Guess2'(currPremGuess;currCashValue;prevPremGuess;prevCashValue); // New current cash valueŠ'Solve CashValueSolve for Premium Guess2 Minus Target CV'(currPremGuess;currCashValue;prevPremGuess;prevCashValue;vectorSearchCriteria;vectorSolveParms); // New previous premium guess   Š'Solve Prev Guess'(currPremGuess;currCashValue;prevPremGuess;'Solve CashValueSolve for Premium Guess2 Minus Target CV'(currPremGuess;currCashValue;prevPremGuess;prevCashValue;vectorSearchCriteria;vectorSolveParms);prevCashValue); // New previous cash valueŠ'Solve Prev GuessCV using CashValSolve for Prem Guess2 Minus Tgt CV'(currPremGuess;currCashValue;prevPremGuess;prevCashValue;vectorSearchCriteria;vectorSolveParms); // lowBound‰ŠIF ( /*Premium guess too low*/ currCashValue < 'Solve Criteria Target CV'(vectorSearchCriteria) ; Š       // Premium guess was too low, increase lower boundŠMAX(lowBound;currPremGuess) ; Š       // Else premium guess was too high.  Keep lower bound the sameŠlowBoundŠ    ); // highBoundŠIF ( /*Premium gues too high*/ currCashValue > 'Solve Criteria Target CV'(vectorSearchCriteria) ; Š     // Premium guess was too high, lower high bound‰ŠMIN(highBound;currPremGuess) ; Š     // Else premium guess was too low.  Keep high bound the sameŠhighBoundŠ  );iteration_num + 1;vectorSearchCriteria;vectorSolveParms)Š)Š)
F1 7d5f33e9 2648f00 0 7818ddc2 0 0 2
Solve Prev GuessCV using CashValSolve for Prem Guess2 Minus Tgt CV(currPremGuess; currCashValue; prevPremGuess; prevCashValue; vectorSearchCriteria; vectorSolveParms)
Funktion
'Solve Prev GuessCV'(currCashValue;prevCashValue;'Solve CashValueSolve for Premium Guess2 Minus Target CV'(currPremGuess;currCashValue;prevPremGuess;prevCashValue;vectorSearchCriteria;vectorSolveParms))
F1 7818ddc2 2648f00 0 0 0 0 2
Solve CashValueSolve for Premium Guess2 Minus Target CV(currPremGuess; currCashValue; prevPremGuess; prevCashValue; vectorSearchCriteria; vectorSolveParms)
Funktion
'Solve CashValueSolve'('Solve Premium Guess2'(currPremGuess;currCashValue;prevPremGuess;prevCashValue);'Solve CashValueSolve Constants Vector'(vectorSearchCriteria;vectorSolveParms)) - 'Solve Criteria Target CV'(vectorSearchCriteria)
F1 2649b68 2648198 0 264a6d8 0 0 2
Solve Annualize Iterative Premium Solve Rec(currPremGuess; currCashValue; prevPremiumGuess; prevCashValue; lowBound; highBound; iteration_num; vectorSearchCriteria; vectorSolveParms)
Funktion
IF ( /*tolerance level reached*/ (ABS(currCashValue - 'Solve Criteria Target CV'(vectorSearchCriteria)) < 'Solve Criteria CV Tolerance'(vectorSearchCriteria)) || (ABS(prevPremiumGuess - currPremGuess) < 'Solve Criteria Premium Tolerance'(vectorSearchCriteria)) || (iteration_num >= 'Solve Criteria Requested Stop Duration'(vectorSearchCriteria)) ; Š   // Either the premium was successfully found, or the requested stop iteration (used for debugging purposes) was reachedŠv_(currPremGuess;currCashValue;prevPremiumGuess;prevCashValue;lowBound;highBound;iteration_num) ; Š   //  Else give up if we can't get a successful result after 100 iterationsŠIF ( /*Too many iterations*/ iteration_num > 100 ; Š     /*Yes - return error message*/ 'Messages SystemMessage'("CA1044";'Message Language';'GEN Vector Blank') ; Š     // Else call this function recursively againŠ'Solve Iterative Premium Solve Rec'( // New current premium guessŠ'Solve Premium Guess'(currPremGuess;currCashValue;prevPremiumGuess;prevCashValue;'Solve Criteria Target CV'(vectorSearchCriteria);'Solve Criteria Premium Tolerance'(vectorSearchCriteria);lowBound;highBound;iteration_num); // New current cash valueŠ'CVProjection Annualize EOY Cash Value Rec'('CalcType SolveCriteria'(vectorSearchCriteria);'SharedVector SolveParms ReplacePremium'('Solve Premium Guess'(currPremGuess;currCashValue;prevPremiumGuess;prevCashValue;'Solve Criteria Target CV'(vectorSearchCriteria);'Solve Criteria Premium Tolerance'(vectorSearchCriteria);lowBound;highBound;iteration_num);'Solve Criteria Premium Duration'(vectorSearchCriteria);vectorSolveParms);'Solve Criteria Interest Rate'(vectorSearchCriteria;1);'GEN Vector Blank';'Solve Criteria Target Duration'(vectorSearchCriteria)); // New previous premium guess   ŠcurrPremGuess; // New previous cash valueŠcurrCashValue; // lowBound‰ŠIF ( /*premium guess too low*/ currCashValue < 'Solve Criteria Target CV'(vectorSearchCriteria) ; Š       // Premium guess was too low, increase lower boundŠMAX(lowBound;currPremGuess) ; Š       // Else premium guess was too high.  Keep lower bound the sameŠlowBoundŠ    ); // highBoundŠIF ( /*Premium guess was too high*/ currCashValue > 'Solve Criteria Target CV'(vectorSearchCriteria) ; Š     // Premium guess was too high, lower high bound‰ŠMIN(highBound;currPremGuess) ; Š     // Else premium guess was too low.  Keep high bound the sameŠhighBoundŠ  );iteration_num + 1;vectorSearchCriteria;vectorSolveParms)Š)Š)
F1 264a6d8 2648198 264af28 264afe0 0 0 2
Solve Premium Guess(currPremGuess; currCashValue; prevPremiumGuess; prevCashValue; targetCashValue;premiumTolerance; lowBound; highBound; iteration_num)
Funktion
IF ( /*starting out*/ iteration_num = 1 ; Š   // Determine the next guess based on only the current guess and current cv for the initial guess sinceŠ// the previous guess and previous cv won't be valid for the first iteration.ŠIF ( /*Premium guess too high*/ currCashValue > targetCashValue ; Š     // We're being optimistic that the initial guess will get us within a penny nowŠcurrPremGuess - 0.01 ; Š     /*Try a penny above if the premium guess is too low*/ currPremGuess + 0.01 //currPremGuess - max(sqrt(currCashValue / (targetCashValue+.1) - 1);premiumTolerance); Š//currPremGuess + max(sqrt(1- currCashValue / (targetCashValue+.1));premiumTolerance)ŠŠ  ) ; ŠIF ( /*Use the secant method for iterations 2 through 6*/ iteration_num <= 60 && targetCashValue > 10 ; Š   // Secant method has issues when target cv approaches 0ŠIF ( /*Has guess changed the cash value?*/ currCashValue = prevCashValue ; Š     /*No - stick with what we've got*/ currPremGuess ; Š     /* try again*/ 'Solve Bound Premium Guess'(lowBound;highBound;currPremGuess - ((currCashValue - targetCashValue) * ((currPremGuess - prevPremiumGuess) / (currCashValue - prevCashValue))))Š  ) ; Š // Use the bisection method after iteration 6ŠIF ( /*Premium guess too low*/ currCashValue < targetCashValue ; Š   /*Yes - try higher*/ (MAX(lowBound;currPremGuess) + highBound) * 0.5 ; Š   /*No - try lower*/ (lowBound + MIN(highBound;currPremGuess)) * 0.5Š)Š)Š)
F1 264af28 264a6d8 0 0 0 0 2
Solve Bound Premium Guess(lowBound; highBound; prem_guess)
Funktion
MAX(MIN(highBound;prem_guess);lowBound)
F1 264afe0 2648198 0 e19a616 0 0 2
Vector SLV Premium Solve Search Criteria(calcType; targetCashValue; targetDuration; premiumDuration; int_rate; cashValueTolerance; premiumValueTolerance; stopIteration; vectorAddlInfo)
Funktion
v_(calcType;targetCashValue;targetDuration;premiumDuration;int_rate;cashValueTolerance;premiumValueTolerance;stopIteration;vectorAddlInfo)
F1 e19a616 2648198 0 2ec6dfba 0 0 2
-- Solve Iterative Premium Solve Rec2 FaceSolve(currGuess; currCashValue; prevGuess; prevCashValue; lowBound; highBound; iteration_num; vectorSearchCriteria; vectorSolveParms)
Funktion
IF (/*Tolerance reached*/‰(ABS(currCashValue/* - 'Solve Criteria Target CV'(vectorSearchCriteria)*/ ) < 'Solve Criteria CV Tolerance'(vectorSearchCriteria) )Š‰|| (ABS(currGuess - prevGuess) < 'Solve Criteria Premium Tolerance'(vectorSearchCriteria) )Š‰|| (iteration_num >= 'Solve Criteria Requested Stop Duration'(vectorSearchCriteria) );Š‰// Either the premium was successfully found, or the requested stop iteration (used for debugging purposes) was reachedŠ‰v_(currGuess; currCashValue; prevGuess; prevCashValue; lowBound; highBound; iteration_num);Š‰//  Else give up if we can't get a successful result after 100 iterationsŠ‰IF (/*Too many iterations?*/ iteration_num > 100;Š‰‰/*return error message*/Š‰‰'Messages SystemMessage'("CA1044"; 'Message Language'; v_('Solve Model Name'; "'Solve Iterative Premium Solve Rec2 FaceSolve'"));Š‰‰// Else call this function recursively againŠ‰‰'Solve Iterative Premium Solve Rec2 FaceSolve'(Š‰‰‰// New current premium guessŠ‰‰‰'Solve Premium Guess2'(Š‰‰‰‰currGuess; Š‰‰‰‰currCashValue; Š‰‰‰‰prevGuess; Š‰‰‰‰prevCashValueŠ‰‰‰);Š‰‰‰// New current cash valueŠ‰‰‰'Solve CashValueSolve FaceAmountSolve'(Š‰‰‰‰'Solve Premium Guess2'(Š‰‰‰‰‰currGuess; Š‰‰‰‰‰currCashValue; Š‰‰‰‰‰prevGuess; Š‰‰‰‰‰prevCashValueŠ‰‰‰‰);Š‰‰‰‰'Solve CashValueSolve Constants Vector'(Š‰‰‰‰‰'Solve Criteria Replace GuidelinePremiums'(Š‰‰‰‰‰‰'Solve Criteria Replace Target'(Š‰‰‰‰‰‰‰vectorSearchCriteria;Š‰‰‰‰‰‰‰'Solve Premium Guess2'(Š‰‰‰‰‰‰‰‰currGuess; Š‰‰‰‰‰‰‰‰currCashValue; Š‰‰‰‰‰‰‰‰prevGuess; Š‰‰‰‰‰‰‰‰prevCashValueŠ‰‰‰‰‰‰‰)Š‰‰‰‰‰‰);Š‰‰‰‰‰‰'Solve Premium Guess2'(Š‰‰‰‰‰‰‰‰currGuess; Š‰‰‰‰‰‰‰‰currCashValue; Š‰‰‰‰‰‰‰‰prevGuess; Š‰‰‰‰‰‰‰‰prevCashValueŠ‰‰‰‰‰‰‰)Š‰‰‰‰‰);Š‰‰‰‰‰vectorSolveParmsŠ‰‰‰‰)Š‰‰‰)Š‰‰‰-Š‰‰‰'Solve FaceSolve Target Value'(currGuess; currCashValue; prevGuess; prevCashValue; vectorSearchCriteria);Š‰‰‰// New previous premium guess   Š‰‰‰'Solve Prev Guess'(currGuess; currCashValue; prevGuess;Š‰‰‰‰'Solve CashValueSolve FaceAmountSolve'(Š‰‰‰‰‰'Solve Premium Guess2'(Š‰‰‰‰‰‰currGuess; Š‰‰‰‰‰‰currCashValue; Š‰‰‰‰‰‰prevGuess; Š‰‰‰‰‰‰prevCashValueŠ‰‰‰‰‰);Š‰‰‰‰‰'Solve CashValueSolve Constants Vector'(Š‰‰‰‰‰‰'Solve Criteria Replace GuidelinePremiums'(Š‰‰‰‰‰‰‰'Solve Criteria Replace Target'(Š‰‰‰‰‰‰‰‰vectorSearchCriteria;Š‰‰‰‰‰‰‰‰'Solve Premium Guess2'(Š‰‰‰‰‰‰‰‰‰currGuess; Š‰‰‰‰‰‰‰‰‰currCashValue; Š‰‰‰‰‰‰‰‰‰prevGuess; Š‰‰‰‰‰‰‰‰‰prevCashValueŠ‰‰‰‰‰‰‰‰)Š‰‰‰‰‰‰‰);Š‰‰‰‰‰‰‰'Solve Premium Guess2'(Š‰‰‰‰‰‰‰‰currGuess; Š‰‰‰‰‰‰‰‰currCashValue; Š‰‰‰‰‰‰‰‰prevGuess; Š‰‰‰‰‰‰‰‰prevCashValueŠ‰‰‰‰‰‰‰)Š‰‰‰‰‰‰);Š‰‰‰‰‰‰vectorSolveParmsŠ‰‰‰‰‰)Š‰‰‰‰)Š‰‰‰‰-Š‰‰‰‰'Solve FaceSolve Target Value'(currGuess; currCashValue; prevGuess; prevCashValue; vectorSearchCriteria);prevCashValueŠ‰‰‰);‰Š‰‰‰// New previous cash valueŠ‰‰‰'Solve Prev GuessCV'(currCashValue; prevCashValue;Š‰‰‰‰'Solve CashValueSolve FaceAmountSolve'(Š‰‰‰‰‰'Solve Premium Guess2'(Š‰‰‰‰‰‰currGuess; Š‰‰‰‰‰‰currCashValue; Š‰‰‰‰‰‰prevGuess; Š‰‰‰‰‰‰prevCashValueŠ‰‰‰‰‰);Š‰‰‰‰‰'Solve CashValueSolve Constants Vector'(Š‰‰‰‰‰‰'Solve Criteria Replace GuidelinePremiums'(Š‰‰‰‰‰‰‰'Solve Criteria Replace Target'(Š‰‰‰‰‰‰‰‰vectorSearchCriteria;Š‰‰‰‰‰‰‰‰'Solve Premium Guess2'(Š‰‰‰‰‰‰‰‰‰currGuess; Š‰‰‰‰‰‰‰‰‰currCashValue; Š‰‰‰‰‰‰‰‰‰prevGuess; Š‰‰‰‰‰‰‰‰‰prevCashValueŠ‰‰‰‰‰‰‰‰)Š‰‰‰‰‰‰‰);Š‰‰‰‰‰‰‰'Solve Premium Guess2'(Š‰‰‰‰‰‰‰‰currGuess; Š‰‰‰‰‰‰‰‰currCashValue; Š‰‰‰‰‰‰‰‰prevGuess; Š‰‰‰‰‰‰‰‰prevCashValueŠ‰‰‰‰‰‰‰)Š‰‰‰‰‰‰);Š‰‰‰‰‰‰vectorSolveParmsŠ‰‰‰‰‰)Š‰‰‰‰)Š‰‰‰‰-Š‰‰‰‰'Solve FaceSolve Target Value'(currGuess; currCashValue; prevGuess; prevCashValue; vectorSearchCriteria)Š‰‰‰);Š‰‰‰// lowBound‰Š‰‰‰IF (/*Premium guess too low*/ Š‰‰‰‰currCashValue Š‰‰‰‰< Š‰‰‰‰'Solve Premium Guess2'(Š‰‰‰‰‰currGuess; Š‰‰‰‰‰currCashValue; Š‰‰‰‰‰prevGuess; Š‰‰‰‰‰prevCashValueŠ‰‰‰‰);Š‰‰‰‰// Premium guess was too low, increase lower boundŠ‰‰‰‰MAX(lowBound; currGuess);Š‰‰‰‰// Else premium guess was too high.  Keep lower bound the sameŠ‰‰‰‰lowBoundŠ‰‰‰);Š‰‰‰// highBoundŠ‰‰‰IF (/*Premium gues too high*/ Š‰‰‰‰currCashValueŠ‰‰‰‰> Š‰‰‰‰'Solve Premium Guess2'(Š‰‰‰‰‰currGuess; Š‰‰‰‰‰currCashValue; Š‰‰‰‰‰prevGuess; Š‰‰‰‰‰prevCashValueŠ‰‰‰‰);Š‰‰‰‰// Premium guess was too high, lower high bound‰Š‰‰‰‰MIN(highBound; currGuess);Š‰‰‰‰// Else premium guess was too low.  Keep high bound the sameŠ‰‰‰‰highBoundŠ‰‰‰);Š‰‰‰iteration_num + 1;Š‰‰‰vectorSearchCriteria;Š‰‰‰vectorSolveParmsŠ‰‰)Š‰)Š)
F1 2ec6dfba 2648198 0 0 0 0 2
Solve Iterative Premium Solve Rec2 FaceSolve(currGuess; currCashValue; prevGuess; prevCashValue; lowBound; highBound; iteration_num; vectorSearchCriteria; vectorSolveParms; yearIndex)
Funktion
IF ( /*Tolerance reached*/ (ABS(currCashValue /* - 'Solve Criteria Target CV'(vectorSearchCriteria)*/ ) < 'Solve Criteria CV Tolerance'(vectorSearchCriteria)) || (ABS(currGuess - prevGuess) < 'Solve Criteria Premium Tolerance'(vectorSearchCriteria)) || (iteration_num >= 'Solve Criteria Requested Stop Duration'(vectorSearchCriteria)) ; Š   // Either the premium was successfully found, or the requested stop iteration (used for debugging purposes) was reachedŠv_(currGuess;currCashValue;prevGuess;prevCashValue;lowBound;highBound;iteration_num) ; Š   //  Else give up if we can't get a successful result after 100 iterationsŠIF ( /*Too many iterations?*/ iteration_num > 100 ; Š     /*return error message*/ 'Messages SystemMessage'("CA1044";'Message Language';v_('Solve Model Name';"'Solve Iterative Premium Solve Rec2 FaceSolve'")) ; Š     // Else call this function recursively againŠ'Solve Iterative Premium Solve Rec2 FaceSolve'( // New current premium guessŠ'Solve Premium Guess2'(currGuess;currCashValue;prevGuess;prevCashValue); // New current cash valueŠ'Solve CashValueSolve FaceAmountSolve'('Solve Premium Guess2'(currGuess;currCashValue;prevGuess;prevCashValue);'Solve CashValueSolve Constants Vector'('Solve Criteria Replace GuidelinePremiums'('Solve Criteria Replace Target'(vectorSearchCriteria;'Solve Premium Guess2'(currGuess;currCashValue;prevGuess;prevCashValue);yearIndex);'Solve Premium Guess2'(currGuess;currCashValue;prevGuess;prevCashValue));vectorSolveParms)) - 'Solve FaceSolve Target Value'(currGuess;currCashValue;prevGuess;prevCashValue;vectorSearchCriteria); // New previous premium guess   Š'Solve Prev Guess'(currGuess;currCashValue;prevGuess;'Solve CashValueSolve FaceAmountSolve'('Solve Premium Guess2'(currGuess;currCashValue;prevGuess;prevCashValue);'Solve CashValueSolve Constants Vector'('Solve Criteria Replace GuidelinePremiums'('Solve Criteria Replace Target'(vectorSearchCriteria;'Solve Premium Guess2'(currGuess;currCashValue;prevGuess;prevCashValue);yearIndex);'Solve Premium Guess2'(currGuess;currCashValue;prevGuess;prevCashValue));vectorSolveParms)) - 'Solve FaceSolve Target Value'(currGuess;currCashValue;prevGuess;prevCashValue;vectorSearchCriteria);prevCashValue); // New previous cash valueŠ'Solve Prev GuessCV'(currCashValue;prevCashValue;'Solve CashValueSolve FaceAmountSolve'('Solve Premium Guess2'(currGuess;currCashValue;prevGuess;prevCashValue);'Solve CashValueSolve Constants Vector'('Solve Criteria Replace GuidelinePremiums'('Solve Criteria Replace Target'(vectorSearchCriteria;'Solve Premium Guess2'(currGuess;currCashValue;prevGuess;prevCashValue);yearIndex);'Solve Premium Guess2'(currGuess;currCashValue;prevGuess;prevCashValue));vectorSolveParms)) - 'Solve FaceSolve Target Value'(currGuess;currCashValue;prevGuess;prevCashValue;vectorSearchCriteria)); // lowBound‰ŠIF ( /*Premium guess too low*/ currCashValue < 'Solve Premium Guess2'(currGuess;currCashValue;prevGuess;prevCashValue) ; Š       // Premium guess was too low, increase lower boundŠMAX(lowBound;currGuess) ; Š       // Else premium guess was too high.  Keep lower bound the sameŠlowBoundŠ    ); // highBoundŠIF ( /*Premium gues too high*/ currCashValue > 'Solve Premium Guess2'(currGuess;currCashValue;prevGuess;prevCashValue) ; Š     // Premium guess was too high, lower high bound‰ŠMIN(highBound;currGuess) ; Š     // Else premium guess was too low.  Keep high bound the sameŠhighBoundŠ  );iteration_num + 1;vectorSearchCriteria;vectorSolveParms;yearIndex)Š)Š)
F1 264b278 24e83b0 4ccebd29 26503a8 0 0 2
-- Initial Premium Guess Functions --
Funktion

F1 4ccebd29 264b278 4d47fa73 51cc8c12 0 0 2
-- Initial Premium Guess Using a discounted Maturity Value --
Funktion

F1 4d47fa73 4ccebd29 4d4ee85f 2652450 0 0 2
Solve Target Premium Loads(vectorSolveParms; vectorSearchCriteria; yearIndex; targetLoadInd)
Funktion
IF ('CHG Calc Type Uses Fees'('CalcType SolveCriteria'(vectorSearchCriteria)) ; Š  'Solve Projected Target Premium Load Charge'(1;vectorSearchCriteria;yearIndex;targetLoadInd) + 'Solve Projected Target Premium Load Charge'(2;vectorSearchCriteria;yearIndex;targetLoadInd) + 'Solve Projected Target Premium Load Charge'(3;vectorSearchCriteria;yearIndex;targetLoadInd) ; Š  0Š)
F1 4d4ee85f 4d47fa73 0 0 0 0 2
Solve Projected Target Premium Load Charge(prem_load_rule_num; vectorSearchCriteria; yearIndex; targetLoadInd)
Funktion
'ACCS CV Intermediate Round For CalcType'(CASE( /*Premium load rule*/ 'PLC Premium Load Rule'('CalcType SolveCriteria'(vectorSearchCriteria);prem_load_rule_num;'FeeType PremiumLoad');Š   // Percent of premium for policy lifeŠ"1000500003" : 0;Š   //don't add in premium load nowŠ// No premium load chargeŠ"";"1000500022" : 0;Š   // Percent of premium up to annual target load premiumŠ"1000500005";"1000500007" : IF ( /*Premium load based on Load Target and Loads used in calctype?*/ NOT(targetLoadInd) /*Load target calculation*/  || 'CalcType SolveCriteria Alike LTGT'(vectorSearchCriteria) /*Beyond Premium Duration?*/  || yearIndex > MIN('Solve Criteria Premium Duration'(vectorSearchCriteria);'Solve Criteria Target Duration'(vectorSearchCriteria)) ; Š    0 ; Š    'SLV LoadTargetPremium'(vectorSearchCriteria) * ('PLC Premium Load Primary Rate'('CalcType SolveCriteria'(vectorSearchCriteria);'FeeType PremiumLoad';0;yearIndex) * 0.01 - 'PLC Premium Load Secondary Rate'('CalcType SolveCriteria'(vectorSearchCriteria);'FeeType PremiumLoad';0;yearIndex) * 0.01)Š  );Š // Flat premium load chargeŠ"1000500030" : IF (yearIndex <= MIN('Solve Criteria Premium Duration'(vectorSearchCriteria);'Solve Criteria Target Duration'(vectorSearchCriteria)) ; Š  'PLC Projected Premium Load Rule Flat Amount'('CalcType SolveCriteria'(vectorSearchCriteria);prem_load_rule_num;'FeeType PremiumLoad';yearIndex;100) ; Š   // periodic premium not required for flat amount Š0Š);Š // Else - 0Š : 0)Š;'CalcType SolveCriteria'(vectorSearchCriteria))
F1 2652450 4ccebd29 32323155 2fa2227a 0 0 2
Solve Premium Loads(vectorSolveParms; vectorSearchCriteria; yearIndex)
Funktion
IF ('CHG Calc Type Uses Fees'('CalcType SolveCriteria'(vectorSearchCriteria)) ; Š  'Solve Projected Premium Load Charge'(1;'PREMIUM Projected GrossPremium'('CalcType SolveCriteria'(vectorSearchCriteria);vectorSolveParms;'Solve Criteria Addl Info'(vectorSearchCriteria);yearIndex;1);vectorSearchCriteria;yearIndex) + 'Solve Projected Premium Load Charge'(2;'PREMIUM Projected GrossPremium'('CalcType SolveCriteria'(vectorSearchCriteria);vectorSolveParms;'Solve Criteria Addl Info'(vectorSearchCriteria);yearIndex;1);vectorSearchCriteria;yearIndex) + 'Solve Projected Premium Load Charge'(3;'PREMIUM Projected GrossPremium'('CalcType SolveCriteria'(vectorSearchCriteria);vectorSolveParms;'Solve Criteria Addl Info'(vectorSearchCriteria);yearIndex;1);vectorSearchCriteria;yearIndex) ; Š  0Š)
F1 32323155 2652450 0 0 0 0 2
Solve Projected Premium Load Charge(prem_load_rule_num; periodicPremium; vectorSearchCriteria; yearIndex)
Funktion
'ACCS CV Intermediate Round For CalcType'(CASE( /*Premium load rule*/ 'PLC Premium Load Rule'('CalcType SolveCriteria'(vectorSearchCriteria);prem_load_rule_num;'FeeType PremiumLoad');Š   // Percent of premium for policy lifeŠ"1000500003" : 0;Š   //don't add in premium load nowŠ// No premium load chargeŠ"";"1000500022" : 0;Š   // Percent of premium up to annual target load premiumŠ"1000500005";"1000500007" : IF ( /*Load target calculation*/ 'CalcType SolveCriteria Alike LTGT'(vectorSearchCriteria) /*Beyond Premium Duration?*/  || yearIndex > MIN('Solve Criteria Premium Duration'(vectorSearchCriteria);'Solve Criteria Target Duration'(vectorSearchCriteria)) ; Š    0 ; Š    MIN(periodicPremium;'SLV LoadTargetPremium'(vectorSearchCriteria)) * ('PLC Premium Load Primary Rate'('CalcType SolveCriteria'(vectorSearchCriteria);'FeeType PremiumLoad';0;yearIndex) * 0.01 - 'PLC Premium Load Secondary Rate'('CalcType SolveCriteria'(vectorSearchCriteria);'FeeType PremiumLoad';0;yearIndex) * 0.01)Š  );Š // Flat premium load chargeŠ"1000500030" : IF (yearIndex <= MIN('Solve Criteria Premium Duration'(vectorSearchCriteria);'Solve Criteria Target Duration'(vectorSearchCriteria)) ; Š  'PLC Projected Premium Load Rule Flat Amount'('CalcType SolveCriteria'(vectorSearchCriteria);prem_load_rule_num;'FeeType PremiumLoad';yearIndex;100) ; Š   // periodic premium not required for flat amount Š0Š);Š // Else - 0Š : 0)Š;'CalcType SolveCriteria'(vectorSearchCriteria))
F1 2fa2227a 4ccebd29 2ee1ec37 3fa4eea 0 0 2
Solve Discounted Endowment Value( vectorSearchCriteria; yearIndex; monthIndex; vectorSolveParms; targetLoadInd)
Funktion
'GEN Round'(IF ( /*First month of projection period*/ 'Solve First Month of Projection Period'(vectorSearchCriteria;yearIndex;monthIndex) ; Š   // At the starting point of the projectionŠ'Solve Criteria Target CV'(vectorSearchCriteria) ; Š   // Else need to recursively determine the EOM CVŠ'Solve Recursive EOM CV'(vectorSearchCriteria;yearIndex;monthIndex;vectorSolveParms;targetLoadInd)Š); // Number of places to roundŠ'ACCS Decimal'('CalcType SolveCriteria'(vectorSearchCriteria)))
F1 2ee1ec37 2fa2227a 525e6f99 3c324b94 0 0 2
Solve Recursive EOM CV( vectorSearchCriteria; yearIndex; monthIndex; vectorSolveParms; targetLoadInd)
Funktion
IF ('Solve Next Year Discount Neg NAR Check'(vectorSearchCriteria;yearIndex;vectorSolveParms;targetLoadInd) = 1 ; Š   // set corridor indicator to 1‰‰‰Š'Solve Discount Annual Cash Value using Next Year Endowment'(vectorSearchCriteria;yearIndex;vectorSolveParms;V_(1;0);targetLoadInd) ; Š  IF ('Solve Next Year Discount Neg NAR Check'(vectorSearchCriteria;yearIndex;vectorSolveParms;targetLoadInd) = 2 ; Š     // set corridor indicator to 0‰‰Š'Solve Discount Annual Cash Value using Next Year Endowment'(vectorSearchCriteria;yearIndex;vectorSolveParms;V_('Solve Use COI In Corridor'(vectorSearchCriteria);1);targetLoadInd) ; Š    'Solve Monthly Discounted Cash Value using Next Year Endowment'(vectorSearchCriteria;yearIndex;vectorSolveParms;targetLoadInd)Š  )Š)
F1 525e6f99 2ee1ec37 0 5a2b66c0 0 0 2
Solve Monthly Discounted Cash Value using Next Year Endowment( vectorSearchCriteria; yearIndex; vectorSolveParms; targetLoadInd)
Funktion
'Solve Monthly Discounted Cash Value'('Solve Next Year Discounted Endowment Value'(vectorSearchCriteria;yearIndex;vectorSolveParms;targetLoadInd);vectorSearchCriteria;yearIndex + 1;1;vectorSolveParms;targetLoadInd)
F1 5a2b66c0 2ee1ec37 0 74804040 0 0 2
Solve Discount Annual Cash Value using Next Year Endowment( vectorSearchCriteria; yearIndex; vectorSolveParms; corridor; targetLoadInd)
Funktion
'Solve Discount Annual Cash Value'('Solve Next Year Discounted Endowment Value'(vectorSearchCriteria;yearIndex;vectorSolveParms;targetLoadInd);vectorSolveParms;yearIndex + 1;vectorSearchCriteria;corridor;targetLoadInd)
F1 74804040 2ee1ec37 0 5f05bf97 0 0 2
Solve Next Year Discounted Endowment Value(vectorSearchCriteria; yearIndex; vectorSolveParms; targetLoadInd)
Funktion
'Solve Discounted Endowment Value'(vectorSearchCriteria;yearIndex + 1;12;vectorSolveParms;targetLoadInd)
F1 5f05bf97 2ee1ec37 0 0 0 0 2
Solve Next Year Discount Neg NAR Check( vectorSearchCriteria; yearIndex; vectorSolveParms; targetLoadInd)
Funktion
'Solve Discount Neg NAR Check'('Solve Discounted Endowment Value'(vectorSearchCriteria;yearIndex + 1;12;vectorSolveParms;targetLoadInd);vectorSolveParms;yearIndex + 1;vectorSearchCriteria;V_(1;0);targetLoadInd)
F1 3c324b94 2fa2227a 0 9b54afc 0 0 2
Solve First Month of Projection Period( vectorSearchCriteria; yearIndex; monthIndex )
Funktion
((yearIndex >= 'Solve Criteria Target Duration'(vectorSearchCriteria)) && (monthIndex = 12))
F1 9b54afc 2fa2227a 3c58e0ef 3e0851a8 0 0 2
Solve Monthly Discounted Cash Value(nextEOYCV; vectorSearchCriteria; yearIndex; monthIndex; vectorSolveParms; targetLoadInd)
Funktion
(IF (monthIndex = 12 ; Š  nextEOYCV ; Š  'Solve Monthly Discounted Cash Value'(nextEOYCV;vectorSearchCriteria;yearIndex;monthIndex + 1;vectorSolveParms;targetLoadInd)Š) + IF ('Solve Monthly Corridor Indicator'('CalcType SolveCriteria'(vectorSearchCriteria);IF (monthIndex = 12 ; ŠnextEOYCV ; Š'Solve Monthly Discounted Cash Value'(nextEOYCV;vectorSearchCriteria;yearIndex;monthIndex + 1;vectorSolveParms;targetLoadInd)Š);yearIndex;vectorSolveParms) ; Š'Solve Init Guess COI Charges Monthly'(vectorSolveParms;vectorSearchCriteria;yearIndex) ; Š0Š) * 'Solve DB Adj Factor new'(vectorSearchCriteria;yearIndex;vectorSolveParms;V_('Solve Monthly Corridor Indicator'('CalcType SolveCriteria'(vectorSearchCriteria);IF (monthIndex = 12 ; ŠnextEOYCV ; Š'Solve Monthly Discounted Cash Value'(nextEOYCV;vectorSearchCriteria;yearIndex;monthIndex + 1;vectorSolveParms;targetLoadInd)Š);yearIndex;vectorSolveParms);0))) * 'Solve Choose R Factor'(vectorSearchCriteria;yearIndex;vectorSolveParms;V_('Solve Monthly Corridor Indicator'('CalcType SolveCriteria'(vectorSearchCriteria);IF (monthIndex = 12 ; ŠnextEOYCV ; Š'Solve Monthly Discounted Cash Value'(nextEOYCV;vectorSearchCriteria;yearIndex;monthIndex + 1;vectorSolveParms;targetLoadInd)Š);yearIndex;vectorSolveParms);0)) + ('COV Projected Monthly Total CovOption Charge'('CalcType SolveCriteria'(vectorSearchCriteria);'Std BaseCov Index'('CalcType SolveCriteria'(vectorSearchCriteria));yearIndex;1;'SharedVector SolveParms Shorten for Charges'(vectorSolveParms)) + 'Solve Init Guess Monthly NonNAR Coverage Charge'('CalcType SolveCriteria'(vectorSearchCriteria);yearIndex;vectorSolveParms) + IF ( /*Does calc type use fees?*/ 'CHG Calc Type Uses Fees'('CalcType SolveCriteria'(vectorSearchCriteria)) ; Š /*Yes - add expenses*/ 'Solve Init Guess Monthly Expenses'('CalcType SolveCriteria'(vectorSearchCriteria);yearIndex;monthIndex;'SharedVector SolveParms Shorten for Charges'(vectorSolveParms)) * 'Solve Non COI Timing Adjustment'(vectorSearchCriteria;yearIndex;'SharedVector SolveParms Shorten for Charges'(vectorSolveParms)) ; Š /*No - exclude expenses*/ 0Š)) * 'Solve Choose Exp Rider Adj Factor'(vectorSearchCriteria;yearIndex;vectorSolveParms;V_('Solve Monthly Corridor Indicator'('CalcType SolveCriteria'(vectorSearchCriteria);IF (monthIndex = 12 ; ŠnextEOYCV ; Š'Solve Monthly Discounted Cash Value'(nextEOYCV;vectorSearchCriteria;yearIndex;monthIndex + 1;vectorSolveParms;targetLoadInd)Š);yearIndex;vectorSolveParms);0)) + IF ('Solve Charge Applicable'('FeeType PremiumLoad';vectorSearchCriteria;yearIndex;monthIndex) ; Š'Solve Target Premium Loads'(vectorSolveParms;vectorSearchCriteria;yearIndex;targetLoadInd) ; Š0Š)
F1 3c58e0ef 9b54afc 0 2d9e2e7a 0 0 2
Solve Init Guess COI Charges Monthly(vectorSolveParms; vectorSearchCriteria; yearIndex)
Funktion
'Solve Base and Increase FaceAmount'('CalcType SolveCriteria'(vectorSearchCriteria);vectorSolveParms;yearIndex) * 'COV COI Rate'('CalcType SolveCriteria'(vectorSearchCriteria);0;yearIndex;vectorSolveParms) * 0.001
F1 2d9e2e7a 9b54afc 0 0 0 0 2
Solve Monthly Corridor Indicator(calcType; nextEOMCV; yearIndex; vectorSolveParms)
Funktion
IF (nextEOMCV > 'Solve Base and Increase FaceAmount'(calcType;vectorSolveParms;yearIndex) ; Š  0 ; Š  1Š)
F1 3e0851a8 2fa2227a 0 3a32b2ed 0 0 2
Solve Discount Neg NAR Check(nextEOYCV; vectorSolveParms; yearIndex; vectorSearchCriteria; corridorInd; targetLoadInd)
Funktion
IF ('DeathBenefitOptType Is Increasing'('Solve DthBenOpt'('CalcType SolveCriteria'(vectorSearchCriteria);yearIndex;vectorSolveParms)) || (('Solve Discount Annual Cash Value'(nextEOYCV;vectorSolveParms;yearIndex;vectorSearchCriteria;corridorInd;targetLoadInd) <= 'Solve Specified Amount'('CalcType SolveCriteria'(vectorSearchCriteria);vectorSolveParms)) && (nextEOYCV //'Solve Discount Annual Cash Value'(nextNextEOYCV; vectorSolveParms; yearIndex+1; vectorSearchCriteria; corridorInd)Š <= 'Solve Specified Amount'('CalcType SolveCriteria'(vectorSearchCriteria);vectorSolveParms))) ; Š  1 ; Š  IF (('Solve Discount Annual Cash Value'(nextEOYCV;vectorSolveParms;yearIndex;vectorSearchCriteria;V_(1;0) /*corridorInd*/ ;targetLoadInd) > 'Solve Specified Amount'('CalcType SolveCriteria'(vectorSearchCriteria);vectorSolveParms)) && (nextEOYCV //'Solve Discount Annual Cash Value'(nextNextEOYCV; vectorSolveParms; yearIndex+1; vectorSearchCriteria; corridorInd)Š > 'Solve Specified Amount'('CalcType SolveCriteria'(vectorSearchCriteria);vectorSolveParms)) ; Š    2 ; Š    3Š  )Š)
F1 3a32b2ed 2fa2227a 0 0 0 0 2
Solve Discount Annual Cash Value(NextEOYCV, vectorSolveParms, yearIndex; vectorSearchCriteria; corridorInd; targetLoadInd)
Funktion
NextEOYCV * 'Solve Choose R Factor'(vectorSearchCriteria;yearIndex;vectorSolveParms;corridorInd) ^ 12 +  // Base COI chargeŠ('Solve Init Guess COI Charges'(vectorSolveParms;vectorSearchCriteria;yearIndex) * 'Solve DB Adj Factor New'(vectorSearchCriteria;yearIndex;vectorSolveParms;corridorInd) * IF (e_(corridorInd;1) ; Š  0 ; Š  1Š) + ( // Benefit charges associated with the base coverage Š'COV Projected Monthly Total CovOption Charge'('CalcType SolveCriteria'(vectorSearchCriteria);'Std BaseCov Index'('CalcType SolveCriteria'(vectorSearchCriteria));yearIndex;1;vectorSolveParms) // Rider charges not associated with NARŠ + 'Solve Init Guess Monthly NonNAR Coverage Charge'('CalcType SolveCriteria'(vectorSearchCriteria);yearIndex;vectorSolveParms) * 'Solve Non COI Timing Adjustment'(vectorSearchCriteria;yearIndex;vectorSolveParms)) * 'Solve Choose Exp Rider Adj Factor'(vectorSearchCriteria;yearIndex;vectorSolveParms;corridorInd)) * ((1 - ('Solve Choose R Factor'(vectorSearchCriteria;yearIndex;vectorSolveParms;corridorInd) ^ 12)) / (1 - 'Solve Choose R Factor'(vectorSearchCriteria;yearIndex;vectorSolveParms;corridorInd))) + 'Solve Init Guess R Adjusted Annual Expenses'(yearIndex;vectorSolveParms;vectorSearchCriteria;corridorInd) * 'Solve Choose Exp Rider Adj Factor'(vectorSearchCriteria;yearIndex;vectorSolveParms;corridorInd) + 'Solve Target Premium Loads'(vectorSolveParms;vectorSearchCriteria;yearIndex;targetLoadInd) * 'Solve Premium Modal Factor'(vectorSolveParms;yearIndex;vectorSearchCriteria;corridorInd)
F1 3fa4eea 4ccebd29 551f6d4f 5ac7bd73 0 0 2
Solve Initial Premium Guess2(vectorSolveParms; vectorSearchCriteria)
Funktion
IF ('CalcType SolveCriteria Alike LTGT'(vectorSearchCriteria) || 'Solve Discounted Endowment Value'(vectorSearchCriteria;'Solve Start Year'(vectorSearchCriteria) - 1;12;vectorSolveParms;1) / 'Solve Init Guess Annualize PV Payment Factor2 rec'(vectorSearchCriteria;vectorSolveParms;'Solve Start Year'(vectorSearchCriteria);1) > 'SLV LoadTargetPremium'(vectorSearchCriteria) ; Š  'Solve Discounted Endowment Value'(vectorSearchCriteria;'Solve Start Year'(vectorSearchCriteria) - 1;12;vectorSolveParms;1) / 'Solve Init Guess Annualize PV Payment Factor2 rec'(vectorSearchCriteria;vectorSolveParms;'Solve Start Year'(vectorSearchCriteria);1) ; Š  'Solve Discounted Endowment Value'(vectorSearchCriteria;'Solve Start Year'(vectorSearchCriteria) - 1;12;vectorSolveParms;0) / 'Solve Init Guess Annualize PV Payment Factor2 rec'(vectorSearchCriteria;vectorSolveParms;'Solve Start Year'(vectorSearchCriteria);0)Š)
F1 551f6d4f 3fa4eea 35d8d0b5 0 0 0 2
Solve Init Guess Annualize PV Payment Factor2 rec(vectorSearchCriteria; vectorSolveParms; yearIndex; targetLoadInd)
Funktion
IF (yearIndex = 'Solve Criteria Premium Duration'(vectorSearchCriteria) ; Š  0 ; Š  'Solve Init Guess Annualize PV Payment Factor2 rec'(vectorSearchCriteria;vectorSolveParms;yearIndex + 1;targetLoadInd) * IF ('Solve Target Duration Greater Than or Equal to Year OR Discount Neg NAR Check Equals One'(vectorSearchCriteria;vectorSolveParms;yearIndex;targetLoadInd) ; Š    'Solve Choose R Factor'(vectorSearchCriteria;yearIndex;vectorSolveParms;V_(1;0)) ^ 12 ; Š    IF ('Solve Discounted Endowment Neg NAR Check Equals Two'(vectorSearchCriteria;yearIndex;vectorSolveParms;targetLoadInd) ; Š      'Solve Choose R Factor'(vectorSearchCriteria;yearIndex;vectorSolveParms;V_(0;1)) ^ 12 ; Š      'Solve R Factor Monthly Total'('Solve Discounted Endowment Value'(vectorSearchCriteria;yearIndex;12;vectorSolveParms;targetLoadInd);vectorSearchCriteria;yearIndex;12;vectorSolveParms;targetLoadInd)Š    )Š) - IF ( /*Death benefit is option C and not seven pay*/ 'DeathBenefitOptType Is IncreasingROP'('Solve DthBenOpt'('CalcType SolveCriteria'(vectorSearchCriteria);yearIndex;vectorSolveParms)) ; Š /*Yes*/ 'Solve DB Option 3 Payment Adj Factor new'(vectorSearchCriteria;yearIndex;vectorSolveParms;targetLoadInd) ; Š0Š)Š) + IF ( /*Does calctype use fees?*/ 'CHG Calc Type Uses Fees'('CalcType SolveCriteria'(vectorSearchCriteria)) ; Š /*Yes - calculate net premium*/ 'Solve Net Premium Factor'(vectorSearchCriteria;yearIndex;targetLoadInd) ; Š // Else calc type doesn't include feesŠ1Š) * IF ('Solve Target Duration Greater Than or Equal to Year OR Discount Neg NAR Check Equals One'(vectorSearchCriteria;vectorSolveParms;yearIndex;targetLoadInd) ; Š'Solve Premium Modal Factor'(vectorSolveParms;yearIndex;vectorSearchCriteria;V_(1;0)) ; ŠIF ('Solve Discounted Endowment Neg NAR Check Equals Two'(vectorSearchCriteria;yearIndex;vectorSolveParms;targetLoadInd) ; Š'Solve Premium Modal Factor'(vectorSolveParms;yearIndex;vectorSearchCriteria;V_(0;1)) ; Š'Solve R Annuity Factor Monthly Total'('Solve Discounted Endowment Value'(vectorSearchCriteria;yearIndex;12;vectorSolveParms;targetLoadInd);vectorSearchCriteria;yearIndex;12;vectorSolveParms;targetLoadInd)Š)Š)
F1 35d8d0b5 551f6d4f 0 2083402 0 0 2
Solve R Factor Monthly Total( nextEOYCV; vectorSearchCriteria; yearIndex; monthIndex; vectorSolveParms; targetLoadInd)
Funktion
IF (monthIndex = 1 ; Š  'Solve Choose R Factor'(vectorSearchCriteria;yearIndex;vectorSolveParms;V_(1;0)) ; Š  'Solve R Factor Monthly Total'(nextEOYCV;vectorSearchCriteria;yearIndex;monthIndex - 1;vectorSolveParms;targetLoadInd) * IF ('Solve Monthly Corridor Indicator'('CalcType SolveCriteria'(vectorSearchCriteria);'Solve Monthly Discounted Cash Value'(nextEOYCV;vectorSearchCriteria;yearIndex;monthIndex;vectorSolveParms;targetLoadInd);yearIndex;vectorSolveParms) ; Š    'Solve Choose R Factor'(vectorSearchCriteria;yearIndex;vectorSolveParms;V_(1;1)) ; Š    'Solve Choose R Factor'(vectorSearchCriteria;yearIndex;vectorSolveParms;V_(1;0))Š  )Š)
F1 2083402 551f6d4f 0 463e0d0e 0 0 2
Solve R Annuity Factor Monthly Total(nextEOYCV; vectorSearchCriteria; yearIndex; monthIndex; vectorSolveParms; targetLoadInd)
Funktion
IF (monthIndex = 1 ; Š  1 / 'Solve Choose R Factor'(vectorSearchCriteria;yearIndex;vectorSolveParms;V_(1;0)) ; Š  (1 + 'Solve R Annuity Factor Monthly Total'(nextEOYCV;vectorSearchCriteria;yearIndex;monthIndex - 1;vectorSolveParms;targetLoadInd)) / IF ('Solve Monthly Corridor Indicator'('CalcType SolveCriteria'(vectorSearchCriteria);'Solve Monthly Discounted Cash Value'(nextEOYCV;vectorSearchCriteria;yearIndex;monthIndex;vectorSolveParms;targetLoadInd);yearIndex;vectorSolveParms) ; Š    'Solve Choose R Factor'(vectorSearchCriteria;yearIndex;vectorSolveParms;V_(1;1)) ; Š    'Solve Choose R Factor'(vectorSearchCriteria;yearIndex;vectorSolveParms;V_(1;0))Š  )Š) * 'Solve R Factor Monthly Total'(nextEOYCV;vectorSearchCriteria;yearIndex;monthIndex;vectorSolveParms;targetLoadInd)
F1 463e0d0e 551f6d4f 0 73320528 0 0 2
Solve Target Duration Greater Than or Equal to Year OR Discount Neg NAR Check Equals One(vectorSearchCriteria; vectorSolveParms; yearIndex; targetLoadInd)
Funktion
yearIndex >= 'Solve Criteria Target Duration'(vectorSearchCriteria) - 1 || 'Solve Discounted Endowment Neg NAR Check Equals Num'(vectorSearchCriteria;yearIndex;vectorSolveParms;targetLoadInd;1)
F1 73320528 551f6d4f 579d7c3f 0 0 0 2
Solve Discounted Endowment Neg NAR Check Equals Two(vectorSearchCriteria; yearIndex; vectorSolveParms; targetLoadInd)
Funktion
'Solve Discounted Endowment Neg NAR Check Equals Num'(vectorSearchCriteria;yearIndex;vectorSolveParms;targetLoadInd;2)
F1 579d7c3f 73320528 0 0 0 0 2
Solve Discounted Endowment Neg NAR Check Equals Num(vectorSearchCriteria; yearIndex; vectorSolveParms; targetLoadInd; Num)
Funktion
'Solve Discount Neg NAR Check'('Solve Discounted Endowment Value'(vectorSearchCriteria;yearIndex;12;vectorSolveParms;targetLoadInd);vectorSolveParms;yearIndex;vectorSearchCriteria;V_(1;0);targetLoadInd) EQUAL Num
F1 5ac7bd73 4ccebd29 1c2ef69f 677a9fb6 0 0 2
Solve Initial Premium Guess3(vectorSolveParms; vectorSearchCriteria)
Funktion
IF ('CalcType SolveCriteria Alike LTGT'(vectorSearchCriteria) || 'Solve Discounted Endowment Value'(vectorSearchCriteria;'Solve Start Year'(vectorSearchCriteria) - 1;12;vectorSolveParms;1) / 'Solve Init Guess Annualize PV Payment Factor3 rec'(vectorSearchCriteria;vectorSolveParms;'Solve Start Year'(vectorSearchCriteria);1) > 'SLV LoadTargetPremium'(vectorSearchCriteria) ; Š  'Solve Discounted Endowment Value'(vectorSearchCriteria;'Solve Start Year'(vectorSearchCriteria) - 1;12;vectorSolveParms;1) / 'Solve Init Guess Annualize PV Payment Factor3 rec'(vectorSearchCriteria;vectorSolveParms;'Solve Start Year'(vectorSearchCriteria);0) ; Š  'Solve Discounted Endowment Value'(vectorSearchCriteria;'Solve Start Year'(vectorSearchCriteria) - 1;12;vectorSolveParms;0) / 'Solve Init Guess Annualize PV Payment Factor3 rec'(vectorSearchCriteria;vectorSolveParms;'Solve Start Year'(vectorSearchCriteria);0)Š)
F1 1c2ef69f 5ac7bd73 0 0 0 0 2
Solve Init Guess Annualize PV Payment Factor3 rec(vectorSearchCriteria; vectorSolveParms; yearIndex; targetLoadInd)
Funktion
IF (yearIndex = 'Solve Criteria Premium Duration'(vectorSearchCriteria) ; Š  0 ; Š  'Solve Init Guess Annualize PV Payment Factor3 rec'(vectorSearchCriteria;vectorSolveParms;yearIndex + 1;targetLoadInd) * 'Solve Choose R Factor'(vectorSearchCriteria;yearIndex;vectorSolveParms;V_(1;0)) ^ 12 - IF ( /*Death benefit is option C and not seven pay*/ 'DeathBenefitOptType Is IncreasingROP'('Solve DthBenOpt'('CalcType SolveCriteria'(vectorSearchCriteria);yearIndex;vectorSolveParms)) ; Š     /*Yes*/ 'Solve DB Option 3 Payment Adj Factor Annual'(vectorSearchCriteria;yearIndex;vectorSolveParms;V_(1;0)) ; Š    0Š  )Š) + IF ( /*Does calctype use fees?*/ 'CHG Calc Type Uses Fees'('CalcType SolveCriteria'(vectorSearchCriteria)) ; Š /*Yes - calculate net premium*/ 'Solve Net Premium Factor'(vectorSearchCriteria;yearIndex;targetLoadInd) ; Š // Else calc type doesn't include feesŠ1Š)
F1 677a9fb6 4ccebd29 166f7a0 0 0 0 2
Solve Initial Premium Guess4(vectorSolveParms; vectorSearchCriteria)
Funktion
IF ('CalcType SolveCriteria Alike LTGT'(vectorSearchCriteria) || 'Solve Discounted Endowment Value'(vectorSearchCriteria;'Solve Start Year'(vectorSearchCriteria) - 1;12;vectorSolveParms;1) / 'Solve Init Guess Annualize PV Payment Factor4 rec'(vectorSearchCriteria;vectorSolveParms;'Solve Start Year'(vectorSearchCriteria);1) > 'SLV LoadTargetPremium'(vectorSearchCriteria) ; Š  'Solve Discounted Endowment Value'(vectorSearchCriteria;'Solve Start Year'(vectorSearchCriteria) - 1;12;vectorSolveParms;1) / 'Solve Init Guess Annualize PV Payment Factor4 rec'(vectorSearchCriteria;vectorSolveParms;'Solve Start Year'(vectorSearchCriteria);1) ; Š  'Solve Discounted Endowment Value'(vectorSearchCriteria;'Solve Start Year'(vectorSearchCriteria) - 1;12;vectorSolveParms;0) / 'Solve Init Guess Annualize PV Payment Factor4 rec'(vectorSearchCriteria;vectorSolveParms;'Solve Start Year'(vectorSearchCriteria);0)Š)
F1 166f7a0 677a9fb6 0 0 0 0 2
Solve Init Guess Annualize PV Payment Factor4 rec(vectorSearchCriteria; vectorSolveParms; yearIndex; targetLoadInd)
Funktion
IF (yearIndex = 'Solve Criteria Premium Duration'(vectorSearchCriteria) ; Š  0 ; Š  'Solve Init Guess Annualize PV Payment Factor4 rec'(vectorSearchCriteria;vectorSolveParms;yearIndex + 1;targetLoadInd) * 'Solve Choose R Factor'(vectorSearchCriteria;yearIndex;vectorSolveParms;V_(0;0)) ^ 12 - IF ( /*Death benefit is option C and not seven pay*/ 'DeathBenefitOptType Is IncreasingROP'('Solve DthBenOpt'('CalcType SolveCriteria'(vectorSearchCriteria);yearIndex;vectorSolveParms)) ; Š     /*Yes*/ 'Solve DB Option 3 Payment Adj Factor Annual'(vectorSearchCriteria;yearIndex;vectorSolveParms;V_(0;0)) ; Š    0Š  )Š) + IF ( /*Does calctype use fees?*/ 'CHG Calc Type Uses Fees'('CalcType SolveCriteria'(vectorSearchCriteria)) ; Š /*Yes - calculate net premium*/ 'Solve Net Premium Factor'(vectorSearchCriteria;yearIndex;targetLoadInd) ; Š // Else calc type doesn't include feesŠ1Š)
F1 51cc8c12 264b278 5dd594d0 0 0 0 2
Solve Initial Premium Guess(vectorSolveParms; vectorSearchCriteria)
Funktion
'GEN Round'('Solve Init Guess Annualize PV Charges'(vectorSolveParms;vectorSearchCriteria) / 'Solve Init Guess Annualize PV Payment Factor'(vectorSearchCriteria;vectorSolveParms);2)
F1 5dd594d0 51cc8c12 12e548c9 294bce22 0 0 2
Solve Init Guess Annualize PV Charges(vectorSolveParms; vectorSearchCriteria)
Funktion
 // Term NSPŠSUMX(yearIndex;'Solve Start Year'(vectorSearchCriteria);'Solve Criteria Target Duration'(vectorSearchCriteria);'Solve Init Guess Annualize PV Yearly Charges'(vectorSolveParms;vectorSearchCriteria;#yearIndex)) +  // Endowment NSPŠ('Solve Criteria Target CV'(vectorSearchCriteria) * 'Solve Annualize Product R Factor'(vectorSearchCriteria;'Solve Criteria Target Duration'(vectorSearchCriteria);vectorSolveParms) * ('Solve R Factor'(vectorSearchCriteria;'Solve Criteria Target Duration'(vectorSearchCriteria);vectorSolveParms) ^ 12))
F1 12e548c9 5dd594d0 2015ec88 0 0 0 2
Solve Init Guess Annualize PV Yearly Charges(vectorSolveParms; vectorSearchCriteria; yearIndex)
Funktion
 // Present value of charges at the beginning of the yearŠ(('Solve Init Guess Total Charges'(vectorSolveParms;vectorSearchCriteria;yearIndex) * IF ( /*If R-factor is 1*/ 'Solve R Factor'(vectorSearchCriteria;yearIndex;vectorSolveParms) = 1 ; Š   /*Multiply by 12*/ 12 ; Š   /*Else compound R factor by 12*/ (1 - ('Solve R Factor'(vectorSearchCriteria;yearIndex;vectorSolveParms) ^ 12)) / (1 - 'Solve R Factor'(vectorSearchCriteria;yearIndex;vectorSolveParms))Š) +  // add flat amount premium load chargeŠIF ( /*If premium load is flat amount*/ 'Fee ChargeBasedOn is FlatAmount'('PI PolicyProduct Fee ChargeBasedOn'('Policy ProductCode';'FeeType PremiumLoad';TransEffDate)) //‰NOT('PI PolicyProduct Fee ChargeBasedOn'('Policy ProductCode'; 'FeeType PremiumLoad'; TransEffDate) ALIKE 'GEN Vector Blank')Š//‰&&Š//‰'PI PolicyProduct Fee ChargeBasedOn'('Policy ProductCode'; 'FeeType PremiumLoad'; TransEffDate) = 1000500030Š && 'CHG Calc Type Uses Fees'('CalcType SolveCriteria'(vectorSearchCriteria)) && yearIndex <= MIN('Solve Criteria Premium Duration'(vectorSearchCriteria) + ('Solve Start Year'(vectorSearchCriteria) - 1);'Solve Criteria Target Duration'(vectorSearchCriteria)) ; Š // flat amount premium chargeŠ'PLC Projected Total Premium Load Charge'('CalcType SolveCriteria'(vectorSearchCriteria);'FeeType PremiumLoad';yearIndex;100; // periodic premium not required for flat amount ‰Š'GEN Vector Blank'; // target premium vector not requiredŠ0 // assumes premiums paid annually in advanceŠ) ; Š /*Else don't add in premium load now‰*/ 0Š)) +  // add premium load up to load target if applicableŠIF ( /*Load target calculation or Beyond Premium Duration?*/ 'CalcType SolveCriteria Alike LTGT'(vectorSearchCriteria) || yearIndex > MIN('Solve Criteria Premium Duration'(vectorSearchCriteria) + ('Solve Start Year'(vectorSearchCriteria) - 1);'Solve Criteria Target Duration'(vectorSearchCriteria)) ; Š /*Yes*/ 0 ; Š /*No*/ IF ( /*Premium load based on Load Target and Loads used in calctype?*/ NOT('PI PolicyProduct Fee ChargeBasedOn'('Policy ProductCode';'FeeType PremiumLoad';TransEffDate) ALIKE 'GEN Vector Blank') && ('PI PolicyProduct Fee ChargeBasedOn'('Policy ProductCode';'FeeType PremiumLoad';TransEffDate) EQUAL "1000500005" || 'PI PolicyProduct Fee ChargeBasedOn'('Policy ProductCode';'FeeType PremiumLoad';TransEffDate) EQUAL "1000500007") && 'CHG Calc Type Uses Fees'('CalcType SolveCriteria'(vectorSearchCriteria)) ; Š /*Yes*/ 'SLV LoadTargetPremium'(vectorSearchCriteria) * ('PLC Premium Load Primary Rate'('CalcType SolveCriteria'(vectorSearchCriteria);'FeeType PremiumLoad';0;yearIndex) * 0.01 - 'PLC Premium Load Secondary Rate'('CalcType SolveCriteria'(vectorSearchCriteria);'FeeType PremiumLoad';0;yearIndex) * 0.01) ; Š /*No*/ 0Š)Š)) * 'Solve Annualize Product R Factor'(vectorSearchCriteria;yearIndex;vectorSolveParms) // Discount from beginning of year back to issue date   Š
F1 2015ec88 12e548c9 7323fd8e 0 0 0 2
Solve Init Guess Total Charges(vectorSolveParms; vectorSearchCriteria; yearIndex)
Funktion
 // Base COI chargeŠ'Solve Init Guess COI Charges'(vectorSolveParms;vectorSearchCriteria;yearIndex) * 'Solve DB Adj Factor'(vectorSearchCriteria;yearIndex;vectorSolveParms) +  // Expense chargesŠ(IF ( /*Does calc type use fees?*/ 'CHG Calc Type Uses Fees'('CalcType SolveCriteria'(vectorSearchCriteria)) ; Š   /*Yes - add expenses*/ 'Solve Init Guess Monthly Expenses'('CalcType SolveCriteria'(vectorSearchCriteria);yearIndex;1;vectorSolveParms) * 'Solve Non COI Timing Adjustment'(vectorSearchCriteria;yearIndex;vectorSolveParms) ; Š   /*No - exclude expenses*/ 0Š) // Benefit charges associated with the base coverageŠ + 'COV Projected Monthly Total CovOption Charge'('CalcType SolveCriteria'(vectorSearchCriteria);'Std BaseCov Index'('CalcType SolveCriteria'(vectorSearchCriteria));yearIndex;1;vectorSolveParms) // Rider charges not associated with NARŠ + 'Solve Init Guess Monthly NonNAR Coverage Charge'('CalcType SolveCriteria'(vectorSearchCriteria);yearIndex;vectorSolveParms) * 'Solve Non COI Timing Adjustment'(vectorSearchCriteria;yearIndex;vectorSolveParms)) * 'Solve Exp Rider Adj Factor'(vectorSearchCriteria;yearIndex;vectorSolveParms)
F1 7323fd8e 2015ec88 0 586bfb97 0 0 2
Solve Init Guess Monthly Expenses(calcType; yearIndex; monthIndex; vectorSolveParms)
Funktion
IF ( /*Does calctype use fees?*/ 'CHG Calc Type Uses Fees'(calcType) ; Š   /*Yes - include admin fees*/ 'AC Proj Mthly Total AdminFee Charge'(calcType;'FeeType AdminFee';0;yearIndex;monthIndex;vectorSolveParms) + 'AC Proj Mthly Total AdminFee Charge'(calcType;'FeeType Expense';0;yearIndex;monthIndex;vectorSolveParms) ; Š   // Expense not included in 7 pay calculationsŠ0Š)
F1 586bfb97 2015ec88 0 26e34292 0 0 2
Solve Init Guess Monthly NonNAR Coverage Charge(calcType; yearIndex; vectorSolveParms)
Funktion
SUMX(coverageIndex;0;IF ('SharedVector SolveParms Contains Number of Coverage'(vectorSolveParms) ; Š  'SharedVector SolveParms Number of Coverage'(calcType;vectorSolveParms) - 1 ; Š  'Policy Number Of Coverage'(calcType;yearIndex) - 1Š);IF ( /*Is coverage included?*/ 'COV Coverage Is Included'(calcType;#coverageIndex;yearIndex;1;vectorSolveParms) && (NOT('Coverage Is NAR Cost'(calcType;#coverageIndex))) ; Š /*Yes - include coverage charge*/ 'COV Projected Monthly Total Coverage Charge NoWMD'(calcType;#coverageIndex;0;0;yearIndex;1;vectorSolveParms) ; Š // bom_cv and total premium zero for initial guess calcsŠ/*No - exclude*/0Š))
F1 26e34292 2015ec88 0 3979958a 0 0 2
Solve Init Guess COI Charges(vectorSolveParms; vectorSearchCriteria; yearIndex)
Funktion
(('Solve Base and Increase FaceAmount'('CalcType SolveCriteria'(vectorSearchCriteria);vectorSolveParms;yearIndex) / 'NAAR Discount Factor'('CalcType SolveCriteria'(vectorSearchCriteria))) * 'COV COI Rate'('CalcType SolveCriteria'(vectorSearchCriteria);0;yearIndex;vectorSolveParms) * 0.001) / (1 + ('COV COI Rate'('CalcType SolveCriteria'(vectorSearchCriteria);0;yearIndex;vectorSolveParms) * 0.001))
F1 3979958a 2015ec88 0 0 0 0 2
Solve Init Guess R Adjusted Annual Expenses(yearIndex; vectorSolveParms; vectorSearchCriteria; corridorInd)
Funktion
IF ( /*Does calctype use fees?*/ 'CHG Calc Type Uses Fees'('CalcType SolveCriteria'(vectorSearchCriteria)) ; Š   /*Yes - include admin fees*/ 'AC Proj Mthly Total AdminFee Charge'('CalcType SolveCriteria'(vectorSearchCriteria);'FeeType AdminFee';0;yearIndex;1;vectorSolveParms) * 'Solve R Factor Modal'('Solve Fee Mode'('FeeType AdminFee');vectorSolveParms;yearIndex;vectorSearchCriteria;corridorInd) + 'AC Proj Mthly Total AdminFee Charge'('CalcType SolveCriteria'(vectorSearchCriteria);'FeeType Expense';0;yearIndex;1;vectorSolveParms) * 'Solve R Factor Modal'('Solve Fee Mode'('FeeType Expense');vectorSolveParms;yearIndex;vectorSearchCriteria;corridorInd) ; Š   // Expense not included in 7 pay calculationsŠ0Š)
F1 294bce22 51cc8c12 0 6462f8df 0 0 2
Solve Annualize Product R Factor(vectorSearchCriteria; yearIndex; vectorSolveParms)
Funktion
IF ( /*start year?*/ yearIndex = 'Solve Start Year'(vectorSearchCriteria) ; Š   /*Yes*/ 1.0 ; Š   /*No - calculate recursively*/ 'Solve Annualize Product R Factor'(vectorSearchCriteria;yearIndex - 1;vectorSolveParms) * ('Solve R Factor'(vectorSearchCriteria;yearIndex - 1;vectorSolveParms) ^ 12)Š)
F1 6462f8df 51cc8c12 0 52fa3199 0 0 2
Solve R Factor(vectorSearchCriteria; yearIndex; vectorSolveParms)
Funktion
1 / IF ( /*waiver exists and is inforce*/ 'Solve Waiver Exists and Is Inforce'(vectorSearchCriteria;yearIndex;vectorSolveParms) ; Š   // A CovOption object is included under the Base Coverage for WMD‰‰Š/*Yes*/(1 + ('GEN Future Value Factor'('Solve Criteria Interest Rate'(vectorSearchCriteria;yearIndex);(1 / 12)) - 1) + 'COV COI Rate'('CalcType SolveCriteria'(vectorSearchCriteria);0;yearIndex;vectorSolveParms) * 0.001 * ('GEN Future Value Factor'('Solve Criteria Interest Rate'(vectorSearchCriteria;yearIndex);(1 / 12)) - 1) * (1 + 'COV CovOption COI Rate'('CalcType SolveCriteria'(vectorSearchCriteria);0;'Std CovOption Index'('CalcType SolveCriteria'(vectorSearchCriteria);0;'OptType WMD');yearIndex)) + IF ( /*Is death benefit option 1 or option 3?*/ 'DeathBenefitOptType Is Level'('Solve DthBenOpt'('CalcType SolveCriteria'(vectorSearchCriteria);yearIndex;vectorSolveParms)) || 'DeathBenefitOptType Is IncreasingROP'('Solve DthBenOpt'('CalcType SolveCriteria'(vectorSearchCriteria);yearIndex;vectorSolveParms)) ; Š     /*Yes*/ ((1 + 'COV CovOption COI Rate'('CalcType SolveCriteria'(vectorSearchCriteria);0;'Std CovOption Index'('CalcType SolveCriteria'(vectorSearchCriteria);0;'OptType WMD');yearIndex)) * 'COV COI Rate'('CalcType SolveCriteria'(vectorSearchCriteria);0;yearIndex;vectorSolveParms) * 0.001) ; Š     /*No*/ 0Š  )) ; Š /*No*/ (1 + ('GEN Future Value Factor'('Solve Criteria Interest Rate'(vectorSearchCriteria;yearIndex);(1 / 12)) - 1) + IF ( /*Is death benefit option 1 or option 3?*/ 'DeathBenefitOptType Is Level'('Solve DthBenOpt'('CalcType SolveCriteria'(vectorSearchCriteria);yearIndex;vectorSolveParms)) || 'DeathBenefitOptType Is IncreasingROP'('Solve DthBenOpt'('CalcType SolveCriteria'(vectorSearchCriteria);yearIndex;vectorSolveParms)) ; Š   /*Yes*/ (('GEN Future Value Factor'('Solve Criteria Interest Rate'(vectorSearchCriteria;yearIndex);(1 / 12)) - 1) * 'COV COI Rate'('CalcType SolveCriteria'(vectorSearchCriteria);0;yearIndex;vectorSolveParms) * 0.001) + 'COV COI Rate'('CalcType SolveCriteria'(vectorSearchCriteria);0;yearIndex;vectorSolveParms) * 0.001 ; Š   /*No*/ (('GEN Future Value Factor'('Solve Criteria Interest Rate'(vectorSearchCriteria;yearIndex);(1 / 12)) - 1) * 'COV COI Rate'('CalcType SolveCriteria'(vectorSearchCriteria);0;yearIndex;vectorSolveParms) * 0.001)Š))Š)
F1 52fa3199 51cc8c12 0 76c4ef1e 0 0 2
Solve DB Adj Factor( vectorSearchCriteria; yearIndex; vectorSolveParms)
Funktion
IF ( /*waiver exists and is active*/ 'Solve Waiver Exists and Is Inforce'(vectorSearchCriteria;yearIndex;vectorSolveParms) ; Š   // A CovOption object is included under the Base Coverage for WMD‰‰Š/*Yes*/('GEN Future Value Factor'('Solve Criteria Interest Rate'(vectorSearchCriteria;yearIndex);(1 / 12)) * (1 + 'COV COI Rate'('CalcType SolveCriteria'(vectorSearchCriteria);0;yearIndex;vectorSolveParms) * 0.001) * (1 + 'COV CovOption COI Rate'('CalcType SolveCriteria'(vectorSearchCriteria);0;'Std CovOption Index'('CalcType SolveCriteria'(vectorSearchCriteria);0;'OptType WMD');yearIndex))) * 'Solve R Factor'(vectorSearchCriteria;yearIndex;vectorSolveParms) ; Š   /*No*/ IF ( /*Is death benefit option 1 or option 3?*/ 'DeathBenefitOptType Is Level'('Solve DthBenOpt'('CalcType SolveCriteria'(vectorSearchCriteria);yearIndex;vectorSolveParms)) || 'DeathBenefitOptType Is IncreasingROP'('Solve DthBenOpt'('CalcType SolveCriteria'(vectorSearchCriteria);yearIndex;vectorSolveParms)) ; Š     /*Yes*/ 1 ; Š     /*No*/ ('GEN Future Value Factor'('Solve Criteria Interest Rate'(vectorSearchCriteria;yearIndex);(1 / 12)) * (1 + 'COV COI Rate'('CalcType SolveCriteria'(vectorSearchCriteria);0;yearIndex;vectorSolveParms) * 0.001)) * 'Solve R Factor'(vectorSearchCriteria;yearIndex;vectorSolveParms)Š  )Š)
F1 76c4ef1e 51cc8c12 0 4a8b715f 0 0 2
Solve Exp Rider Adj Factor(vectorSearchCriteria; yearIndex; vectorSolveParms)
Funktion
IF ( /*waiver exists and is active*/ 'Solve Waiver Exists and Is Inforce'(vectorSearchCriteria;yearIndex;vectorSolveParms) ; Š   // A CovOption object is included under the Base Coverage for WMD‰‰Š/*Yes*/IF ( /*Is death benefit option 1 or option 3?*/ 'DeathBenefitOptType Is Level'('Solve DthBenOpt'('CalcType SolveCriteria'(vectorSearchCriteria);yearIndex;vectorSolveParms)) || 'DeathBenefitOptType Is IncreasingROP'('Solve DthBenOpt'('CalcType SolveCriteria'(vectorSearchCriteria);yearIndex;vectorSolveParms)) ; Š     /*Yes*/ ('GEN Future Value Factor'('Solve Criteria Interest Rate'(vectorSearchCriteria;yearIndex);(1 / 12)) * (1 + 'COV COI Rate'('CalcType SolveCriteria'(vectorSearchCriteria);0;yearIndex;vectorSolveParms) * 0.001) * (1 + 'COV CovOption COI Rate'('CalcType SolveCriteria'(vectorSearchCriteria);0;'Std CovOption Index'('CalcType SolveCriteria'(vectorSearchCriteria);0;'OptType WMD');yearIndex))) * 'Solve R Factor'(vectorSearchCriteria;yearIndex;vectorSolveParms) ; Š     /*No*/ (1 + ('GEN Future Value Factor'('Solve Criteria Interest Rate'(vectorSearchCriteria;yearIndex);(1 / 12)) - 1) * (1 + 'COV COI Rate'('CalcType SolveCriteria'(vectorSearchCriteria);0;yearIndex;vectorSolveParms) * 0.001)) * (1 + 'COV CovOption COI Rate'('CalcType SolveCriteria'(vectorSearchCriteria);0;'Std CovOption Index'('CalcType SolveCriteria'(vectorSearchCriteria);0;'OptType WMD');yearIndex)) * 'Solve R Factor'(vectorSearchCriteria;yearIndex;vectorSolveParms)Š  ) ; Š /*No*/ 1Š)
F1 4a8b715f 51cc8c12 0 71848698 0 0 2
Solve Non COI Timing Adjustment(vectorSearchCriteia; yearIndex; vectorSolveParms)
Funktion
1
F1 71848698 51cc8c12 135debb4 0 0 0 2
Solve Init Guess Annualize PV Payment Factor(vectorSearchCriteria; vectorSolveParms)
Funktion
SUMX(yearIndex;'Solve Start Year'(vectorSearchCriteria);MIN('Solve Criteria Premium Duration'(vectorSearchCriteria) + ('Solve Start Year'(vectorSearchCriteria) - 1);'Solve Criteria Target Duration'(vectorSearchCriteria));'Solve Annualize Product R Factor'(vectorSearchCriteria;#yearIndex;vectorSolveParms) * IF ( /*Does calctype use fees?*/ 'CHG Calc Type Uses Fees'('CalcType SolveCriteria'(vectorSearchCriteria)) ; Š   /*Yes - calculate net premium*/ 'Solve Net Premium Factor'(vectorSearchCriteria;#yearIndex;1) ; Š   // Else calc type doesn't include feesŠ1Š) - 'Solve DB Option 3 Payment Adj Factor'(vectorSearchCriteria;#yearIndex;vectorSolveParms))
F1 135debb4 71848698 72b2c6d5 7981e5b8 0 0 2
Solve Net Premium Factor(vectorSearchCriteria; yearIndex; targetLoadInd)
Funktion
CASE( /*Charge based on rule*/ 'PLC Premium Load Rule'('CalcType SolveCriteria'(vectorSearchCriteria);1;'FeeType PremiumLoad');Š   // No premium load or flat amount (accounted for in Mthly_expensesŠ"";"1000500022";"1000500030" : 1;Š   // Percent of premium for lifeŠ"1000500003" : 1 - 'PLC Premium Load Primary Rate'('CalcType SolveCriteria'(vectorSearchCriteria);'FeeType PremiumLoad';0;yearIndex) * 0.01;Š   // ElseŠ : IF ( /*Load target calculation?*/ 'CalcType SolveCriteria Alike LTGT'(vectorSearchCriteria) || NOT(targetLoadInd) ; Š     // If we are solving for the load target, we are assuming that the premium solve amountŠ// is the target amount.  'Solve Init Guess Premium Load Rate' is asking for the load target premiumŠ// from the attributes.   We can't have that if the load target is what we are solving for.Š1 - 'PLC Premium Load Primary Rate'('CalcType SolveCriteria'(vectorSearchCriteria);'FeeType PremiumLoad';0;yearIndex) * 0.01 ; Š     // Else use secondary load rate and the primary will be handled as an annual chargeŠ1 - 'PLC Premium Load Secondary Rate'('CalcType SolveCriteria'(vectorSearchCriteria);'FeeType PremiumLoad';0;yearIndex) * 0.01Š  ))Š
F1 72b2c6d5 135debb4 0 183fa277 0 0 2
-- Solve Init Guess Premium Load Rate(calcType; vectorSolveParms; yearIndex)
Funktion
Š'PLC Projected Total Premium Load Charge'(Š‰‰‰calcType;Š‰‰‰'FeeType PremiumLoad'; Š‰‰‰yearIndex;Š‰‰‰'SharedVector SolveParms Premium'(vectorSolveParms; yearIndex); Š‰‰‰IF('Std Calling System Is Illustration Based' ;Š‰‰‰‰/*Solve for Illustration?*/Š‰‰‰‰v_('TARGET Total Target Premium'('CalcType LTGT'(calcType)) );Š‰‰‰‰‰/*else use target from INPUT*/Š‰‰‰‰‰VECTORX(cov; 0; 'Policy Number Of Coverage'(calcType; TransEffDur)-1; Š‰‰‰‰‰‰V_('Policy Coverage TargetPremAmt'(#cov); #cov+1)Š‰‰‰‰‰)Š‰‰‰);Š‰‰‰0‰‰// assumes premiums paid annually in advanceŠ‰‰)Š‰‰/ ‰‰// to get rate rather than charge amountŠ‰‰'SharedVector SolveParms Premium'(vectorSolveParms; yearIndex)
F1 183fa277 135debb4 0 3a9f513b 0 0 2
Solve Init Guess Premium Load Rate(calcType; vectorSolveParms; yearIndex)
Funktion
'PLC Projected Total Premium Load Charge'(calcType;'FeeType PremiumLoad';yearIndex;'SharedVector SolveParms Premium'(vectorSolveParms;yearIndex);IF ('Std Calling System Is Illustration Based' ; Š   /*Solve for Illustration?*/ v_('TARGET Total Target Premium'('CalcType LTGT'(calcType);yearIndex)) ; Š   /*else use target from INPUT*/ VECTORX(cov;0;'Policy Number Of Coverage'(calcType;TransEffDur) - 1;V_('Policy Coverage TargetPremAmt'(#cov);#cov + 1))Š);0 // assumes premiums paid annually in advanceŠ) /  // to get rate rather than charge amountŠ'SharedVector SolveParms Premium'(vectorSolveParms;yearIndex)
F1 3a9f513b 135debb4 0 0 0 0 2
SLV IG Premium Load Premium Guess(calcType; baseFace; vectorSearchCriteria)
Funktion
'Solve Init Guess Annualize PV Charges'(baseFace;vectorSearchCriteria) / 'Solve Criteria Premium Duration'(vectorSearchCriteria)
F1 7981e5b8 71848698 0 0 0 0 2
Solve DB Option 3 Payment Adj Factor(vectorSearchCriteria, yearIndex; vectorSolveParms)
Funktion
IF ( /*Death benefit is option C and not seven pay*/ 'DeathBenefitOptType Is IncreasingROP'('Solve DthBenOpt'('CalcType SolveCriteria'(vectorSearchCriteria);yearIndex;vectorSolveParms)) ; Š   /*Yes*/ IF ( /*If R-factor is 1*/ 'Solve R Factor'(vectorSearchCriteria;yearIndex;vectorSolveParms) = 1 ; Š     /*Multiply by 12*/ 12 ; Š     /*Else compound R factor by 12*/ (1 - ('Solve R Factor'(vectorSearchCriteria;yearIndex;vectorSolveParms) ^ 12)) / (1 - 'Solve R Factor'(vectorSearchCriteria;yearIndex;vectorSolveParms))Š  ) * 'Solve Annualize Product R Factor'(vectorSearchCriteria;yearIndex;vectorSolveParms) // Discount from beginning of year back to issue date   Š * (yearIndex * 'COV COI Rate'('CalcType SolveCriteria'(vectorSearchCriteria);0;yearIndex;vectorSolveParms) * 0.001) * 'Solve R Factor'(vectorSearchCriteria;yearIndex;vectorSolveParms) * IF ( /*waiver exists and is active*/ 'Solve Waiver Exists and Is Inforce for Interest Rate'(vectorSearchCriteria;yearIndex;vectorSolveParms) ; Š   // A CovOption object is included under the Base Coverage for WMD‰‰Š/*Yes*/(1 + 'COV CovOption COI Rate'('CalcType SolveCriteria'(vectorSearchCriteria);0;'Std CovOption Index'('CalcType SolveCriteria'(vectorSearchCriteria);0;'OptType WMD');yearIndex)) ; Š   /*No*/ 1Š) ; Š /*No*/ 0Š)
F1 26503a8 24e83b0 2650780 2651908 0 0 2
-- Premium Search Criteria Vector Extraction Functions --
Funktion
Š
F1 2650780 26503a8 2650898 2650b40 0 0 2
Solve Criteria Target CV(vectorSearchCriteria)
Funktion
e_(vectorSearchCriteria;1)
F1 2650898 2650780 0 0 0 0 2
Solve Criteria Target Premium(vectorSearchCriteria)
Funktion
e_(vectorSearchCriteria;1)
F1 2650b40 26503a8 0 2650c60 0 0 2
Solve Criteria Target Duration(vectorSearchCriteria)
Funktion
e_(vectorSearchCriteria;2)
F1 2650c60 26503a8 0 2650d80 0 0 2
Solve Criteria Premium Duration(vectorSearchCriteria)
Funktion
e_(vectorSearchCriteria;3)
F1 2650d80 26503a8 0 2650ea0 0 0 2
Solve Criteria Interest Rate(vectorSearchCriteria; yearIndex)
Funktion
IF (v_LENGTH(e_(vectorSearchCriteria;4)) = 0 || yearIndex < 1 ; Š  e_(vectorSearchCriteria;4) ; Š  e_(e_(vectorSearchCriteria;4);MIN(v_LENGTH(e_(vectorSearchCriteria;4));yearIndex) - 1)Š)
F1 2650ea0 26503a8 0 2650fc0 0 0 2
Solve Criteria CV Tolerance(vectorSearchCriteria)
Funktion
e_(vectorSearchCriteria;5)
F1 2650fc0 26503a8 0 26510e0 0 0 2
Solve Criteria Premium Tolerance(vectorSearchCriteria)
Funktion
e_(vectorSearchCriteria;6)
F1 26510e0 26503a8 0 2651208 0 0 2
Solve Criteria Requested Stop Duration(vectorSearchCriteria)
Funktion
e_(vectorSearchCriteria;7)
F1 2651208 26503a8 2651520 559cf351 0 0 2
Solve Criteria Addl Info(vectorSearchCriteria)
Funktion
e_(vectorSearchCriteria;8)
F1 2651520 2651208 0 2651608 0 0 2
Solve Start Year(vectorSearchCriteria)
Funktion
'SharedVector CVPROJAddlInfo StartYear'('Solve Criteria Addl Info'(vectorSearchCriteria))
F1 2651608 2651208 0 44f8b8 0 0 2
SLV LoadTargetPremium(vectorSearchCriteria)
Funktion
SUMX(target_coverageIndex;0;V_LENGTH('SharedVector CVPROJAddlInfo LoadTargetPremium'(('Solve Criteria Addl Info'(vectorSearchCriteria)))) - 1;E_(E_('SharedVector CVPROJAddlInfo LoadTargetPremium'(('Solve Criteria Addl Info'(vectorSearchCriteria)));#target_coverageIndex);0))
F1 44f8b8 2651208 0 7174b1ba 0 0 2
Solve Criteria Replace GuidelinePremiums(vectorSearchCriteria; faceAmount)
Funktion
IF ('SharedVector CVPROJAddlInfo AdjustForGuidelines'('Solve Criteria Addl Info'(vectorSearchCriteria)) ; Š  V_REPLACE(vectorSearchCriteria;V_REPLACE('Solve Criteria Addl Info'(vectorSearchCriteria);V_('TaxCompliance Guideline Level Premium FaceSolve'("GLP";faceAmount);'TaxCompliance Guideline Single Premium FaceSolve'("GSP";faceAmount));3);8) ; Š  vectorSearchCriteriaŠ)
F1 7174b1ba 2651208 0 4e1d5b98 0 0 2
-- Solve Criteria Replace Target(vectorSearchCriteria; faceAmount)
Funktion
IF('Solve Target Premiums used for Premium Loads'(vectorSearchCriteria);Š‰V_REPLACE(vectorSearchCriteria;Š‰‰V_REPLACE('Solve Criteria Addl Info'(vectorSearchCriteria);Š‰‰‰V_('TARGET Total Target Premium FaceSolve'(Š‰‰‰‰faceAmount;Š‰‰‰‰'CalcType LTGT'('CalcType SolveCriteria'(vectorSearchCriteria))Š‰‰‰));Š‰‰‰6Š‰‰);Š‰‰8Š‰);Š‰vectorSearchCriteriaŠ)
F1 4e1d5b98 2651208 3bf1066d 0 0 0 2
Solve Criteria Replace Target(vectorSearchCriteria; faceAmount; yearIndex)
Funktion
IF ('Solve Target Premiums used for Premium Loads'(vectorSearchCriteria) ; Š  V_REPLACE(vectorSearchCriteria;V_REPLACE('Solve Criteria Addl Info'(vectorSearchCriteria);V_('TARGET Total Target Premium FaceSolve'(faceAmount;'CalcType LTGT'('CalcType SolveCriteria'(vectorSearchCriteria))));6);8) ; Š  vectorSearchCriteriaŠ)
F1 3bf1066d 4e1d5b98 0 0 0 0 2
Solve Target Premiums used for Premium Loads(vectorSearchCriteria)
Funktion
IF ('PLC Premium Load Rule'('CalcType SolveCriteria'(vectorSearchCriteria);1;'FeeType PremiumLoad') ALIKE "1000500005" || 'PLC Premium Load Rule'('CalcType SolveCriteria'(vectorSearchCriteria);1;'FeeType PremiumLoad') ALIKE "1000500007" || 'PLC Premium Load Rule'('CalcType SolveCriteria'(vectorSearchCriteria);2;'FeeType PremiumLoad') ALIKE "1000500005" || 'PLC Premium Load Rule'('CalcType SolveCriteria'(vectorSearchCriteria);2;'FeeType PremiumLoad') ALIKE "1000500007" || 'PLC Premium Load Rule'('CalcType SolveCriteria'(vectorSearchCriteria);3;'FeeType PremiumLoad') ALIKE "1000500005" || 'PLC Premium Load Rule'('CalcType SolveCriteria'(vectorSearchCriteria);3;'FeeType PremiumLoad') ALIKE "1000500007" ; Š  1 ; Š  0Š)
F1 559cf351 26503a8 0 48e42044 0 0 2
Solve Criteria Calc Type(vectorSearchCriteria)
Funktion
e_(vectorSearchCriteria;0)
F1 48e42044 26503a8 0 509b39dd 0 0 2
Solve Use COI In Corridor(vectorSearchCriteria)
Funktion
 /*CASE('CalcType Shadow Is Active'('CalcType SolveCriteria'(vectorSearchCriteria));Š‰"CurrCV", "SHADOW"‰:‰1;Š‰‰‰‰‰‰‰:‰0Š)*/ 'CalcType Shadow Is Active'('CalcType SolveCriteria'(vectorSearchCriteria)) || 'CalcType Rate Assumption Is Active'('CalcType SolveCriteria'(vectorSearchCriteria))
F1 509b39dd 26503a8 0 0 0 0 2
Solve FaceSolve Target Value(currGuess; currCashValue; prevGuess; prevCashValue; vectorSearchCriteria)
Funktion
CASE('Illus Face Amt Solve DesignType'('CalcType SolveCriteria'(vectorSearchCriteria));Š   // Guidelines, 7-pay, target premŠ1000500002;1000500003;1000500004;1000500007; //Endow on current assumptions;  base/term mixŠ1000500009;1000500011 : 'Solve Premium Guess2'(currGuess;currCashValue;prevGuess;prevCashValue);Š   // MNLP, Shadow account; Target CV at target Duration ("endows" at target cv)Š : 'Solve Criteria Target CV'(vectorSearchCriteria))Š
F1 2651908 24e83b0 26519f8 2652ef8 0 0 2
-- Solve Annual Cash Value Calculations --
Funktion

F1 26519f8 2651908 48547467 5b19d801 0 0 2
Solve End Of Year Cash Value Rec(calcType; vectorSolveParms; projInterestRate; yearIndex; monthIndex; vectorSearchCriteria)
Funktion
'GEN Round'(IF ( /*First month of projection period*/ (('SharedVector CVPROJAddlInfo StartMonth'('Solve Criteria Addl Info'(vectorSearchCriteria)) = 1) && (yearIndex <= 'SharedVector CVPROJAddlInfo StartYear'('Solve Criteria Addl Info'(vectorSearchCriteria)) - 1) && (monthIndex = 12)) || (('SharedVector CVPROJAddlInfo StartMonth'('Solve Criteria Addl Info'(vectorSearchCriteria)) > 1) && (yearIndex = 'SharedVector CVPROJAddlInfo StartYear'('Solve Criteria Addl Info'(vectorSearchCriteria))) && (monthIndex = 'SharedVector CVPROJAddlInfo StartMonth'('Solve Criteria Addl Info'(vectorSearchCriteria)) - 1)) ; Š   // At the starting point of the projectionŠIF ('SharedVector CVPROJAddlInfo IsInforceCalc'(calcType;'Solve Criteria Addl Info'(vectorSearchCriteria)) ; Š    'Policy Life CashValueAmt' ; Š    0Š  ) ; Š // Else need to recursively determine the EOM CVŠIF ('Solve Neg NAR Check'(calcType;'Solve End Of Year Cash Value Rec'(calcType;vectorSolveParms;projInterestRate;yearIndex - 1;12;vectorSearchCriteria);vectorSolveParms;yearIndex;vectorSearchCriteria;V_(1;0;'Solve COI Cov for R Factor'(vectorSearchCriteria;yearIndex;vectorSolveParms;v_(1;0)))) = 1 ; Š  'Solve Annual Cash Value'('Solve End Of Year Cash Value Rec'(calcType;vectorSolveParms;projInterestRate;yearIndex - 1;12;vectorSearchCriteria);vectorSolveParms;yearIndex;vectorSearchCriteria;V_(1;0;'Solve COI Cov for R Factor'(vectorSearchCriteria;yearIndex;vectorSolveParms;v_(1;0)))) ; Š  IF ('Solve Neg NAR Check'(calcType;'Solve End Of Year Cash Value Rec'(calcType;vectorSolveParms;projInterestRate;yearIndex - 1;12;vectorSearchCriteria);vectorSolveParms;yearIndex;vectorSearchCriteria;V_(1;0;'Solve COI Cov for R Factor'(vectorSearchCriteria;yearIndex;vectorSolveParms;v_(1;0)))) = 2 ; Š    'Solve Annual Cash Value'('Solve End Of Year Cash Value Rec'(calcType;vectorSolveParms;projInterestRate;yearIndex - 1;12;vectorSearchCriteria);vectorSolveParms;yearIndex;vectorSearchCriteria;V_('Solve Use COI In Corridor'(vectorSearchCriteria);1;'Solve COI Cov for R Factor'(vectorSearchCriteria;yearIndex;vectorSolveParms;v_(1;0)))) ; Š    'Solve Monthly Cash Value rec'('Solve End Of Year Cash Value Rec'(calcType;vectorSolveParms;projInterestRate;yearIndex - 1;12;vectorSearchCriteria);vectorSolveParms;yearIndex;12;vectorSearchCriteria)Š  )Š)Š); // Number of places to roundŠ'ACCS Decimal'(calcType))
F1 48547467 26519f8 0 64a44c54 0 0 2
Solve Monthly Cash Value rec(prevEOYCV; vectorSolveParms; yearIndex; monthIndex; vectorSearchCriteria)
Funktion
IF (monthIndex = 1 ; Š  'CVProjection Monthly BOM Cash Value'('CalcType SolveCriteria'(vectorSearchCriteria);prevEOYCV;vectorSolveParms;'Solve Criteria Interest Rate'(vectorSearchCriteria;yearIndex);'Solve Criteria Addl Info'(vectorSearchCriteria);yearIndex;monthIndex) * 'GEN Future Value Factor'('Solve Criteria Interest Rate'(vectorSearchCriteria;yearIndex);(1 / 12)) ; Š  'CVProjection Monthly BOM Cash Value'('CalcType SolveCriteria'(vectorSearchCriteria);'Solve Monthly Cash Value rec'(prevEOYCV;vectorSolveParms;yearIndex;monthIndex - 1;vectorSearchCriteria);vectorSolveParms;'Solve Criteria Interest Rate'(vectorSearchCriteria;yearIndex);'Solve Criteria Addl Info'(vectorSearchCriteria);yearIndex;monthIndex) * 'GEN Future Value Factor'('Solve Criteria Interest Rate'(vectorSearchCriteria;yearIndex);(1 / 12))Š)
F1 64a44c54 26519f8 79d2cf47 7744e11a 0 0 2
Solve Neg NAR Check(calcType; prevEOYCV; vectorSolveParms; yearIndex; vectorSearchCriteria; corridorInd)
Funktion
IF (('DeathBenefitOptType Is Increasing'('Solve DthBenOpt'('CalcType SolveCriteria'(vectorSearchCriteria);yearIndex;vectorSolveParms)) || (('Solve Annual Cash Value'(prevEOYCV;vectorSolveParms;yearIndex;vectorSearchCriteria;corridorInd) <= 'Solve NAR Death Benefit'(calcType;yearIndex;vectorSolveParms;vectorSearchCriteria)) && (prevEOYCV //'Solve Annual Cash Value'(prevPrevEOYCV; vectorSolveParms; yearIndex-1; vectorSearchCriteria; corridorInd)Š <= 'Solve NAR Death Benefit'(calcType;yearIndex;vectorSolveParms;vectorSearchCriteria)) && ('Solve Beg of First Month Pre NAR CashValue'(prevEOYCV;vectorSolveParms;yearIndex;vectorSearchCriteria) <= 'Solve NAR Death Benefit'(calcType;yearIndex;vectorSolveParms;vectorSearchCriteria)))) && NOT('Solve COI Cov for R Factor Change'(vectorSearchCriteria;prevEOYCV;yearIndex;vectorSolveParms;corridorInd)) ; Š  1 ; Š  IF (('Solve Annual Cash Value'(prevEOYCV;vectorSolveParms;yearIndex;vectorSearchCriteria;V_('Solve Use COI In Corridor'(vectorSearchCriteria);0) /*corridorInd*/ ) > 'Solve NAR Death Benefit'(calcType;yearIndex;vectorSolveParms;vectorSearchCriteria)) && (prevEOYCV > 'Solve NAR Death Benefit'(calcType;yearIndex;vectorSolveParms;vectorSearchCriteria)) && NOT('Solve COI Cov for R Factor Change'(vectorSearchCriteria;prevEOYCV;yearIndex;vectorSolveParms;corridorInd)) ; Š    2 ; Š    3Š  )Š)
F1 79d2cf47 64a44c54 7a9a152c 0 0 0 2
Solve NAR Death Benefit(calcType; yearIndex; vectorSolveParms; vectorSearchCriteria)
Funktion
('Solve Base and Increase FaceAmount'(calcType;vectorSolveParms;yearIndex) + IF ('DeathBenefitOptType Is IncreasingROP'('Solve DthBenOpt'('CalcType SolveCriteria'(vectorSearchCriteria);yearIndex;vectorSolveParms)) ; Š  'Solve Cumulative Premium'(yearIndex;vectorSolveParms;vectorSearchCriteria) ; Š  0Š)) / 'NAAR Corridor Factor'('CalcType SolveCriteria'(vectorSearchCriteria);yearIndex)
F1 7a9a152c 79d2cf47 0 0 0 0 2
Solve Cumulative Premium(yearIndex; vectorSolveParms; vectorSearchCriteria)
Funktion
IF (yearIndex <= 'Solve Start Year'(vectorSearchCriteria) ; Š  'SharedVector SolveParms Premium'(vectorSolveParms;yearIndex) ; Š  IF (yearIndex > MIN('Solve Criteria Premium Duration'(vectorSearchCriteria) + ('Solve Start Year'(vectorSearchCriteria) - 1);'Solve Criteria Target Duration'(vectorSearchCriteria)) ; Š    0 ; Š    'Solve Cumulative Premium'(yearIndex - 1;vectorSolveParms;vectorSearchCriteria) + 'SharedVector SolveParms Premium'(vectorSolveParms;yearIndex)Š  )Š)
F1 7744e11a 26519f8 0 2652d68 0 0 2
Solve Beg of First Month Pre NAR CashValue(prevEOYCV; vectorSolveParms; yearIndex; vectorSearchCriteria)
Funktion
prevEOYCV + 'SharedVector SolveParms Premium'(vectorSolveParms;yearIndex) * IF ( /*Does calctype use fees?*/ 'CHG Calc Type Uses Fees'('CalcType SolveCriteria'(vectorSearchCriteria)) ; Š   /*Yes - calculate net premium*/ 'Solve Net Premium Factor'(vectorSearchCriteria;yearIndex;1) ; Š   // Else calc type doesn't include feesŠ1Š) -  //'Solve Premium Loads'(yearIndex; 'SharedVector SolveParms Premium'(vectorSolveParms; yearIndex); vectorSearchCriteria)Š'Solve Premium Loads'(vectorSolveParms;vectorSearchCriteria;yearIndex) -  // Expense chargesŠIF ( /*Does calc type use fees?*/ 'CHG Calc Type Uses Fees'('CalcType SolveCriteria'(vectorSearchCriteria)) ; Š /*Yes - add expenses*/ 'Solve Init Guess Monthly Expenses'('CalcType SolveCriteria'(vectorSearchCriteria);yearIndex;1;'SharedVector SolveParms Shorten for Charges'(vectorSolveParms)) * 'Solve Non COI Timing Adjustment'(vectorSearchCriteria;yearIndex;'SharedVector SolveParms Shorten for Charges'(vectorSolveParms)) ; Š /*No - exclude expenses*/ 0Š) // Benefit charges associated with the base coverageŠ + 'COV Projected Monthly Total CovOption Charge'('CalcType SolveCriteria'(vectorSearchCriteria);'Std BaseCov Index'('CalcType SolveCriteria'(vectorSearchCriteria));yearIndex;1;'SharedVector SolveParms Shorten for Charges'(vectorSolveParms)) // Rider charges not associated with NARŠ + 'Solve Init Guess Monthly NonNAR Coverage Charge'('CalcType SolveCriteria'(vectorSearchCriteria);yearIndex;'SharedVector SolveParms Shorten for Charges'(vectorSolveParms)) * 'Solve Non COI Timing Adjustment'(vectorSearchCriteria;yearIndex;'SharedVector SolveParms Shorten for Charges'(vectorSolveParms))
F1 2652d68 26519f8 0 401ec53b 0 0 2
Solve Specified Amount(calcType; vectorSolveparms)
Funktion
IF ('SharedVector SolveParms FaceAmount Passed'(0;vectorSolveParms) ; Š  'SharedVector SolveParms FaceAmount'(0;vectorSolveParms;'SharedVector SolveParms StartYear'(vectorSolveParms)) ; Š  SUMX(cov;0;'Policy Number Of Coverage'(calcType;TransEffDur) - 1;IF ( /*Coverage in force, and not a rider*///'Coverage Is InForce'(calcType; #cov; TransEffDate; TransEffDur) Š 'Std Coverage Is InForce'(calcType;#cov;TransEffDate;TransEffDur) && ('IndicatorCode is Base'('Policy Coverage IndicatorCode'(calcType;#cov)) || 'IndicatorCode is BaseIncrease'('Policy Coverage IndicatorCode'(calcType;#cov))) ; Š     /*Include specified amount in total for policy*/ 'Policy Coverage CurrentNumberOfUnits'(calcType;#cov;TransEffDur) * 'PI CoverageProduct ValuePerUnit'(calcType;'Policy Coverage ProductCode'(calcType;#cov);#cov;'Policy EffDate') ; Š     // Else return zero for coverageŠ0Š  ))Š)
F1 401ec53b 26519f8 25408f12 7efd9428 0 0 2
Solve Annual Cash Value(prevEOYCV; vectorSolveParms; yearIndex; vectorSearchCriteria; corridorInd)
Funktion
(prevEOYCV + ('PREMIUM Projected GrossPremium'('CalcType SolveCriteria'(vectorSearchCriteria);vectorSolveParms;'Solve Criteria Addl Info'(vectorSearchCriteria);yearIndex;1) * IF ( /*Does calctype use fees?*/ 'CHG Calc Type Uses Fees'('CalcType SolveCriteria'(vectorSearchCriteria)) ; Š   /*Yes - calculate net premium*/ 'Solve Net Premium Factor'(vectorSearchCriteria;yearIndex;1) ; Š   // Else calc type doesn't include feesŠ1Š) -  //'Solve Target Premium Loads'(vectorSolveParms; vectorSearchCriteria; yearIndex; 1)Š//'Solve Premium Loads'(yearIndex; 'SharedVector SolveParms Premium'(vectorSolveParms; yearIndex); vectorSearchCriteria)Š'Solve Premium Loads'(vectorSolveParms;vectorSearchCriteria;yearIndex)) //Multiply by modal premium annuity factor. Š * 'Solve Premium Modal Factor'(vectorSolveParms;yearIndex;vectorSearchCriteria;corridorInd) -  // Base COI chargeŠ('Solve Init Guess COI Charges Projection'(vectorSolveParms;vectorSearchCriteria;yearIndex;corridorInd) * 'Solve DB Adj Factor New'(vectorSearchCriteria;yearIndex;'SharedVector SolveParms Shorten for Charges'(vectorSolveParms);corridorInd) * IF (e_(corridorInd;1) ; Š0 ; Š1Š) + ( // Benefit charges associated with the base coverageŠ'COV Projected Monthly Total CovOption Charge'('CalcType SolveCriteria'(vectorSearchCriteria);'Std BaseCov Index'('CalcType SolveCriteria'(vectorSearchCriteria));yearIndex;1;'SharedVector SolveParms Shorten for Charges'(vectorSolveParms)) // Rider charges not associated with NARŠ + 'Solve Init Guess Monthly NonNAR Coverage Charge'('CalcType SolveCriteria'(vectorSearchCriteria);yearIndex;'SharedVector SolveParms Shorten for Charges'(vectorSolveParms)) * 'Solve Non COI Timing Adjustment'(vectorSearchCriteria;yearIndex;'SharedVector SolveParms Shorten for Charges'(vectorSolveParms))) * 'Solve Choose Exp Rider Adj Factor'(vectorSearchCriteria;yearIndex;'SharedVector SolveParms Shorten for Charges'(vectorSolveParms);corridorInd)) * (1 - ('Solve Choose R Factor'(vectorSearchCriteria;yearIndex;'SharedVector SolveParms Shorten for Charges'(vectorSolveParms);corridorInd) ^ 12)) / (1 - 'Solve Choose R Factor'(vectorSearchCriteria;yearIndex;'SharedVector SolveParms Shorten for Charges'(vectorSolveParms);corridorInd)) - 'Solve Init Guess R Adjusted Annual Expenses'(yearIndex;vectorSolveParms;vectorSearchCriteria;corridorInd) * 'Solve Choose Exp Rider Adj Factor'(vectorSearchCriteria;yearIndex;'SharedVector SolveParms Shorten for Charges'(vectorSolveParms);corridorInd)) / 'Solve Choose R Factor'(vectorSearchCriteria;yearIndex;'SharedVector SolveParms Shorten for Charges'(vectorSolveParms);corridorInd) ^ 12
F1 25408f12 401ec53b 0 41468811 0 0 2
Solve Premium Modal Factor(vectorSolveParms; yearIndex; vectorSearchCriteria; corridorInd)
Funktion
IF (NOT('PaymentMode is Annual'('Solve Premium Mode'('CalcType SolveCriteria'(vectorSearchCriteria)))) ; Š  (1 - 'Solve Choose R Factor'(vectorSearchCriteria;yearIndex;'SharedVector SolveParms Shorten for Charges'(vectorSolveParms);corridorInd) ^ 12) / (1 - 'Solve Choose R Factor'(vectorSearchCriteria;yearIndex;'SharedVector SolveParms Shorten for Charges'(vectorSolveParms);corridorInd) ^ 'GEN Months In Paymode'('Solve Premium Mode'('CalcType SolveCriteria'(vectorSearchCriteria)))) ; Š  1Š)
F1 41468811 401ec53b 0 43dffb3d 0 0 2
Solve Premium Mode(calcType)
Funktion
'ACCS CalcRule Target Premium Mode'(calcType;'Policy CarrierCode';'Policy ProductCode';'Policy EffDate')
F1 43dffb3d 401ec53b 0 0 0 0 2
Solve R Factor Modal(mode; vectorSolveParms; yearIndex; vectorSearchCriteria; corridorInd)
Funktion
(1 - 'Solve Choose R Factor'(vectorSearchCriteria;yearIndex;'SharedVector SolveParms Shorten for Charges'(vectorSolveParms);corridorInd) ^ 12) / (1 - 'Solve Choose R Factor'(vectorSearchCriteria;yearIndex;'SharedVector SolveParms Shorten for Charges'(vectorSolveParms);corridorInd) ^ 'GEN Months In Paymode'(mode))
F1 7efd9428 26519f8 0 0 0 0 2
Solve Init Guess COI Charges Projection(vectorSolveParms; vectorSearchCriteria; yearIndex; corridorInd)
Funktion
SUMX(covIndex;0;'Policy Number Of Coverage'('CalcType SolveCriteria'(vectorSearchCriteria);yearIndex) - 1;IF ('Coverage Is NAR Cost'('CalcType SolveCriteria'(vectorSearchCriteria);#covIndex) ; Š  ((('SharedVector SolveParms FaceAmount'(#covIndex;vectorSolveParms;yearIndex) + IF ('DeathBenefitOptType Is IncreasingROP'('Solve DthBenOpt'('CalcType SolveCriteria'(vectorSearchCriteria);yearIndex;vectorSolveParms)) ; Š    'Solve Cumulative Premium'(yearIndex;vectorSolveParms;vectorSearchCriteria) ; Š    0Š  )) / 'NAAR Discount Factor'('CalcType SolveCriteria'(vectorSearchCriteria))) * 'COV COI Rate'('CalcType SolveCriteria'(vectorSearchCriteria);MAX(#covIndex;IF (V_LENGTH(corridorInd) >= 3 ; Š  E_(corridorInd;2) ; Š  0Š));yearIndex;vectorSolveParms) * 0.001) //‰‰/(1 + 'COV COI Rate'('CalcType SolveCriteria'(vectorSearchCriteria);#covIndex;  yearIndex; vectorSolveParms) Š / (1 + 'COV COI Rate'('CalcType SolveCriteria'(vectorSearchCriteria);IF (V_LENGTH(corridorInd) >= 3 ; ŠE_(corridorInd;2) ; Š0Š);yearIndex;vectorSolveParms) * 0.001) ; Š0Š))
F1 5b19d801 2651908 56c95656 1b3cd053 0 0 2
Solve Monthly End Of Month Cash Value Rec(calcType; vectorSolveParms; projInterestRate; vectorAddlInfo; yearIndex; monthIndex; vectorSearchCriteria)
Funktion
'GEN Round'(IF ( /*First month of projection period*/ (('SharedVector CVPROJAddlInfo StartMonth'(vectorAddlInfo) = 1) && (yearIndex = 'SharedVector CVPROJAddlInfo StartYear'(vectorAddlInfo) - 1) && (monthIndex = 12)) || (('SharedVector CVPROJAddlInfo StartMonth'(vectorAddlInfo) > 1) && ('SharedVectorCVPROJAddlInfo Year Equals StartYear'(vectorAddlInfo;yearIndex)) && (monthIndex = 'SharedVector CVPROJAddlInfo StartMonth'(vectorAddlInfo) - 1)) ; Š   // At the starting point of the projectionŠIF ('SharedVector CVPROJAddlInfo IsInforceCalc'(calcType;vectorAddlInfo) ; Š    'Policy Life CashValueAmt' ; Š    0Š  ) ; Š // Else need to recursively determine the EOM CVŠIF (monthIndex = 12 && 'Solve Monthly End Of Month Cash Value Rec'(calcType;vectorSolveParms;projInterestRate;vectorAddlInfo;yearIndex - 1;12;vectorSearchCriteria) + 'SharedVector SolveParms Premium'(vectorSolveParms;yearIndex) * 'GEN Future Value Factor'(projInterestRate;(1 / 12)) < 'Solve Specified Amount'(calcType;vectorSolveParms) ; Š  'Solve Annual BOM Cash Value'(calcType;'Solve Monthly End Of Month Cash Value Rec'(calcType;vectorSolveParms;projInterestRate;vectorAddlInfo;yearIndex - 1;12;vectorSearchCriteria);vectorSolveParms;yearIndex;vectorSearchCriteria) ; Š  'CVProjection Monthly BOM Cash Value'(calcType;IF (monthIndex > 1 ; Š     // Reduce month index by 1Š'Solve Monthly End Of Month Cash Value Rec'(calcType;vectorSolveParms;projInterestRate;vectorAddlInfo;yearIndex;monthIndex - 1;vectorSearchCriteria) ; Š     // Reduce year index by 1 and set month index to 12Š'Solve Monthly End Of Month Cash Value Rec'(calcType;vectorSolveParms;projInterestRate;vectorAddlInfo;yearIndex - 1;12;vectorSearchCriteria)Š  );vectorSolveParms;projInterestRate;vectorAddlInfo;yearIndex;monthIndex) *  // Apply interest based on projected interest rateŠ'GEN Future Value Factor'(projInterestRate;(1 / 12))Š)Š); // Number of places to roundŠ'ACCS Decimal'(calcType))
F1 56c95656 5b19d801 0 0 0 0 2
Solve Annual BOM Cash Value(calcType; prevEOYCV; vectorSolveParms; yearIndex; vectorSearchCriteria)
Funktion
(prevEOYCV + 'SharedVector SolveParms Premium'(vectorSolveParms;yearIndex) * 'Solve Net Premium Factor'(vectorSearchCriteria;yearIndex;0) //Could use some enhancement for other than annual premiumsŠ -  //'Solve Premium Loads'(yearIndex; 'SharedVector SolveParms Premium'(vectorSolveParms; yearIndex); vectorSearchCriteria)Š'Solve Premium Loads'(vectorSolveParms;vectorSearchCriteria;yearIndex) - 'Solve Init Guess Total Charges'('Solve Specified Amount'(calcType;vectorSolveParms);vectorSearchCriteria;yearIndex) * (1 - ('Solve R Factor'(vectorSearchCriteria;yearIndex;vectorSolveParms) ^ 12)) / (1 - 'Solve R Factor'(vectorSearchCriteria;yearIndex;vectorSolveParms))) / 'Solve R Factor'(vectorSearchCriteria;yearIndex;vectorSolveParms) ^ 12
F1 1b3cd053 2651908 0 10ab2f4a 0 0 2
Solve Test Monthly End of Month Cash Value Rec(calcType; vectorSolveParms; projInterestRate; yearIndex; monthIndex)
Funktion
'Solve Monthly End Of Month Cash Value Rec'('CalcType GLP'(calcType);vectorSolveParms;projInterestRate;'Solve Test CVAddlInfo Vector'('CalcType GLP'(calcType));yearIndex;monthIndex;v_('CalcType GLP'(calcType); //calcType;Š1000000; //targetCashValue;Š65; //targetDuration;Š'SharedVector SolveParms PremiumDuration'(vectorSolveParms);projInterestRate;0.01; //cashValueTolerance;Š0.001; //premiumValueTolerance;Š'Constant Stop Iteration'; //stopIteration;Š'Solve Test CVAddlInfo Vector'(calcType)))
F1 10ab2f4a 2651908 0 6759bfc5 0 0 2
Solve Annualize Product R Factor new(vectorSearchCriteria; yearIndex; vectorSolveParms; corridorInd)
Funktion
IF ( /*start year?*/ yearIndex = 'Solve Start Year'(vectorSearchCriteria) ; Š   /*Yes*/ 1.0 ; Š   /*No - calculate recursively*/ 'Solve Annualize Product R Factor new'(vectorSearchCriteria;yearIndex - 1;vectorSolveParms;corridorInd) * ('Solve Choose R Factor'(vectorSearchCriteria;yearIndex - 1;vectorSolveParms;corridorInd) ^ 12)Š)
F1 6759bfc5 2651908 0 53b81d8c 0 0 2
Solve DB Adj Factor new(vectorSearchCriteria; yearIndex; vectorSolveParms; corridorInd)
Funktion
IF ( /*waiver exists and is active*/ 'Solve Waiver Exists and Is Inforce'(vectorSearchCriteria;yearIndex;vectorSolveParms) ; Š   // A CovOption object is included under the Base Coverage for WMD‰‰Š/*Yes*/('GEN Future Value Factor'('Solve Criteria Interest Rate'(vectorSearchCriteria;yearIndex);(1 / 12)) * (1 + 'COV COI Rate'('CalcType SolveCriteria'(vectorSearchCriteria);0;yearIndex;vectorSolveParms) * 0.001 * e_(corridorInd;0)) * (1 + 'COV CovOption COI Rate'('CalcType SolveCriteria'(vectorSearchCriteria);0;'Std CovOption Index'('CalcType SolveCriteria'(vectorSearchCriteria);0;'OptType WMD');yearIndex))) * 'Solve Choose R Factor'(vectorSearchCriteria;yearIndex;vectorSolveParms;corridorInd) ; Š   /*No*/ IF ( /*Is death benefit option 1 or option 3?*/ 'DeathBenefitOptType Is Level'('Solve DthBenOpt'('CalcType SolveCriteria'(vectorSearchCriteria);yearIndex;vectorSolveParms)) || 'DeathBenefitOptType Is IncreasingROP'('Solve DthBenOpt'('CalcType SolveCriteria'(vectorSearchCriteria);yearIndex;vectorSolveParms)) ; Š     /*Yes*/ 1 ; Š     /*No*/ ('GEN Future Value Factor'('Solve Criteria Interest Rate'(vectorSearchCriteria;yearIndex);(1 / 12)) * (1 + 'COV COI Rate'('CalcType SolveCriteria'(vectorSearchCriteria);0;yearIndex;vectorSolveParms) * 0.001 * e_(corridorInd;0))) * 'Solve Choose R Factor'(vectorSearchCriteria;yearIndex;vectorSolveParms;corridorInd)Š  )Š)
F1 53b81d8c 2651908 784be161 333349ae 0 0 2
Solve DB Option 3 Payment Adj Factor new(vectorSearchCriteria; yearIndex; vectorSolveParms; targetLoadInd)
Funktion
IF (yearIndex >= 'Solve Criteria Target Duration'(vectorSearchCriteria) - 1 || 'Solve Discount Neg NAR Check'('Solve Discounted Endowment Value'(vectorSearchCriteria;yearIndex;12;vectorSolveParms;targetLoadInd);vectorSolveParms;yearIndex;vectorSearchCriteria;V_(1;0);targetLoadInd) = 1 ; Š  'Solve DB Option 3 Payment Adj Factor Annual'(vectorSearchCriteria;yearIndex;vectorSolveParms;V_(1;0)) ; Š  IF ('Solve Discount Neg NAR Check'('Solve Discounted Endowment Value'(vectorSearchCriteria;yearIndex;12;vectorSolveParms;targetLoadInd);vectorSolveParms;yearIndex;vectorSearchCriteria;V_(1;0);targetLoadInd) = 2 ; Š    'Solve DB Option 3 Payment Adj Factor Annual'(vectorSearchCriteria;yearIndex;vectorSolveParms;V_(0;0)) ; Š    'Solve DB Option 3 Payment Adj Factor Monthly'('Solve Discounted Endowment Value'(vectorSearchCriteria;yearIndex;12;vectorSolveParms;targetLoadInd);vectorSearchCriteria;yearIndex;12;vectorSolveParms;targetLoadInd)Š  )Š)
F1 784be161 53b81d8c 3c8a32a6 3f184711 0 0 2
Solve DB Option 3 Payment Adj Factor Annual(vectorSearchCriteria, yearIndex; vectorSolveParms; corridorInd)
Funktion
IF ( /*If R-factor is 1*/ 'Solve Choose R Factor'(vectorSearchCriteria;yearIndex;vectorSolveParms;corridorInd) = 1 ; Š   /*Multiply by 12*/ 12 ; Š   /*Else compound R factor by 12*/ (1 - ('Solve Choose R Factor'(vectorSearchCriteria;yearIndex;vectorSolveParms;corridorInd) ^ 12)) / (1 - 'Solve Choose R Factor'(vectorSearchCriteria;yearIndex;vectorSolveParms;corridorInd))Š) * 'Solve DB Option 3 Payment Adj Factor calc'(vectorSearchCriteria;yearIndex;vectorSolveParms;corridorInd)
F1 3c8a32a6 784be161 0 0 0 0 2
Solve DB Option 3 Payment Adj Factor calc(vectorSearchCriteria; yearIndex; vectorSolveParms; corridorInd)
Funktion
yearIndex * 'COV COI Rate'('CalcType SolveCriteria'(vectorSearchCriteria);0;yearIndex;vectorSolveParms) * 0.001 * e_(corridorInd;0) * IF ( /*waiver exists and is active*/ 'Solve Waiver Exists and Is Inforce for Interest Rate'(vectorSearchCriteria;yearIndex;vectorSolveParms) ; Š   // A CovOption object is included under the Base Coverage for WMD‰‰Š/*Yes*/(1 + 'COV CovOption COI Rate'('CalcType SolveCriteria'(vectorSearchCriteria);0;'Std CovOption Index'('CalcType SolveCriteria'(vectorSearchCriteria);0;'OptType WMD');yearIndex)) ; Š   /*No*/ 1Š) / ('NAAR Discount Factor'('CalcType SolveCriteria'(vectorSearchCriteria)) * 'Solve Choose R Factor'(vectorSearchCriteria;yearIndex;vectorSolveParms;corridorInd))
F1 3f184711 53b81d8c 0 0 0 0 2
Solve DB Option 3 Payment Adj Factor Monthly(nextEOYCV; vectorSearchCriteria; yearIndex; monthIndex; vectorSolveParms; targetLoadInd)
Funktion
IF (monthIndex = 1 ; Š  'Solve DB Option 3 Payment Adj Factor calc'(vectorSearchCriteria;yearIndex;vectorSolveParms;1) ; Š  'Solve DB Option 3 Payment Adj Factor Monthly'(nextEOYCV;vectorSearchCriteria;yearIndex;monthIndex - 1;vectorSolveParms;targetLoadInd) * IF ('Solve Monthly Corridor Indicator'('CalcType SolveCriteria'(vectorSearchCriteria);'Solve Monthly Discounted Cash Value'(nextEOYCV;vectorSearchCriteria;yearIndex;monthIndex;vectorSolveParms;targetLoadInd);yearIndex;vectorSolveParms) ; Š    'Solve DB Option 3 Payment Adj Factor calc'(vectorSearchCriteria;yearIndex;vectorSolveParms;1) ; Š    'Solve DB Option 3 Payment Adj Factor calc'(vectorSearchCriteria;yearIndex;vectorSolveParms;0)Š  )Š)
F1 333349ae 2651908 430015b4 6acb85de 0 0 2
Solve Choose Exp Rider Adj Factor(vectorSearchCriteria; yearIndex; vectorSolveParms; corridorInd)
Funktion
IF (e_(corridorInd;0) = 1 && e_(corridorInd;1) = 1 ; Š  'Solve Corridor Exp Rider Adj Factor'(vectorSearchCriteria;yearIndex;vectorSolveParms;corridorInd) ; Š  'Solve Exp Rider Adj Factor new'(vectorSearchCriteria;yearIndex;vectorSolveParms;corridorInd)Š)
F1 430015b4 333349ae 0 54d69611 0 0 2
Solve Corridor Exp Rider Adj Factor(vectorSearchCriteria; yearIndex; vectorSolveParms; corridorInd)
Funktion
'GEN Future Value Factor'('Solve Criteria Interest Rate'(vectorSearchCriteria;yearIndex);(1 / 12)) * 'Solve Corridor R Factor'(vectorSearchCriteria;yearIndex;vectorSolveParms)
F1 54d69611 333349ae 0 0 0 0 2
Solve Exp Rider Adj Factor new(vectorSearchCriteria; yearIndex; vectorSolveParms; corridorInd)
Funktion
IF ( /*waiver exists and is active*/ 'Std CovOption Index'('CalcType SolveCriteria'(vectorSearchCriteria);0;'OptType WMD') >= 0 && 'COV CovOption Is Included'('CalcType SolveCriteria'(vectorSearchCriteria);0;'Std CovOption Index'('CalcType SolveCriteria'(vectorSearchCriteria);0;'OptType WMD');yearIndex;1;vectorSolveParms) ; Š   // A CovOption object is included under the Base Coverage for WMD‰‰Š/*Yes*/IF ( /*Is death benefit option 1 or option 3?*/ 'DeathBenefitOptType Is Level'('Solve DthBenOpt'('CalcType SolveCriteria'(vectorSearchCriteria);yearIndex;vectorSolveParms)) || 'DeathBenefitOptType Is IncreasingROP'('Solve DthBenOpt'('CalcType SolveCriteria'(vectorSearchCriteria);yearIndex;vectorSolveParms)) ; Š     /*Yes*/ ('GEN Future Value Factor'('Solve Criteria Interest Rate'(vectorSearchCriteria;yearIndex);(1 / 12)) * (1 + 'COV COI Rate'('CalcType SolveCriteria'(vectorSearchCriteria);0;yearIndex;vectorSolveParms) * 0.001 * e_(corridorInd;0)) * (1 + 'COV CovOption COI Rate'('CalcType SolveCriteria'(vectorSearchCriteria);0;'Std CovOption Index'('CalcType SolveCriteria'(vectorSearchCriteria);0;'OptType WMD');yearIndex))) * 'Solve Choose R Factor'(vectorSearchCriteria;yearIndex;vectorSolveParms;corridorInd) ; Š     /*No*/ ('GEN Future Value Factor'('Solve Criteria Interest Rate'(vectorSearchCriteria;yearIndex);(1 / 12)) * (1 + 'COV COI Rate'('CalcType SolveCriteria'(vectorSearchCriteria);0;yearIndex;vectorSolveParms) * 0.001 * e_(corridorInd;0)) * (1 + 'COV CovOption COI Rate'('CalcType SolveCriteria'(vectorSearchCriteria);0;'Std CovOption Index'('CalcType SolveCriteria'(vectorSearchCriteria);0;'OptType WMD');yearIndex)) - 'COV COI Rate'('CalcType SolveCriteria'(vectorSearchCriteria);0;yearIndex;vectorSolveParms) * 0.001 * e_(corridorInd;0) * (1 + 'COV CovOption COI Rate'('CalcType SolveCriteria'(vectorSearchCriteria);0;'Std CovOption Index'('CalcType SolveCriteria'(vectorSearchCriteria);0;'OptType WMD');yearIndex)) * 'GEN Future Value Factor'('Solve Criteria Interest Rate'(vectorSearchCriteria;yearIndex);(1 / 12)) / 'NAAR Discount Factor'('CalcType SolveCriteria'(vectorSearchCriteria))) * 'Solve Choose R Factor'(vectorSearchCriteria;yearIndex;vectorSolveParms;corridorInd)Š  ) ; Š /*No*/ 1Š)
F1 6acb85de 2651908 62a00985 0 0 0 2
Solve Choose R Factor(vectorSearchCriteria; yearIndex; vectorSolveParms; corridorInd)
Funktion
IF (e_(corridorInd;0) = 1 && e_(corridorInd;1) = 1 ; Š  'Solve Corridor R Factor'(vectorSearchCriteria;yearIndex;vectorSolveParms) ; Š  'Solve R Factor New'(vectorSearchCriteria;yearIndex;vectorSolveParms;corridorInd)Š)
F1 62a00985 6acb85de 0 8963a86 0 0 2
Solve R Factor New(vectorSearchCriteria; yearIndex; vectorSolveParms; corridorInd)
Funktion
1 / IF ( /*waiver exists and is inforce*/ 'Std CovOption Index'('CalcType SolveCriteria'(vectorSearchCriteria);0;'OptType WMD') >= 0 && 'COV CovOption Is Included'('CalcType SolveCriteria'(vectorSearchCriteria);0;'Std CovOption Index'('CalcType SolveCriteria'(vectorSearchCriteria);0;'OptType WMD');yearIndex;1;vectorSolveParms) ; Š   // A CovOption object is included under the Base Coverage for WMD‰‰Š/*Yes*/(1 + ('GEN Future Value Factor'('Solve Criteria Interest Rate'(vectorSearchCriteria;yearIndex);(1 / 12)) - 1) + 'COV COI Rate'('CalcType SolveCriteria'(vectorSearchCriteria);0;yearIndex;vectorSolveParms) * 0.001 * e_(corridorInd;0) * ('GEN Future Value Factor'('Solve Criteria Interest Rate'(vectorSearchCriteria;yearIndex);(1 / 12)) - 1) * (1 + 'COV CovOption COI Rate'('CalcType SolveCriteria'(vectorSearchCriteria);0;'Std CovOption Index'('CalcType SolveCriteria'(vectorSearchCriteria);0;'OptType WMD');yearIndex)) + IF ( /*Is death benefit option 1 or option 3?*/ 'DeathBenefitOptType Is Level'('Solve DthBenOpt'('CalcType SolveCriteria'(vectorSearchCriteria);yearIndex;vectorSolveParms)) || 'DeathBenefitOptType Is IncreasingROP'('Solve DthBenOpt'('CalcType SolveCriteria'(vectorSearchCriteria);yearIndex;vectorSolveParms)) ; Š     /*Yes*/ ((1 + 'COV CovOption COI Rate'('CalcType SolveCriteria'(vectorSearchCriteria);0;'Std CovOption Index'('CalcType SolveCriteria'(vectorSearchCriteria);0;'OptType WMD');yearIndex)) * 'COV COI Rate'('CalcType SolveCriteria'(vectorSearchCriteria);0;yearIndex;vectorSolveParms) * 0.001 * e_(corridorInd;0)) ; Š     /*No*/ 'COV COI Rate'('CalcType SolveCriteria'(vectorSearchCriteria);0;yearIndex;vectorSolveParms) * 0.001 * e_(corridorInd;0) * (1 + 'COV CovOption COI Rate'('CalcType SolveCriteria'(vectorSearchCriteria);0;'Std CovOption Index'('CalcType SolveCriteria'(vectorSearchCriteria);0;'OptType WMD');yearIndex)) - 'COV COI Rate'('CalcType SolveCriteria'(vectorSearchCriteria);0;yearIndex;vectorSolveParms) * 0.001 * e_(corridorInd;0) * (1 + 'COV CovOption COI Rate'('CalcType SolveCriteria'(vectorSearchCriteria);0;'Std CovOption Index'('CalcType SolveCriteria'(vectorSearchCriteria);0;'OptType WMD');yearIndex)) * 'GEN Future Value Factor'('Solve Criteria Interest Rate'(vectorSearchCriteria;yearIndex);(1 / 12)) / 'NAAR Discount Factor'('CalcType SolveCriteria'(vectorSearchCriteria))Š  )) ; Š /*No*/ 'GEN Future Value Factor'('Solve Criteria Interest Rate'(vectorSearchCriteria;yearIndex);(1 / 12)) * (1 + 'COV COI Rate'('CalcType SolveCriteria'(vectorSearchCriteria); //0; ŠIF (V_LENGTH(corridorInd) >= 3 ; Š  E_(corridorInd;2) ; Š  0Š);yearIndex;vectorSolveParms) * 0.001 * e_(corridorInd;0)) - IF ('DeathBenefitOptType Is Increasing'('Solve DthBenOpt'('CalcType SolveCriteria'(vectorSearchCriteria);yearIndex;vectorSolveParms)) ; Š(('GEN Future Value Factor'('Solve Criteria Interest Rate'(vectorSearchCriteria;yearIndex);(1 / 12))) * 'COV COI Rate'('CalcType SolveCriteria'(vectorSearchCriteria); //0; ŠIF (V_LENGTH(corridorInd) >= 3 ; Š  E_(corridorInd;2) ; Š  0Š);yearIndex;vectorSolveParms) * 0.001 * e_(corridorInd;0)) / 'NAAR Discount Factor'('CalcType SolveCriteria'(vectorSearchCriteria)) ; Š0Š)Š)
F1 8963a86 6acb85de 0 1affb042 0 0 2
Solve Corridor R Factor(vectorSearchCriteria; yearIndex; vectorSolveParms)
Funktion
1 / ('GEN Future Value Factor'('Solve Criteria Interest Rate'(vectorSearchCriteria;yearIndex);(1 / 12)) * (1 + 'COV COI Rate'('CalcType SolveCriteria'(vectorSearchCriteria);0;yearIndex;vectorSolveParms) * 0.001 - (('NAAR Corridor Factor'('CalcType SolveCriteria'(vectorSearchCriteria);yearIndex) * 'COV COI Rate'('CalcType SolveCriteria'(vectorSearchCriteria);0;yearIndex;vectorSolveParms) * 0.001) / 'NAAR Discount Factor'('CalcType SolveCriteria'(vectorSearchCriteria)))))
F1 1affb042 6acb85de 0 5ab1f9fd 0 0 2
Solve Waiver Exists and Is Inforce(vectorSearchCriteria; yearIndex; vectorSolveParms)
Funktion
'Std CovOption Index'('CalcType SolveCriteria'(vectorSearchCriteria);0;'OptType WMD') >= 0 && 'COV CovOption Is Included'('CalcType SolveCriteria'(vectorSearchCriteria);0;'Std CovOption Index'('CalcType SolveCriteria'(vectorSearchCriteria);0;'OptType WMD');yearIndex;1;vectorSolveParms)
F1 5ab1f9fd 6acb85de 0 66c31642 0 0 2
Solve Waiver Exists and Is Inforce for Interest Rate(vectorSearchCriteria; yearIndex; vectorSolveParms)
Funktion
'Std CovOption Index'('CalcType SolveCriteria'(vectorSearchCriteria);0;'OptType WMD') >= 0 && 'COV CovOption Is Included'('Solve Criteria Interest Rate'(vectorSearchCriteria;yearIndex);0;'Std CovOption Index'('CalcType SolveCriteria'(vectorSearchCriteria);0;'OptType WMD');yearIndex;1;vectorSolveParms)
F1 66c31642 6acb85de 6375adf3 0 0 0 2
Solve COI Cov for R Factor(vectorSearchCriteria; yearIndex; vectorSolveParms; corridorInd)
Funktion
'Solve Last NAR Cov Check Rec'('CalcType SolveCriteria'(vectorSearchCriteria);'Solve COI Cov for R Factor Rec'('CalcType SolveCriteria'(vectorSearchCriteria);'Solve End Of Year Cash Value Rec'('CalcType SolveCriteria'(vectorSearchCriteria);vectorSolveParms;'Solve Criteria Interest Rate'(vectorSearchCriteria;yearIndex);yearIndex - 1;12;vectorSearchCriteria);0;vectorSolveParms;yearIndex;vectorSearchCriteria;corridorInd))
F1 6375adf3 66c31642 0 77b46792 0 0 2
Solve COI Cov for R Factor Rec(calcType; remEOYCV; coverageIndex; vectorSolveParms; yearIndex; vectorSearchCriteria; corridorInd)
Funktion
IF (coverageIndex >= 'Policy Number Of Coverage'(calcType;yearIndex) - 1 || remEOYCV < 'Solve Cov NAR Death Benefit'(calcType;coverageIndex;vectorSolveParms;yearIndex;vectorSearchCriteria) ; Š  coverageIndex ; Š  'Solve COI Cov for R Factor Rec'(calcType;remEOYCV - 'Solve Cov NAR Death Benefit'(calcType;coverageIndex;vectorSolveParms;yearIndex;vectorSearchCriteria);coverageIndex + 1;vectorSolveParms;yearIndex;vectorSearchCriteria;corridorInd)Š)
F1 77b46792 66c31642 0 3192babe 0 0 2
Solve Last NAR Cov Check Rec(calcType; coverageIndex)
Funktion
IF (coverageIndex = 0 || 'Coverage Is NAR Cost'(calcType;coverageIndex) ; Š  coverageIndex ; Š  'Solve Last NAR Cov Check Rec'(calcType;coverageIndex - 1)Š)
F1 3192babe 66c31642 0 73fafef 0 0 2
Solve Cov NAR Death Benefit(calcType; coverageIndex; vectorSolveParms; yearIndex; vectorSearchCriteria)
Funktion
(IF ('Coverage Is NAR Cost'(calcType;coverageIndex) ; Š   /*Yes*/ 'SharedVector SolveParms FaceAmount'(coverageIndex;vectorSolveParms;yearIndex) ; Š   /*No*/ 0Š) + IF (coverageIndex = 'Std BaseCov Index'(calcType) && 'DeathBenefitOptType Is IncreasingROP'('Solve DthBenOpt'('CalcType SolveCriteria'(vectorSearchCriteria);yearIndex;vectorSolveParms)) ; Š'Solve Cumulative Premium'(yearIndex;vectorSolveParms;vectorSearchCriteria) ; Š0Š)) / 'NAAR Discount Factor'('CalcType SolveCriteria'(vectorSearchCriteria))
F1 73fafef 66c31642 5035a592 0 0 0 2
Solve COI Cov for R Factor Change(vectorSearchCriteria; prevEOYCV; yearIndex; vectorSolveParms; corridorInd)
Funktion
yearIndex > 1 && 'Solve COI Cov for R Factor BOY'(vectorSearchCriteria;prevEOYCV;yearIndex;vectorSolveParms;corridorInd) <> 'Solve COI Cov for R Factor EOY'(vectorSearchCriteria;prevEOYCV;yearIndex;vectorSolveParms;corridorInd) && 'Policy Coverage IndicatorCode'('CalcType SolveCriteria'(vectorSearchCriteria);'Solve COI Cov for R Factor BOY'(vectorSearchCriteria;prevEOYCV;yearIndex;vectorSolveParms;corridorInd)) <> 'Policy Coverage IndicatorCode'('CalcType SolveCriteria'(vectorSearchCriteria);'Solve COI Cov for R Factor EOY'(vectorSearchCriteria;prevEOYCV;yearIndex;vectorSolveParms;corridorInd)) && NOT(('IndicatorCode is Base'('Policy Coverage IndicatorCode'('CalcType SolveCriteria'(vectorSearchCriteria);'Solve COI Cov for R Factor BOY'(vectorSearchCriteria;prevEOYCV;yearIndex;vectorSolveParms;corridorInd))) || 'IndicatorCode is BaseIncrease'('Policy Coverage IndicatorCode'('CalcType SolveCriteria'(vectorSearchCriteria);'Solve COI Cov for R Factor BOY'(vectorSearchCriteria;prevEOYCV;yearIndex;vectorSolveParms;corridorInd)))) && ('IndicatorCode is Base'('Policy Coverage IndicatorCode'('CalcType SolveCriteria'(vectorSearchCriteria);'Solve COI Cov for R Factor EOY'(vectorSearchCriteria;prevEOYCV;yearIndex;vectorSolveParms;corridorInd))) || 'IndicatorCode is BaseIncrease'('Policy Coverage IndicatorCode'('CalcType SolveCriteria'(vectorSearchCriteria);'Solve COI Cov for R Factor EOY'(vectorSearchCriteria;prevEOYCV;yearIndex;vectorSolveParms;corridorInd)))))
F1 5035a592 73fafef 0 31f01d83 0 0 2
Solve COI Cov for R Factor BOY(vectorSearchCriteria; prevEOYCV;  yearIndex; vectorSolveParms; corridorInd)
Funktion
'Solve Last NAR Cov Check Rec'('CalcType SolveCriteria'(vectorSearchCriteria);'Solve COI Cov for R Factor Rec'('CalcType SolveCriteria'(vectorSearchCriteria);prevEOYCV / 'NAAR Discount Factor'('CalcType SolveCriteria'(vectorSearchCriteria)) - SUMX(covIndex;0;'Policy Number Of Coverage'('CalcType SolveCriteria'(vectorSearchCriteria);yearIndex) - 1;IF ('Coverage Is NAR Cost'('CalcType SolveCriteria'(vectorSearchCriteria);#covIndex) ; Š  ((('SharedVector SolveParms FaceAmount'(#covIndex;vectorSolveParms;yearIndex) + IF ('DeathBenefitOptType Is IncreasingROP'('Solve DthBenOpt'('CalcType SolveCriteria'(vectorSearchCriteria);yearIndex;vectorSolveParms)) ; Š    'Solve Cumulative Premium'(yearIndex;vectorSolveParms;vectorSearchCriteria) ; Š    0Š  ))) * 'COV COI Rate'('CalcType SolveCriteria'(vectorSearchCriteria);#covIndex;yearIndex;vectorSolveParms) * 0.001) ; Š0Š));0;vectorSolveParms;yearIndex;vectorSearchCriteria;corridorInd))
F1 31f01d83 73fafef 0 0 0 0 2
Solve COI Cov for R Factor EOY(vectorSearchCriteria; prevEOYCV; yearIndex; vectorSolveParms; corridorInd)
Funktion
'Solve Last NAR Cov Check Rec'('CalcType SolveCriteria'(vectorSearchCriteria);'Solve COI Cov for R Factor Rec'('CalcType SolveCriteria'(vectorSearchCriteria);'Solve Annual Cash Value'(prevEOYCV;vectorSolveParms;yearIndex;vectorSearchCriteria;corridorInd);0;vectorSolveParms;yearIndex;vectorSearchCriteria;corridorInd))
F1 2652ef8 24e83b0 69ade4d0 3bf31162 0 0 2
-- Initial Specified Amount Guess Functions --
Funktion

F1 69ade4d0 2652ef8 3d48f873 0 0 0 2
Solve Initial Specified Amount Guess(vectorSolveParms; vectorSearchCriteria)
Funktion
('SharedVector SolveParms Premium'(vectorSolveParms;1) * 'Solve Init Guess Annualize PV Payment Factor'(vectorSearchCriteria;vectorSolveParms) - 'Solve Init Guess Annualize PV Charges Less PerUnit'(vectorSolveParms;vectorSearchCriteria) - IF ( /*Solve for endowment*/ 'Solve Criteria Target CV'(vectorSearchCriteria) = 999999999 ; Š   /*No*/ 0 ; Š   /*Yes*/ 'Solve Init Guess Target CV Amount'(vectorSearchCriteria;vectorSolveParms)Š)) / 'Solve Init Guess SpecAmt Discount'(vectorSolveParms;vectorSearchCriteria)
F1 3d48f873 69ade4d0 3666db69 5174835 0 0 2
Solve Init Guess Annualize PV Charges Less PerUnit(vectorSolveParms; vectorSearchCriteria)
Funktion
SUMX(yearIndex;'Solve Start Year'(vectorSearchCriteria);'Solve Criteria Target Duration'(vectorSearchCriteria);'Solve Init Guess Annualize PV Yearly Charge less PerUnit'(vectorSolveParms;vectorSearchCriteria;#yearIndex)) + 1 / 'Solve Init Guess Target CV Amount'(vectorSearchCriteria;vectorSolveParms)
F1 3666db69 3d48f873 d1225c5 0 0 0 2
Solve Init Guess Annualize PV Yearly Charge less PerUnit(vectorSolveParms; vectorSearchCriteria; yearIndex)
Funktion
 // Present value of charges at the beginning of the yearŠ(('Solve Init Guess Total Charges Less PerUnit'(vectorSolveParms;vectorSearchCriteria;yearIndex) * IF ( /*If R-factor is 1*/ 'Solve R Factor'(vectorSearchCriteria;yearIndex;vectorSolveParms) = 1 ; Š   /*Multiply by 12*/ 12 ; Š   /*Else compound R factor by 12*/ 'Solve Compound R Factor by 12'(vectorSearchCriteria;yearIndex;vectorSolveParms)Š) +  // add flat amount premium load chargeŠ'Solve Flat Amount Premium Load Charge'(vectorSearchCriteria;yearIndex)) +  // add premium load up to load target if applicableŠ'Solve Premium Load Up To Load Target'(vectorSearchCriteria;yearIndex)) * 'Solve Annualize Product R Factor'(vectorSearchCriteria;yearIndex;vectorSolveParms) // Discount from beginning of year back to issue date   Š
F1 d1225c5 3666db69 0 14b1342b 0 0 2
Solve Compound R Factor by 12(vectorSearchCriteria; yearIndex; vectorSolveParms)
Funktion
(1 - ('Solve R Factor'(vectorSearchCriteria;yearIndex;vectorSolveParms) ^ 12)) / (1 - 'Solve R Factor'(vectorSearchCriteria;yearIndex;vectorSolveParms))
F1 14b1342b 3666db69 0 30d565f8 0 0 2
Solve Flat Amount Premium Load Charge(vectorSearchCriteria; yearIndex)
Funktion
IF ( /*If premium load is flat amount*/ 'PI PolicyProduct Fee ChargeBasedOn'('Policy ProductCode';'FeeType PremiumLoad';TransEffDate) EQUAL "1000500030" && 'CHG Calc Type Uses Fees'('CalcType SolveCriteria'(vectorSearchCriteria)) && yearIndex <= MIN('Solve Criteria Premium Duration'(vectorSearchCriteria) + ('Solve Start Year'(vectorSearchCriteria) - 1);'Solve Criteria Target Duration'(vectorSearchCriteria)) ; Š   // flat amount premium chargeŠ'PLC Projected Total Premium Load Charge'('CalcType SolveCriteria'(vectorSearchCriteria);'FeeType PremiumLoad';yearIndex;100; // periodic premium not required for flat amount ‰Š'GEN Vector Blank'; // target premium vector not requiredŠ0 // assumes premiums paid annually in advanceŠ) ; Š   /*Else don't add in premium load now‰*/ 0Š)
F1 30d565f8 3666db69 0 22a047b1 0 0 2
Solve Premium Load Up To Load Target(vectorSearchCriteria; yearIndex)
Funktion
IF ( /*Load target calculation or Beyond Premium Duration?*/ 'CalcType SolveCriteria Alike LTGT'(vectorSearchCriteria) || yearIndex > MIN('Solve Criteria Premium Duration'(vectorSearchCriteria) + ('Solve Start Year'(vectorSearchCriteria) - 1);'Solve Criteria Target Duration'(vectorSearchCriteria)) ; Š   /*Yes*/ 0 ; Š   /*No*/ IF ( /*Premium load based on Load Target and Loads used in calctype?*/ ('PI PolicyProduct Fee ChargeBasedOn'('Policy ProductCode';'FeeType PremiumLoad';TransEffDate) = "1000500005" || 'PI PolicyProduct Fee ChargeBasedOn'('Policy ProductCode';'FeeType PremiumLoad';TransEffDate) = "1000500007") && 'CHG Calc Type Uses Fees'('CalcType SolveCriteria'(vectorSearchCriteria)) ; Š     /*Yes*/ 'SLV LoadTargetPremium'(vectorSearchCriteria) * ('PLC Premium Load Primary Rate'('CalcType SolveCriteria'(vectorSearchCriteria);'FeeType PremiumLoad';0;yearIndex) * 0.01 - 'PLC Premium Load Secondary Rate'('CalcType SolveCriteria'(vectorSearchCriteria);'FeeType PremiumLoad';0;yearIndex) * 0.01) ; Š     /*No*/ 0Š  )Š)
F1 22a047b1 3666db69 30fbabbd 0 0 0 2
Solve Init Guess Total Charges Less PerUnit(vectorSolveParms; vectorSearchCriteria; yearIndex)
Funktion
 // Expense chargesŠ(IF ( /*Does calc type use fees?*/ 'CHG Calc Type Uses Fees'('CalcType SolveCriteria'(vectorSearchCriteria)) ; Š   /*Yes - add expenses*/ 'Solve Init Guess Monthly Expenses Less PerUnit'('CalcType SolveCriteria'(vectorSearchCriteria);yearIndex;vectorSolveParms) * 'Solve Non COI Timing Adjustment'(vectorSearchCriteria;yearIndex;vectorSolveParms) ; Š   /*No - exclude expenses*/ 0Š) // Benefit charges associated with the base coverageŠ + 'COV Projected Monthly Total CovOption Charge'('CalcType SolveCriteria'(vectorSearchCriteria);'Std BaseCov Index'('CalcType SolveCriteria'(vectorSearchCriteria));yearIndex;1;vectorSolveParms) // Rider charges not associated with NARŠ + 'Solve Init Guess Monthly NonNAR Coverage Charge'('CalcType SolveCriteria'(vectorSearchCriteria);yearIndex;vectorSolveParms) * 'Solve Non COI Timing Adjustment'(vectorSearchCriteria;yearIndex;vectorSolveParms)) * 'Solve Exp Rider Adj Factor'(vectorSearchCriteria;yearIndex;vectorSolveParms)
F1 30fbabbd 22a047b1 790d5361 0 0 0 2
Solve Init Guess Monthly Expenses Less PerUnit(calcType; yearIndex; vectorSolveParms)
Funktion
IF ( /*Does calctype use fees?*/ 'CHG Calc Type Uses Fees'(calcType) ; Š   /*Yes - include admin fees*/ IF ('CalcType Shadow Is Active'(calcType) ; Š    'Solve Init Guess Shadow Monthly Expenses Less PerUnitCalc'(calcType;'FeeType AdminFee';0;yearIndex;1;vectorSolveParms) + 'Solve Init Guess Shadow Monthly Expenses Less PerUnitCalc'(calcType;'FeeType Expense';0;yearIndex;1;vectorSolveParms) ; Š    'Solve Init Guess Monthly Expenses Less PerUnitCalc'('FeeType AdminFee';calcType;0;yearIndex;1;vectorSolveParms) + 'Solve Init Guess Monthly Expenses Less PerUnitCalc'('FeeType Expense';calcType;0;yearIndex;1;vectorSolveParms)Š  ) ; Š // Expense not included in 7 pay calculationsŠ0Š)
F1 790d5361 30fbabbd 0 32f032c8 0 0 2
Solve Init Guess Monthly Expenses Less PerUnitCalc(calcType; fee_type; cashValue; yearIndex; monthIndex; vectorSolveParms)
Funktion
CASE( /*Admin fee rule*/ 'PI PolicyProduct Fee ChargeBasedOn'('Policy ProductCode';fee_type;'Policy EffDate');Š   /*Charge per unit*/ "9";"1000500025";"1000500026" : 0;Š   : 'AC Projected Monthly AdminFee Charge'(calcType;1;'PI PolicyProduct Fee ChargeBasedOn'('Policy ProductCode';fee_type;'Policy EffDate');fee_type;cashValue;yearIndex;monthIndex;vectorSolveParms))Š + CASE( /*Admin fee rule*/ 'PI PolicyProduct Fee SecondaryChargeBasedOn'('Policy ProductCode';fee_type;'Policy EffDate');Š   /*Charge per unit*/ "9";"1000500025";"1000500026" : 0;Š   : 'AC Projected Monthly AdminFee Charge'(calcType;2;'PI PolicyProduct Fee SecondaryChargeBasedOn'('Policy ProductCode';fee_type;'Policy EffDate');fee_type;cashValue;yearIndex;monthIndex;vectorSolveParms))Š + CASE( /*Admin fee rule*/ 'PI PolicyProduct Fee TertiaryChargeBasedOn'('Policy ProductCode';fee_type;'Policy EffDate');Š   /*Charge per unit*/ "9";"1000500025";"1000500026" : 0;Š   : 'AC Projected Monthly AdminFee Charge'(calcType;3;'PI PolicyProduct Fee TertiaryChargeBasedOn'('Policy ProductCode';fee_type;'Policy EffDate');fee_type;cashValue;yearIndex;monthIndex;vectorSolveParms))Š
F1 32f032c8 30fbabbd 0 0 0 0 2
Solve Init Guess Shadow Monthly Expenses Less PerUnitCalc(calcType; fee_type; cashValue; yearIndex; monthIndex; vectorSolveParms)
Funktion
CASE( /*Admin fee rule*/ 'PI CovOptionProduct Fee ChargeBasedOn'(calcType;'Policy ProductCode';'STD Shadow coverageIndex'(calcType);'STD Shadow coverageOptionIndex'(calcType);fee_type;'Policy EffDate');Š   /*Charge per unit*/ "9";"1000500025";"1000500026" : 0;Š   : 'AC Projected Monthly AdminFee Charge'(calcType;1;'PI CovOptionProduct Fee ChargeBasedOn'(calcType;'Policy ProductCode';'STD Shadow coverageIndex'(calcType);'STD Shadow coverageOptionIndex'(calcType);fee_type;'Policy EffDate');fee_type;cashValue;yearIndex;monthIndex;vectorSolveParms))Š + CASE( /*Admin fee rule*/ 'PI CovOptionProduct Fee SecondaryChargeBasedOn'(calcType;'Policy ProductCode';'STD Shadow coverageIndex'(calcType);'STD Shadow coverageOptionIndex'(calcType);fee_type;'Policy EffDate');Š   /*Charge per unit*/ "9";"1000500025";"1000500026" : 0;Š   : 'AC Projected Monthly AdminFee Charge'(calcType;2;'PI CovOptionProduct Fee SecondaryChargeBasedOn'(calcType;'Policy ProductCode';'STD Shadow coverageIndex'(calcType);'STD Shadow coverageOptionIndex'(calcType);fee_type;'Policy EffDate');fee_type;cashValue;yearIndex;monthIndex;vectorSolveParms))Š + CASE( /*Admin fee rule*/ 'PI CovOptionProduct Fee TertiaryChargeBasedOn'(calcType;'Policy ProductCode';'STD Shadow coverageIndex'(calcType);'STD Shadow coverageOptionIndex'(calcType);fee_type;'Policy EffDate');Š   /*Charge per unit*/ "9";"1000500025";"1000500026" : 0;Š   : 'AC Projected Monthly AdminFee Charge'(calcType;3;'PI CovOptionProduct Fee TertiaryChargeBasedOn'(calcType;'Policy ProductCode';'STD Shadow coverageIndex'(calcType);'STD Shadow coverageOptionIndex'(calcType);fee_type;'Policy EffDate');fee_type;cashValue;yearIndex;monthIndex;vectorSolveParms))Š
F1 5174835 69ade4d0 a58940 ad5a770 0 0 2
Solve Init Guess SpecAmt Discount(vectorSolveParms; vectorSearchCriteria)
Funktion
SUMX(yearIndex;'Solve Start Year'(vectorSearchCriteria);'Solve Criteria Target Duration'(vectorSearchCriteria);'Solve Init Guess PV SpecAmt Charges'(vectorSolveParms;vectorSearchCriteria;#yearIndex)) + 'Solve Annualize Product R Factor'(vectorSearchCriteria;'Solve Criteria Target Duration'(vectorSearchCriteria);vectorSolveParms) * ('Solve R Factor'(vectorSearchCriteria;'Solve Criteria Target Duration'(vectorSearchCriteria);vectorSolveParms) ^ 12)
F1 a58940 5174835 7557f2c1 0 0 0 2
Solve Init Guess PV SpecAmt Charges(vectorSolveParms; vectorSearchCriteria; yearIndex)
Funktion
'Solve Init Guess Total SpecAmt Charges'(vectorSolveParms;vectorSearchCriteria;yearIndex) * IF ( /*If R-factor is 1*/ 'Solve R Factor'(vectorSearchCriteria;yearIndex;vectorSolveParms) = 1 ; Š   /*Multiply by 12*/ 12 ; Š   /*Else compound R factor by 12*/ (1 - ('Solve R Factor'(vectorSearchCriteria;yearIndex;vectorSolveParms) ^ 12)) / (1 - 'Solve R Factor'(vectorSearchCriteria;yearIndex;vectorSolveParms))Š) * 'Solve Annualize Product R Factor'(vectorSearchCriteria;yearIndex;vectorSolveParms)
F1 7557f2c1 a58940 4415c497 0 0 0 2
Solve Init Guess Total SpecAmt Charges(vectorSolveParms; vectorSearchCriteria; yearIndex)
Funktion
'Solve Init Guess COI Charges Per Dollar'(vectorSolveParms;vectorSearchCriteria;yearIndex) * 'Solve DB Adj Factor'(vectorSearchCriteria;yearIndex;vectorSolveParms) + 'Solve Init Guess Monthly Expenses PerUnitOnly'('CalcType SolveCriteria'(vectorSearchCriteria);yearIndex;vectorSolveParms;vectorSearchCriteria)
F1 4415c497 7557f2c1 8129194 4e13f05c 0 0 2
Solve Init Guess Monthly Expenses PerUnitOnly(calcType; yearIndex; vectorSolveParms; vectorSearchCriteria)
Funktion
IF ( /*Does calctype use fees?*/ 'CHG Calc Type Uses Fees'(calcType) ; Š   /*Yes - include admin fees*/ 'Solve Init Guess Monthly Expenses PerUnitOnly Calc'('FeeType AdminFee';calcType;0;yearIndex;1;vectorSolveParms;vectorSearchCriteria) + 'Solve Init Guess Monthly Expenses PerUnitOnly Calc'('FeeType Expense';calcType;0;yearIndex;1;vectorSolveParms;vectorSearchCriteria) ; Š   // Expense not included in 7 pay calculationsŠ0Š)
F1 8129194 4415c497 0 0 0 0 2
Solve Init Guess Monthly Expenses PerUnitOnly Calc(fee_type; calcType; cashValue; yearIndex; monthIndex; vectorSolveParms; vectorSearchCriteria)
Funktion
CASE( /*Admin fee rule*/ 'PI PolicyProduct Fee ChargeBasedOn'('Policy ProductCode';fee_type;'Policy EffDate');Š   /*Charge per unit*/ "9";"1000500025";"1000500026" : 'AC Projected Monthly AdminFee Charge'(calcType;1;'PI PolicyProduct Fee ChargeBasedOn'('Policy ProductCode';fee_type;'Policy EffDate');fee_type;cashValue;yearIndex;monthIndex;'SharedVector SolveParms ReplaceFaceAmount'(calcType;1;vectorSolveParms));Š   : 0)Š + CASE( /*Admin fee rule*/ 'PI PolicyProduct Fee SecondaryChargeBasedOn'('Policy ProductCode';fee_type;'Policy EffDate');Š   /*Charge per unit*/ "9";"1000500025";"1000500026" : 'AC Projected Monthly AdminFee Charge'(calcType;2;'PI PolicyProduct Fee SecondaryChargeBasedOn'('Policy ProductCode';fee_type;'Policy EffDate');fee_type;cashValue;yearIndex;monthIndex;'SharedVector SolveParms ReplaceFaceAmount'(calcType;1;vectorSolveParms));Š   : 0)Š + CASE( /*Admin fee rule*/ 'PI PolicyProduct Fee TertiaryChargeBasedOn'('Policy ProductCode';fee_type;'Policy EffDate');Š   /*Charge per unit*/ "9";"1000500025";"1000500026" : 'AC Projected Monthly AdminFee Charge'(calcType;3;'PI PolicyProduct Fee TertiaryChargeBasedOn'('Policy ProductCode';fee_type;'Policy EffDate');fee_type;cashValue;yearIndex;monthIndex;'SharedVector SolveParms ReplaceFaceAmount'(calcType;1;vectorSolveParms));Š   : 0)Š
F1 4e13f05c 7557f2c1 0 0 0 0 2
Solve Init Guess COI Charges Per Dollar(vectorSolveParms; vectorSearchCriteria; yearIndex)
Funktion
(((1 / 'NAAR Discount Factor'('CalcType SolveCriteria'(vectorSearchCriteria))) * 'COV COI Rate'('CalcType SolveCriteria'(vectorSearchCriteria);0;yearIndex;vectorSolveParms) * 0.001) / (1 + ('COV COI Rate'('CalcType SolveCriteria'(vectorSearchCriteria);0;yearIndex;vectorSolveParms) * 0.001)))
F1 ad5a770 69ade4d0 0 4820810a 0 0 2
Solve Init Guess Target CV Amount(vectorSearchCriteria; vectorSolveParms)
Funktion
IF ( /*Solve for endowment*/ 'Solve Criteria Target CV'(vectorSearchCriteria) = 999999999 ; Š   /*No*/ 'Solve Annualize Product R Factor'(vectorSearchCriteria;'Solve Criteria Target Duration'(vectorSearchCriteria);vectorSolveParms) * ('Solve R Factor'(vectorSearchCriteria;'Solve Criteria Target Duration'(vectorSearchCriteria);vectorSolveParms) ^ 12) ; Š   /*Yes*/ 'Solve Criteria Target CV'(vectorSearchCriteria) * 'Solve Annualize Product R Factor'(vectorSearchCriteria;'Solve Criteria Target Duration'(vectorSearchCriteria);vectorSolveParms) * ('Solve R Factor'(vectorSearchCriteria;'Solve Criteria Target Duration'(vectorSearchCriteria);vectorSolveParms) ^ 12)Š)
F1 4820810a 69ade4d0 3bc6c5cb 0 0 0 2
-- Target Premium Functions --
Funktion

F1 3bc6c5cb 4820810a 0 45b64cdf 0 0 2
Solve Target SumOfCharges Init Guess(vectorSearchCriteria; vectorSolveParms)
Funktion
 // Formula is : Š// FA = (Sum of premiums (grossed up for load) - Sum of fixed expenses & charges) / (sum of per unit expense rates)Š(SUMX(yearIndex;1;'Solve Criteria Premium Duration'(vectorSearchCriteria);'SharedVector SolveParms Premium'(vectorSolveParms;#yearIndex) / 'Solve Net Premium Factor'(vectorSearchCriteria;1;1)) // less fixed expenses and rider charges, and surrender chargeŠ - SUMX(yearIndex;1;'Solve Criteria Premium Duration'(vectorSearchCriteria);'Solve Init Guess Total Charges Less PerUnit'(vectorSolveParms;vectorSearchCriteria;#yearIndex)) - 'ULSC Projected Full Surrender Charge'('CalcType SolveCriteria'(vectorSearchCriteria);'Solve Criteria Premium Duration'(vectorSearchCriteria);'GEN Vector Blank')) / SUMX(yearIndex;1;'Solve Criteria Premium Duration'(vectorSearchCriteria);'Solve Init Guess Total SpecAmt Charges'(vectorSolveParms;vectorSearchCriteria;#yearIndex) * 12)
F1 45b64cdf 4820810a 0 7ec41d87 0 0 2
-- Solve Target RateFile Init Guess(vectorSearchCriteria; vectorSolveParms)
Funktion
// Formula is : Š// FA = (Target premiums - Sum of targets for non-base coverage) / Ratefile rate for base targetŠ Š('SharedVector SolveParms Premium'(vectorSolveParms; 1)Š Š// less target premiums for non-base coverageŠ-ŠSUMX(coverageIndex; 1;'Policy Number of Coverage'('CalcType SolveCriteria'(vectorSearchCriteria); 1) - 1;Š‰'RateFile RateLookup Coverage Target'('CalcType SolveCriteria'(vectorSearchCriteria);#coverageIndex; 1; vectorSolveParms)Š)Š)Š/Š('RateFile RateLookup Coverage Target'('CalcType SolveCriteria'(vectorSearchCriteria); 'Std BaseCov Index'('CalcType SolveCriteria'(vectorSearchCriteria));  1; vectorSolveParms)Š‰/'PI CoverageProduct ValuePerUnit'('CalcType SolveCriteria'(vectorSearchCriteria); 'Policy ProductCode'; 0; 'Policy EffDate'))
F1 7ec41d87 4820810a 0 35703c73 0 0 2
Solve Target RateFile Init Guess(vectorSearchCriteria; vectorSolveParms; yearIndex)
Funktion
 // Formula is : Š// FA = (Target premiums - Sum of targets for non-base coverage) / Ratefile rate for base targetŠ('SharedVector SolveParms Premium'(vectorSolveParms;1) // less target premiums for non-base coverageŠ - SUMX(coverageIndex;1;'Policy Number of Coverage'('CalcType SolveCriteria'(vectorSearchCriteria);1) - 1;'RateFile RateLookup Coverage Target'('CalcType SolveCriteria'(vectorSearchCriteria);#coverageIndex;yearIndex;1;vectorSolveParms))) / ('RateFile RateLookup Coverage Target'('CalcType SolveCriteria'(vectorSearchCriteria);'Std BaseCov Index'('CalcType SolveCriteria'(vectorSearchCriteria));yearIndex;1;vectorSolveParms) / 'PI CoverageProduct ValuePerUnit'('CalcType SolveCriteria'(vectorSearchCriteria);'Policy ProductCode';0;'Policy EffDate'))
F1 35703c73 4820810a 0 1f8b79c4 0 0 2
Solve Target CalcMethod Used(vectorSearchCriteria)
Funktion
IF ( /*Is calculation method defined in product definition?*/ 'ACCS CalcRule Target Calc Method'('CalcType SolveCriteria'(vectorSearchCriteria);'Policy CarrierCode';'Policy ProductCode';'Policy EffDate') ALIKE 'GEN Vector Blank' ; Š   // No target calculation method found - return error messageŠ'Messages SystemMessage'("CA1008";'Message Language';v_('Solve Model Name';"'Solve Target CalcMethod Used'";'Policy ProductCode' & "; " & 'CalcType SolveCriteria'(vectorSearchCriteria))) ; Š   // Else‰return calculation methodŠ'ACCS CalcRule Target Calc Method'('CalcType SolveCriteria'(vectorSearchCriteria);'Policy CarrierCode';'Policy ProductCode';'Policy EffDate')Š)
F1 1f8b79c4 4820810a 4a33a897 521b0fa9 0 0 2
Solve Rider Target Premium(calcType; yearIndex; vectorSolveParms; vectorSearchCriteria)
Funktion
CASE( /*Target calculation method*/ 'Solve Target CalcMethod Used'(vectorSearchCriteria);Š   // Sum of ChargesŠ1 : 'Solve SumOfCharges Rider TargetPremium'(calcType;yearIndex;vectorSolveParms;vectorSearchCriteria);Š   // Rate FileŠ2 : 'Solve RateFile rider TargetPremiumSum'(vectorSolveParms;vectorSearchCriteria);Š   // IterativeŠ3 : 'Messages SystemMessage'("ILL1007";'Message Language';v_('Solve Model Name';"'Solve Target Premium Per Unit'";'CalcType SolveCriteria'(vectorSearchCriteria)));Š   // Present Value Š4 : 'Solve PresentValue Rider TargetPremiumSum'(vectorSolveParms;vectorSearchCriteria);Š   // Else return error messageŠ : 'Messages SystemMessage'("CA1009";'Message Language';v_('Solve Model Name';"'Solve Target Premium Per Unit'";'CalcType SolveCriteria'(vectorSearchCriteria))))Š
F1 4a33a897 1f8b79c4 0 4b2664ca 0 0 2
Solve SumOfCharges Rider TargetPremium(calcType; yearIndex; vectorSolveParms; vectorSearchCriteria)
Funktion
'Solve Init Guess Total Charges Less PerUnit'(vectorSolveParms;vectorSearchCriteria;yearIndex) * ('PLC Premium Load Primary Rate'('CalcType SolveCriteria'(vectorSearchCriteria);'FeeType PremiumLoad';0;yearIndex) * 0.01 - 'PLC Premium Load Secondary Rate'('CalcType SolveCriteria'(vectorSearchCriteria);'FeeType PremiumLoad';0;yearIndex) * 0.01)
F1 4b2664ca 1f8b79c4 0 35922381 0 0 2
Solve PresentValue Rider TargetPremiumSum(vectorSolveParms; vectorSearchCriteria)
Funktion
SUMX(yearIndex;'Solve Start Year'(vectorSearchCriteria);'Solve Criteria Target Duration'(vectorSearchCriteria);SUMX(coverageIndex;0;'Policy Number of Coverage'('CalcType SolveCriteria'(vectorSearchCriteria);#yearIndex) - 1;IF ( /*Base or Base Increase*/ ('IndicatorCode is Base'('Policy Coverage IndicatorCode'('CalcType SolveCriteria'(vectorSearchCriteria);#coverageIndex)) || 'IndicatorCode is BaseIncrease'('Policy Coverage IndicatorCode'('CalcType SolveCriteria'(vectorSearchCriteria);#coverageIndex))) ; Š   /*Yes*/ 0 ; Š   /*No*/ 'Solve PresentValue TargetPremium'(#coverageIndex;#yearIndex;vectorSolveParms;vectorSearchCriteria)Š)))
F1 35922381 1f8b79c4 0 0 0 0 2
Solve RateFile Rider TargetPremiumSum(vectorSolveParms; vectorSearchCriteria)
Funktion
SUMX(yearIndex;'Solve Start Year'(vectorSearchCriteria);'Solve Criteria Target Duration'(vectorSearchCriteria);SUMX(coverageIndex;0;'Policy Number of Coverage'('CalcType SolveCriteria'(vectorSearchCriteria);#yearIndex) - 1;IF ( /*Base or Base Increase*/ ('IndicatorCode is Base'('Policy Coverage IndicatorCode'('CalcType SolveCriteria'(vectorSearchCriteria);#coverageIndex)) || 'IndicatorCode is BaseIncrease'('Policy Coverage IndicatorCode'('CalcType SolveCriteria'(vectorSearchCriteria);#coverageIndex))) ; Š   /*Yes*/ 0 ; Š   /*No*/ 'Solve RateFile TargetPremium'(#coverageIndex;#yearIndex;vectorSolveParms;vectorSearchCriteria)Š)))
F1 521b0fa9 4820810a 2e03613d 0 0 0 2
Solve Base TargetPremium(vectorSolveParms; vectorSearchCriteria)
Funktion
CASE( /*Target calculation method*/ 'Solve Target CalcMethod Used'(vectorSearchCriteria);Š   // Sum of ChargesŠ1 : 'Solve SumOfCharges Base TargetPremium'(vectorSolveParms;vectorSearchCriteria);Š   // Rate FileŠ2 : 'Solve RateFile Base TargetPremiumSum'(vectorSolveParms;vectorSearchCriteria);Š   // IterativeŠ3 : 'Messages SystemMessage'("ILL1007";'Message Language';v_('Solve Model Name';"'Solve Target Premium Per Unit'";'CalcType SolveCriteria'(vectorSearchCriteria)));Š   // Present Value Š4 : 'Solve PresentValue Base TargetPremiumSum'(vectorSolveParms;vectorSearchCriteria);Š   // Else return error messageŠ : 'Messages SystemMessage'("CA1009";'Message Language';v_('Solve Model Name';"'Solve Target Premium Per Unit'";'CalcType SolveCriteria'(vectorSearchCriteria))))Š
F1 2e03613d 521b0fa9 ffe715 217a409e 0 0 2
Solve PresentValue Base TargetPremiumSum(vectorSolveParms; vectorSearchCriteria)
Funktion
SUMX(yearIndex;'Solve Start Year'(vectorSearchCriteria);'Solve Criteria Target Duration'(vectorSearchCriteria);SUMX(coverageIndex;0;'Policy Number of Coverage'('CalcType SolveCriteria'(vectorSearchCriteria);#yearIndex) - 1;IF ( /*Base or Base Increase*/ ('IndicatorCode is Base'('Policy Coverage IndicatorCode'('CalcType SolveCriteria'(vectorSearchCriteria);#coverageIndex)) || 'IndicatorCode is BaseIncrease'('Policy Coverage IndicatorCode'('CalcType SolveCriteria'(vectorSearchCriteria);#coverageIndex))) ; Š   /*Yes*/ 'Solve PresentValue TargetPremium'(#coverageIndex;#yearIndex;vectorSolveParms;vectorSearchCriteria) ; Š   /*No*/ 0Š)))
F1 ffe715 2e03613d 0 2283bd86 0 0 2
-- Solve PresentValue TargetPremium(coverageIndex; yearIndex; vectorSolveParms; vectorSearchCriteria)
Funktion
'Target Coverage PV Method'('CalcType SolveCriteria'(vectorSearchCriteria); coverageIndex;Š‰'SharedVector SolveParms ReplaceFaceAmount'('CalcType SolveCriteria'(vectorSearchCriteria); 1; vectorSolveParms))Š Š* ('PLC Premium Load Primary Rate'('CalcType SolveCriteria'(vectorSearchCriteria); 'FeeType PremiumLoad'; coverageIndex; yearIndex) * 0.01Š‰‰‰‰-Š‰‰‰‰'PLC Premium Load Secondary Rate'('CalcType SolveCriteria'(vectorSearchCriteria); 'FeeType PremiumLoad'; coverageIndex; yearIndex) * 0.01Š‰‰‰‰)
F1 2283bd86 2e03613d 0 0 0 0 2
Solve PresentValue TargetPremium(coverageIndex; yearIndex; vectorSolveParms; vectorSearchCriteria)
Funktion
'Target Coverage PV Method'('CalcType SolveCriteria'(vectorSearchCriteria);coverageIndex;'SharedVector SolveParms ReplaceFaceAmount'('CalcType SolveCriteria'(vectorSearchCriteria);1;vectorSolveParms);yearIndex) * ('PLC Premium Load Primary Rate'('CalcType SolveCriteria'(vectorSearchCriteria);'FeeType PremiumLoad';coverageIndex;yearIndex) * 0.01 - 'PLC Premium Load Secondary Rate'('CalcType SolveCriteria'(vectorSearchCriteria);'FeeType PremiumLoad';coverageIndex;yearIndex) * 0.01)
F1 217a409e 521b0fa9 667f4e79 700e35cd 0 0 2
Solve RateFile Base TargetPremiumSum(vectorSolveParms; vectorSearchCriteria)
Funktion
SUMX(yearIndex;'Solve Start Year'(vectorSearchCriteria);'Solve Criteria Target Duration'(vectorSearchCriteria);SUMX(coverageIndex;0;'Policy Number of Coverage'('CalcType SolveCriteria'(vectorSearchCriteria);#yearIndex) - 1;IF ( /*Base or Base Increase*/ ('IndicatorCode is Base'('Policy Coverage IndicatorCode'('CalcType SolveCriteria'(vectorSearchCriteria);#coverageIndex)) || 'IndicatorCode is BaseIncrease'('Policy Coverage IndicatorCode'('CalcType SolveCriteria'(vectorSearchCriteria);#coverageIndex))) ; Š   /*Yes*/ 'Solve RateFile TargetPremium'(#coverageIndex;#yearIndex;vectorSolveParms;vectorSearchCriteria) ; Š   /*No*/ 0Š)))
F1 667f4e79 217a409e 0 2d922c43 0 0 2
-- Solve RateFile TargetPremium(coverageIndex; yearIndex; vectorSolveParms; vectorSearchCriteria)
Funktion
'RateFile RateLookup Coverage Target'('CalcType SolveCriteria'(vectorSearchCriteria);coverageIndex; 1 ;Š‰'SharedVector SolveParms ReplaceFaceAmount'('CalcType SolveCriteria'(vectorSearchCriteria); 1; vectorSolveParms))Š‰Š* ('PLC Premium Load Primary Rate'('CalcType SolveCriteria'(vectorSearchCriteria); 'FeeType PremiumLoad'; coverageIndex; yearIndex) * 0.01Š‰-Š‰'PLC Premium Load Secondary Rate'('CalcType SolveCriteria'(vectorSearchCriteria); 'FeeType PremiumLoad'; coverageIndex; yearIndex) * 0.01Š)
F1 2d922c43 217a409e 0 0 0 0 2
Solve RateFile TargetPremium(coverageIndex; yearIndex; vectorSolveParms; vectorSearchCriteria)
Funktion
'RateFile RateLookup Coverage Target'('CalcType SolveCriteria'(vectorSearchCriteria);coverageIndex;yearIndex;1;'SharedVector SolveParms ReplaceFaceAmount'('CalcType SolveCriteria'(vectorSearchCriteria);1;vectorSolveParms)) * ('PLC Premium Load Primary Rate'('CalcType SolveCriteria'(vectorSearchCriteria);'FeeType PremiumLoad';coverageIndex;yearIndex) * 0.01 - 'PLC Premium Load Secondary Rate'('CalcType SolveCriteria'(vectorSearchCriteria);'FeeType PremiumLoad';coverageIndex;yearIndex) * 0.01)
F1 700e35cd 521b0fa9 0 0 0 0 2
Solve SumOfCharges Base TargetPremium(vectorSolveParms; vectorSearchCriteria)
Funktion
SUMX(yearIndex;'Solve Start Year'(vectorSearchCriteria);'Solve Criteria Target Duration'(vectorSearchCriteria);'Solve Init Guess PV SpecAmt Charges'(vectorSolveParms;vectorSearchCriteria;#yearIndex) * ('PLC Premium Load Primary Rate'('CalcType SolveCriteria'(vectorSearchCriteria);'FeeType PremiumLoad';0;#yearIndex) * 0.01 - 'PLC Premium Load Secondary Rate'('CalcType SolveCriteria'(vectorSearchCriteria);'FeeType PremiumLoad';0;#yearIndex) * 0.01))
F1 3bf31162 24e83b0 2a789e73 26581a8 0 0 2
-- Solve function Code Guess Logic regula falsi with Illinois modification--
Funktion

F1 2a789e73 3bf31162 662fe2fc 0 0 0 2
-- New Solver Support Functions --
Funktion

F1 662fe2fc 2a789e73 9610063 37fe1eb2 0 0 2
Solve CashValueSolve(premium; vectorConstants)
Funktion
'Solve End Of Year Cash Value Rec'(e_(vectorConstants;0);'SharedVector SolveParms ReplacePremium'(premium;e_(vectorConstants;1);e_(vectorConstants;2));e_(vectorConstants;3);e_(vectorConstants;5);12;e_(vectorConstants;7))
F1 9610063 662fe2fc 0 0 0 0 2
Solve CashValueSolve Constants Vector(vectorSearchCriteria; vectorSolveParms)
Funktion
V_('CalcType SolveCriteria'(vectorSearchCriteria);'Solve Criteria Premium Duration'(vectorSearchCriteria);vectorSolveParms;'Solve Criteria Interest Rate'(vectorSearchCriteria;0);'Solve Criteria Addl Info'(vectorSearchCriteria);'Solve Criteria Target Duration'(vectorSearchCriteria);12;vectorSearchCriteria)
F1 37fe1eb2 2a789e73 0 0 0 0 2
Solve CashValueSolve FaceAmountSolve(faceAmount; vectorConstants)
Funktion
'Solve End Of Year Cash Value Rec'(e_(vectorConstants;0);'SharedVector SolveParms ReplaceFaceAmount'(e_(vectorConstants;0);faceAmount;e_(vectorConstants;2));e_(vectorConstants;3);e_(vectorConstants;5);12;e_(vectorConstants;7))
F1 26581a8 24e83b0 0 26585a8 0 0 2
Solve Model Name
Funktion
"Solve"
F1 26585a8 24e83b0 0 7e5ccbd3 0 0 2
Solve DthBenOpt(calcType; yearIndex; vectorSolveParms)
Funktion
IF ('ACCS CalcRule UL CalcType Is Level DB Assumption'('Policy CarrierCode';'Policy ProductCode';calcType;'Policy EffDate') ; Š   // level death benefitŠ'DeathBenefitOptType Level' ; Š   // else ŠIF ( /*Death Benefit option is passed or Use the policy record*/ 'SharedVector SolveParms DthBenOpt passed'(vectorSolveParms) ; Š     /*Yes*/ 'SharedVector SolveParms DthBenOpt'(vectorSolveParms;yearIndex) ; Š     /*No*/ 'Policy Coverage DeathBenefitOptType'(calcType;0;yearIndex)Š  )Š)
F1 7e5ccbd3 24e83b0 7dd2eff7 4353a7da 0 0 2
-- Solve function Code Guess Logic --
Funktion

F1 7dd2eff7 7e5ccbd3 0 77acf2e2 0 0 2
Solve Prev GuessCV(currCashValue; prevCashValue; newCashValue)
Funktion
IF (newCashValue < 0 || currCashValue < 0 ; Š  currCashValue ; Š  prevCashValue / 2Š)
F1 77acf2e2 7e5ccbd3 0 69e21c29 0 0 2
Solve Prev Guess(currPremGuess; currCashValue; prevPremGuess; newCashValue; prevCashValue)
Funktion
IF (newCashValue < 0 || currCashValue < 0 ; Š  currPremGuess ; Š  prevPremGuessŠ)
F1 69e21c29 7e5ccbd3 0 0 0 0 2
Solve Premium Guess2(currPremGuess; currCashValue; prevPremGuess; prevCashValue)
Funktion
currPremGuess - currCashValue * ((currPremGuess - prevPremGuess) / (currCashValue - prevCashValue))
F1 4353a7da 24e83b0 0 3b02b62f 0 0 2
Solve Base and Increase FaceAmount(calcType; vectorSolveParms; yearIndex)
Funktion
SUMX(covIdx;0;'Policy Number Of Coverage'(calcType;yearIndex) - 1;IF ( /*Base or Base Increase*///('IndicatorCode is Base'( 'Policy Coverage IndicatorCode'(calcType;#covIdx) ) Š//‰|| Š//‰'IndicatorCode is BaseIncrease'('Policy Coverage IndicatorCode'(calcType;#covIdx) ) );Š 'Coverage Is NAR Cost'(calcType;#covIdx) ; Š   /*Yes*/ 'SharedVector SolveParms FaceAmount'(#covIdx;vectorSolveParms;yearIndex) ; Š   /*No*/ 0Š))
F1 3b02b62f 24e83b0 0 18306bb6 0 0 2
Solve Charge Applicable(feeType; vectorSearchCriteria; yearIndex; monthIndex)
Funktion
CASE( /*Fee mode*/ IF ('FeeType is PremiumLoad'(feeType) ; Š  'Solve Premium Mode'('CalcType SolveCriteria'(vectorSearchCriteria)) ; Š  'Solve Fee Mode'(feeType)Š);Š // AnnualŠ1 : (monthIndex = 1);Š // SemiannualŠ2 : (monthIndex = 1) || (monthIndex = 7);Š // QuarterlyŠ3 : (monthIndex = 1) || (monthIndex = 4) || (monthIndex = 7) || (monthIndex = 10);Š // MonthlyŠ4 : 1;Š // Else FALSEŠ : 0)Š
F1 18306bb6 24e83b0 0 0 0 0 2
Solve Fee Mode(feeType)
Funktion
IF ('PI PolicyProduct Fee FeeMode'('Policy ProductCode';feeType;'Policy EffDate') ALIKE 'GEN Vector Blank' ; Š  1 ; Š  'PI PolicyProduct Fee FeeMode'('Policy ProductCode';feeType;'Policy EffDate')Š)
A0 24e34b4 0 0 0 0 0 0

T0 24e3524 0 0 0 0 0 0

I0 24e3594 0 2658c10 0 0 0 0

I0 2658c10 24e3594 0 0 0 0 0
CashValueProjections.pms
-
O0
E0
L0
B0
P1
24e7f68
F62
24e83b0
24e8338
24e84f8
24e85b0
24e8668
24e8840
24e8a18
24e8d28
24e8f60
24e9bd8
24e9d88
24e9e40
2648098
2648198
2648360
2648f00
2649b68
264a6d8
264af28
264afe0
e19a616
2ec6dfba
264b278
4ccebd29
2652450
51cc8c12
26503a8
2650780
2650898
2650b40
2650c60
2650d80
2650ea0
2650fc0
26510e0
2651208
559cf351
48e42044
509b39dd
2651908
26519f8
48547467
64a44c54
7744e11a
2652d68
401ec53b
7efd9428
5b19d801
1b3cd053
10ab2f4a
6759bfc5
53b81d8c
333349ae
6acb85de
2652ef8
3bf31162
26581a8
26585a8
7e5ccbd3
4353a7da
3b02b62f
18306bb6
A0
T0
!163
24e84f8 -2 -2
Description:  Function creating for testing that returns the initial premium guess based on the parameters passed.Š ŠModification Log:Š1/12/2011 - PAC013 calcType - BT - RestructureŠ9/16/2010 - PAC013 calcType - BT - Remove calcType where SearchCriteria is usedŠ7/2/2010 - PAC013 calcType - BT - Initially adding calcType parmŠ10/31/2007 CSC Initial Calculation/Rule
24e85b0 -2 -2
Description:  Annualized present value of charges.Š ŠModification Log:Š1/12/2011 - PAC013 calcType - BT - RestructureŠ9/16/2010 - PAC013 calcType - BT - Remove calcType where SearchCriteria is usedŠ7/2/2010 - PAC013 calcType - BT - Initially adding calcType parmŠ10/31/2007 CSC Initial Calculation/Rule
24e8668 -2 -2
ŠModification Log:Š1/12/2011 - PAC013 calcType - BT - RestructureŠ9/16/2010 - PAC013 calcType - BT - Remove calcType where SearchCriteria is usedŠ7/2/2010 - PAC013 calcType - BT - Initially adding calcType parm
24e8840 -2 -2
ŠModification Log:Š1/12/2011 - PAC013 calcType - BT - RestructureŠ9/16/2010 - PAC013 calcType - BT - Remove calcType where SearchCriteria is usedŠ7/2/2010 - PAC013 calcType - BT - Initially adding calcType parm
24e8a18 -2 -2
ŠModification Log:Š1/12/2011 - PAC013 calcType - BT - Restructure
24e8d28 -2 -2
ŠModification Log:Š1/12/2011 - PAC013 calcType - BT - RestructureŠ7/2/2010 - PAC013 calcType - BT - Initially adding calcType parm
24e8f60 -2 -2
Description:  Function created for test cases to be able to return the results of a premium search.  The following values will be returned as of stopIteration:ŠelemNum = 0:  Returns premium guessŠelemNum = 1:  Returns cash value at target durationŠelemNum = 2;  Returns previous premium guessŠelemNum = 3;  Returns previous cash valueŠelemNum = 4:  Returns low boundŠelemNum = 5:  Returns high boundŠ ŠModification Log:Š1/12/2011 - PAC013 calcType - BT - RestructureŠ9/16/2010 - PAC013 calcType - BT - Remove calcType where SearchCriteria is usedŠ7/2/2010 - PAC013 calcType - BT - Initially adding calcType parmŠ10/31/2007 CSC Initial Calculation/Rule
24e9bd8 -2 -2
ŠModification Log:Š5/12/2011 - PAC013 calcType - BT - Moved calcType functions into CalcType modelŠ1/12/2011 - PAC013 calcType - BT - RestructureŠ7/2/2010 - PAC013 calcType - BT - Initially adding calcType parm
24e9d88 -2 -2
Description:  Function created for test cases to be able to return the results of a premium search.  The following values will be returned as of stopIteration:ŠelemNum = 0:  Returns premium guessŠelemNum = 1:  Returns cash value at target durationŠelemNum = 2;  Returns previous premium guessŠelemNum = 3;  Returns previous cash valueŠelemNum = 4:  Returns low boundŠelemNum = 5:  Returns high boundŠ ŠModification Log:Š1/12/2011 - PAC013 calcType - BT - RestructureŠ9/16/2010 - PAC013 calcType - BT - Remove calcType where SearchCriteria is usedŠ7/2/2010 - PAC013 calcType - BT - Initially adding calcType parmŠ10/31/2007 CSC Initial Calculation/Rule
24e9e40 -2 -2
Description:  Performs an iterative search to solve for the level premium necessary to provide a cash value equal to the target cash value at the target duration.Š ŠModification Log:Š5/12/2011 - PAC013 calcType - BT - Moved calcType functions into CalcType modelŠ2/1/2011 - PAC013 calcType - BT - RestructureŠ10/31/2007 CSC Initial Calculation/Rule
2648098 -2 -2
ŠModification Log:Š5/12/2011 - PAC013 calcType - BT - Moved calcType functions into CalcType modelŠ1/12/2011 - PAC013 calcType - BT - Restructure
2648360 -2 -2
Description:  Performs an iterative search to solve for the level premium necessary to provide a cash value equal to the target cash value at the target duration.Š ŠModification Log:Š5/12/2011 - PAC013 calcType - BT - Moved calcType functions into CalcType modelŠ2/1/2011 - PAC013 calcType - BT - RestructureŠ9/16/2010 - PAC013 calcType - BT - remove calcType parm since can use vectorSearchCriteria to get calcType fromŠ10/31/2007 CSC Initial Calculation/Rule
2648f00 -2 -2
Description:  Performs an iterative search to solve for the level premium necessary to provide a cash value equal to the target cash value at the target duration.Š ŠModification Log:Š02/07/2011 - pA Regression CMC fixed error messageŠ1/12/2011 - PAC013 calcType - BT - RestructureŠ05/07/2010 CMC nbA merge to pA 1001 remared out subtraction of Target CV in the first line.Š10/31/2007 CSC Initial Calculation/Rule
7d5f33e9 -2 -2
ŠModification Log:Š1/12/2011 - PAC013 calcType - BT - Restructure
7818ddc2 -2 -2
ŠModification Log:Š1/12/2011 - PAC013 calcType - BT - Restructure
2649b68 -2 -2
Description:  Performs an iterative search to solve for the level premium necessary to provide a cash value equal to the target cash value at the target duration. Uses Annualized cash valuesŠ ŠModification Log:Š5/12/2011 - PAC013 calcType - BT - Moved calcType functions into CalcType modelŠ2/1/2011 - PAC013 calcType - BT - RestructureŠ10/31/2007 CSC Initial Calculation/Rule
264a6d8 -2 -2
Description:  Returns a premium guess based on either the secant method or bisection method (depending upon the iteration number).Š ŠModification Log:Š10/31/2007 CSC Initial Calculation/Rule
264af28 -2 -2
Description:  Make sure the premium guess is within the upper and lower bounds.Š ŠModification Log:Š10/31/2007 CSC Initial Calculation/Rule
264afe0 -2 -2
Description:  Returns a vector of the criteria necessary for a premium search.Š ŠModification Log:Š10/31/2007 CSC Initial Calculation/Rule
e19a616 -2 -2
Description:  Performs an iterative search to solve for the level premium necessary to provide a cash value equal to the target cash value at the target duration.Š ŠModification Log:Š02/09/2011 pA Regression CMC added logic to subtract face guess or target cash value which ever is appropriate.Š02/07/2011 - pA Regression CMC updates for Face Solves and corridor usage in solvesŠ
2ec6dfba -2 -2
Description:  Performs an iterative search to solve for the level premium necessary to provide a cash value equal to the target cash value at the target duration.Š ŠModification Log:Š07/10/2013 PA1401-26 KC added yearIndex parmŠ02/09/2011 pA Regression CMC added logic to subtract face guess or target cash value which ever is appropriate.Š02/07/2011 - pA Regression CMC updates for Face Solves and corridor usage in solvesŠ
4d47fa73 -2 -2
Description:   Flat and premium loads up to target when policy uses that method.Š ŠModification log:Š5/12/2011 - PAC013 calcType - BT - Moved calcType functions into CalcType modelŠ02/07/2011 - pA Regression CMC updates for Face Solves and corridor usage in solvesŠ2/1/2011 - PAC013 calcType - BT - RestructureŠ06/28/2010 wmA_ENH992_merge JL Merge wmA changes to StagingŠ03/10/2010 pA Performance moved uses fees check earlier to increase performance.Š03/04/2010 pA Performance Intial Calculation
4d4ee85f -2 -2
Description: Projected premium load charge.Š ŠModification Log:Š5/20/2011 wmA-J CMC Premium Load Charges enhancement for Premium Taxes (added feeType parm to higher level functions)Š5/12/2011 - PAC013 calcType - BT - Moved calcType functions into CalcType modelŠ02/07/2011 - pA Regression CMC updates for Face Solves and corridor usage in solvesŠ2/1/2011 - PAC013 calcType - BT - RestructureŠ1/26/2011 - PAC013 calctype CMC removed extra coverage and coverage option indexŠ1/12/2011 - PAC013 calcType - BT - RestructureŠ9/16/2010 - PAC013 calcType - BT - remove calcType parm since can use vectorSearchCriteria to get calcType fromŠ06/28/2010 wmA_ENH992_merge JL Merge wmA changes to Staging
2652450 -2 -2
Description:   Flat and premium loads up to target when policy uses that method.Š ŠModification log:Š5/12/2011 - PAC013 calcType - BT - Moved calcType functions into CalcType modelŠ02/07/2011 - pA Regression CMC updates for Face Solves and corridor usage in solvesŠ2/1/2011 - PAC013 calcType - BT - RestructureŠ9/16/2010 - PAC013 calcType - BT - remove calcType parm since can use vectorSearchCriteria to get calcType fromŠ06/28/2010 wmA_ENH992_merge JL Merge wmA changes to StagingŠ03/10/2010 pA Performance moved uses fees check earlier to increase performance.Š03/04/2010 pA Performance Intial CalculationŠ
32323155 -2 -2
Description: Projected premium load charge.Š ŠModification Log:Š5/20/2011 wmA-J CMC Premium Load Charges enhancement for Premium Taxes (added feeType parm to higher level functions)Š5/12/2011 - PAC013 calcType - BT - Moved calcType functions into CalcType modelŠ02/07/2011 - pA Regression CMC updates for Face Solves and corridor usage in solvesŠ2/1/2011 - PAC013 calcType - BT - RestructureŠ1/26/2011 - PAC013 calctype CMC removed extra coverage and coverage option indexŠ1/12/2011 - PAC013 calcType - BT - RestructureŠ9/16/2010 - PAC013 calcType - BT - remove calcType parm since can use vectorSearchCriteria to get calcType fromŠ06/28/2010 wmA_ENH992_merge JL Merge wmA changes to Staging
2fa2227a -2 -2
Description:    Calculates a discounted target Value back to the start date of the requested solve.  This method checks the NAR for becoming zero and switches to a monthly method when this occurs and then back to an annual calculation without using COIs.Š ŠModification log:Š9/6/2011 - pA1101 - cleanup - BT - update roundingŠ5/12/2011 - PAC013 calcType - BT - Moved calcType functions into CalcType modelŠ02/07/2011 - pA Regression CMC updates for Face Solves and corridor usage in solvesŠ2/1/2011 - PAC013 calcType - BT - RestructureŠ1/13/2011 - PAC013 calcType - BT - RestructureŠ1/12/2011 - PAC013 calcType - BT - RestructureŠ9/16/2010 - PAC013 calcType - BT - remove calcType parm since can use vectorSearchCriteria to get calcType fromŠ7/2/2010 - PAC013 calcType - BT - Initially adding calcType parmŠ03/04/2010 pA Performance Intial Calculation
2ee1ec37 -2 -2
Description:  Recursive End of period cash value.Š ŠModification Log:Š02/07/2011 - pA Regression CMC updates for Face Solves and corridor usage in solvesŠ1/13/2011 - PAC013 calcType - BT - Restructure
525e6f99 -2 -2
ŠModification Log:Š1/13/2011 - PAC013 calcType - BT - Restructure
5a2b66c0 -2 -2
ŠModification Log:Š1/13/2011 - PAC013 calcType - BT - Restructure
74804040 -2 -2
ŠModification Log:Š1/13/2011 - PAC013 calcType - BT - Restructure
5f05bf97 -2 -2
Description:  Negative NAR check using next years discounted cash value.Š ŠModification Log:Š02/07/2011 - pA Regression CMC updates for Face Solves and corridor usage in solvesŠ1/13/2011 - PAC013 calcType - BT - Restructure
3c324b94 -2 -2
ŠModification Log:Š1/14/2011 - PAC013 calcType - BT - RestructureŠ1/13/2011 - PAC013 calcType - BT - Restructure
9b54afc -2 -2
Description:    Monthly discounted cash valueŠ ŠModification log:Š5/12/2011 - PAC013 calcType - BT - Moved calcType functions into CalcType modelŠ02/07/2011 - pA Regression CMC updates for Face Solves and corridor usage in solvesŠ2/1/2011 - PAC013 calcType - BT - RestructureŠ1/19/2011 - PAC013 calcType - BT - RestructureŠ1/12/2011 - PAC013 calcType - BT - RestructureŠ9/16/2010 - PAC013 calcType - BT - remove calcType parm since can use vectorSearchCriteria to get calcType fromŠ9/7/2010 - PAC021 - rm - Replaced coverageIndex=0 with standard function 'Std BaseCov Index'(calcType)Š7/2/2010 - PAC013 calcType - BT - Initially adding calcType parmŠ06/28/2010 wmA_ENH992_merge JL Merge wmA changes to StagingŠ06/18/2010 wmA_ENH992_merge JL Allow for modal premium adjustment for initial prem guess calcŠ03/04/2010 pA Performance Intial CalculationŠ
3c58e0ef -2 -2
Description:    COI calculation used in the monthly discounted cash valueŠ ŠModification log:Š5/12/2011 - PAC013 calcType - BT - Moved calcType functions into CalcType modelŠ02/07/2011 - pA Regression CMC updates for Face Solves and corridor usage in solvesŠ2/1/2011 - PAC013 calcType - BT - RestructureŠ1/26/2011 - PAC013 calctype CMC removed extra coverage and coverage option indexŠ1/12/2011 - PAC013 calcType - BT - RestructureŠ9/16/2010 - PAC013 calcType - BT - remove calcType parm since can use vectorSearchCriteria to get calcType fromŠ7/2/2010 - PAC013 calcType - BT - Initially adding calcType parmŠ06/15/2010 pA RegTest JL Use total base FA, not just first covŠ04/14/2010 - Merge nbA to Staging - BT - add 0 coverageIndex to SharedVector SolveParms FaceAmountŠ03/04/2010 pA Performance Intial CalculationŠ
2d9e2e7a -2 -2
Description:    corridor check in the monthly calculation method.Š ŠModification log:Š7/2/2010 - PAC013 calcType - BT - Initially adding calcType parmŠ06/15/2010 pA RegTest JL Use total base FA, not just first covŠ04/14/2010 - Merge nbA to Staging - BT - add 0 coverageIndex to SharedVector SolveParms FaceAmountŠ03/04/2010 pA Performance Intial CalculationŠ
3e0851a8 -2 -2
Description:    Check of net amount at risk against the specified amount to see which discount method to use.Š ŠModification log:Š5/12/2011 - PAC013 calcType - BT - Moved calcType functions into CalcType modelŠ02/07/2011 - pA Regression CMC updates for Face Solves and corridor usage in solvesŠ2/1/2011 - PAC013 calcType - BT - RestructureŠ9/16/2010 - PAC013 calcType - BT - remove calcType parm since can use vectorSearchCriteria to get calcType fromŠ7/2/2010 - PAC013 calcType - BT - Initially adding calcType parmŠ03/08/2010 pA Performance added check for DB option 2 Š03/04/2010 pA Performance Intial Calculation
3a32b2ed -2 -2
Description:    Annual discounted cash valueŠ ŠModification log:Š5/12/2011 - PAC013 calcType - BT - Moved calcType functions into CalcType modelŠ02/07/2011 - pA Regression CMC updates for Face Solves and corridor usage in solvesŠ2/1/2011 - PAC013 calcType - BT - RestructureŠ1/14/2011 - PAC013 calcType - BT - RestructureŠ1/12/2011 - PAC013 calcType - BT - RestructureŠ9/16/2010 - PAC013 calcType - BT - remove calcType parm since can use vectorSearchCriteria to get calcType fromŠ9/7/2010 - PAC021 - rm - Replaced coverageIndex=0 with standard function 'Std BaseCov Index'(calcType)Š7/2/2010 - PAC013 calcType - BT - Initially adding calcType parmŠ06/28/2010 wmA_ENH992_merge JL Merge wmA changes to StagingŠ06/18/2010 wmA_ENH992_merge JL Allow fo rmodal prem adjustementŠ03/04/2010 pA Performance Intial CalculationŠ
3fa4eea -2 -2
Description:    Calculation of the initial premium guess using a check to switch between annual calculations with and without COIs and a monthly calculation for the year in which the NAR goes to zero.Š ŠModification log:Š5/12/2011 - PAC013 calcType - BT - Moved calcType functions into CalcType modelŠ02/07/2011 - pA Regression CMC updates for Face Solves and corridor usage in solvesŠ2/1/2011 - PAC013 calcType - BT - RestructureŠ1/12/2011 - PAC013 calcType - BT - RestructureŠ9/16/2010 - PAC013 calcType - BT - remove calcType parm since can use vectorSearchCriteria to get calcType fromŠ7/2/2010 - PAC013 calcType - BT - Initially adding calcType parmŠ05/14/2010 pA Performance Updated calculation start yearŠ03/04/2010 pA Performance Intial CalculationŠ
3fa4eea 0 2

551f6d4f -2 -2
Description:    Annuity factor with COIs adjusting for negative corridor.Š ŠModification log:Š5/12/2011 - PAC013 calcType - BT - Moved calcType functions into CalcType modelŠ02/07/2011 - pA Regression CMC updates for Face Solves and corridor usage in solvesŠ2/1/2011 - PAC013 calcType - BT - RestructureŠ1/12/2011 - PAC013 calcType - BT - RestructureŠ9/16/2010 - PAC013 calcType - BT - remove calcType parm since can use vectorSearchCriteria to get calcType fromŠ7/2/2010 - PAC013 calcType - BT - Initially adding calcType parmŠ06/18/2010 wmA_ENH992_merge JL Allow for modal premium adjustment for initial prem guess calcŠ06/16/2010 pA Regression Testing Added death benefit option 3 adjustmentŠ03/04/2010 pA Performance Intial Calculation
35d8d0b5 -2 -2
Description:  Monthly R factor for years in which policy enters or leaves corridor.Š ŠModification log:Š5/12/2011 - PAC013 calcType - BT - Moved calcType functions into CalcType modelŠ02/07/2011 - pA Regression CMC updates for Face Solves and corridor usage in solvesŠ2/1/2011 - PAC013 calcType - BT - RestructureŠ9/16/2010 - PAC013 calcType - BT - Remove calcType where SearchCriteria is usedŠ7/2/2010 - PAC013 calcType - BT - Initially adding calcType parmŠ03/04/2010 pA Performance Intial Calculation
2083402 -2 -2
ŠModification Log:Š5/12/2011 - PAC013 calcType - BT - Moved calcType functions into CalcType modelŠ02/07/2011 - pA Regression CMC updates for Face Solves and corridor usage in solvesŠ2/1/2011 - PAC013 calcType - BT - RestructureŠ9/16/2010 - PAC013 calcType - BT - Remove calcType where SearchCriteria is usedŠ7/2/2010 - PAC013 calcType - BT - Initially adding calcType parmŠ06/18/2010 wmA_ENH992_merge Merge required code from wmA
463e0d0e -2 -2
ŠModification Log:Š1/12/2011 - PAC013 calcType - BT - Restructure
73320528 -2 -2
ŠModification Log:Š1/12/2011 - PAC013 calcType - BT - Restructure
579d7c3f -2 -2
ŠModification Log:Š02/07/2011 - pA Regression CMC updates for Face Solves and corridor usage in solvesŠ1/12/2011 - PAC013 calcType - BT - Restructure
5ac7bd73 -2 -2
Description:    Calculation of the initial premium guess using interest and COIs in all durations and no monthly switch.  Used for establishing a high bound or low bound.Š ŠModification log:Š5/12/2011 - PAC013 calcType - BT - Moved calcType functions into CalcType modelŠ02/07/2011 - pA Regression CMC updates for Face Solves and corridor usage in solvesŠ2/1/2011 - PAC013 calcType - BT - RestructureŠ1/12/2011 - PAC013 calcType - BT - RestructureŠ9/16/2010 - PAC013 calcType - BT - remove calcType parm since can use vectorSearchCriteria to get calcType fromŠ7/2/2010 - PAC013 calcType - BT - Initially adding calcType parmŠ05/14/2010 pA Performance Updated calculation start yearŠ03/04/2010 pA Performance Intial Calculation
1c2ef69f -2 -2
Description:    Annuity factor with COIs always.Š ŠModification log:Š5/12/2011 - PAC013 calcType - BT - Moved calcType functions into CalcType modelŠ02/07/2011 - pA Regression CMC updates for Face Solves and corridor usage in solvesŠ2/1/2011 - PAC013 calcType - BT - RestructureŠ9/16/2010 - PAC013 calcType - BT - remove calcType parm since can use vectorSearchCriteria to get calcType fromŠ7/2/2010 - PAC013 calcType - BT - Initially adding calcType parmŠ06/16/2010 pA Regression Testing Added death benefit option 3 adjustmentŠ03/04/2010 pA Performance Intial Calculation
677a9fb6 -2 -2
Description:    Calculation of the initial premium guess using interest only in all durations and no monthly switch.  Used for establishing a high bound or low bound.Š ŠModification log:Š5/12/2011 - PAC013 calcType - BT - Moved calcType functions into CalcType modelŠ02/07/2011 - pA Regression CMC updates for Face Solves and corridor usage in solvesŠ2/1/2011 - PAC013 calcType - BT - RestructureŠ1/12/2011 - PAC013 calcType - BT - RestructureŠ9/16/2010 - PAC013 calcType - BT - remove calcType parm since can use vectorSearchCriteria to get calcType fromŠ7/2/2010 - PAC013 calcType - BT - Initially adding calcType parmŠ05/14/2010 pA Performance Updated calculation start yearŠ03/04/2010 pA Performance Intial Calculation
166f7a0 -2 -2
Description:    Annuity factor without COIs.Š ŠModification log:Š5/12/2011 - PAC013 calcType - BT - Moved calcType functions into CalcType modelŠ02/07/2011 - pA Regression CMC updates for Face Solves and corridor usage in solvesŠ2/1/2011 - PAC013 calcType - BT - RestructureŠ9/16/2010 - PAC013 calcType - BT - remove calcType parm since can use vectorSearchCriteria to get calcType fromŠ7/2/2010 - PAC013 calcType - BT - Initially adding calcType parmŠ06/16/2010 pA Regression Testing Added death benefit option 3 adjustmentŠ03/04/2010 pA Performance Intial Calculation
51cc8c12 -2 -2
Description:  Returns an initial premium guess based on a present value calculation.Š ŠModification Log:Š10/27/2009 - NT - Performance - round to 2 placesŠ9/16/2010 - PAC013 calcType - BT - Remove calcType where SearchCriteria is usedŠ7/2/2010 - PAC013 calcType - BT - Initially adding calcType parmŠ10/31/2007 CSC Initial Calculation/Rule
5dd594d0 -2 -2
Description:  Annualized present value of charges.Š ŠModification Log:Š9/16/2010 - PAC013 calcType - BT - Remove calcType where SearchCriteria is usedŠ7/2/2010 - PAC013 calcType - BT - Initially adding calcType parmŠ10/31/2007 CSC Initial Calculation/Rule
12e548c9 -2 -2
Description:  Present value of charges for year yearIndex.Š ŠModification Log:Š5/20/2011 wmA-J CMC Premium Load Charges enhancement for Premium Taxes (added feeType parm to higher level functions)Š5/12/2011 - PAC013 calcType - BT - Moved calcType functions into CalcType modelŠ02/07/2011 - pA Regression CMC updates for Face Solves and corridor usage in solvesŠ2/1/2011 - PAC013 calcType - BT - RestructureŠ1/12/2011 - PAC013 calcType - BT - RestructureŠ9/16/2010 - PAC013 calcType - BT - remove calcType parm since can use vectorSearchCriteria to get calcType fromŠ7/2/2010 - PAC013 calcType - BT - Initially adding calcType parmŠ10/24/2008‰VPM028‰Changed operator from "=" to "EQUAL" to bypass fatal error when the requested Fee object is not present.  This change will allow a zero to be returned for the Fee value.Š12/5/2007 GLP001 pA Phase 2  Add criteria for flat amount premium load charge that the yearIndex is still within the premium paying period.‰Added and adjustment factor for better initial guesses for Death Benefit Option B and All death benefit options when waiver of monthly deduction is present. Added the premium load charge for the amount up to the load target.  This only applies to solves that are NOT load target solves.Š10/31/2007 CSC Initial Calculation/Rule
2015ec88 -2 -2
Description:  Total charges for year yearIndex.Š ŠModification Log:Š5/12/2011 - PAC013 calcType - BT - Moved calcType functions into CalcType modelŠ02/07/2011 - pA Regression CMC updates for Face Solves and corridor usage in solvesŠ2/1/2011 - PAC013 calcType - BT - RestructureŠ1/12/2011 - PAC013 calcType - BT - RestructureŠ9/16/2010 - PAC013 calcType - BT - remove calcType parm since can use vectorSearchCriteria to get calcType fromŠ9/7/2010 - PAC021 - rm - Replaced coverageIndex=0 with standard function 'Std BaseCov Index'(calcType)Š7/2/2010 - PAC013 calcType - BT - Initially adding calcType parmŠ06/28/2010 wmA_ENH992_merge JL Merge wmA changes to StagingŠ12/5/2007 SPR GLP001 pA Phase 2 Added Non COI Timing Adjustment.  This is to reflect the timing of expense and rider charges with respect to the Net Amount at Risk Calculaiton. Also added the solve adjustment factor so that the common discounting factor can be used.Š10/31/2007 CSC Initial Calculation/Rule
7323fd8e -2 -2
Description:  Returns the monthly expenses to be used in the calculation for year yearIndex.Š ŠModification Log:Š1/26/2011 - PAC013 calctype CMC removed extra coverage and coverage option indexŠ1/12/2011 - PAC013 calcType - BT - RestructureŠ7/2/2010 - PAC013 calcType - BT - Initially adding calcType parmŠ06/28/2010 wmA_ENH992_merge JL Merge wmA changes to StagingŠ10/31/2007 CSC Initial Calculation/Rule
586bfb97 -2 -2
Description:  Returns the Coverage charges (and associated CovOption charges) for Coverages not associated with the NAR.Š ŠModification Log:Š1/26/2011 - PAC013 calctype CMC removed extra coverage and coverage option indexŠ1/12/2011 - PAC013 calcType - BT - RestructureŠ7/2/2010 - PAC013 calcType - BT - Initially adding calcType parmŠ05/07/2010 CMC nbA Merge to pA1001 change to use COV Projected Monthly Total Coverage Charge NoWMD instead of COV Projected Monthly Total Coverage ChargeŠ11/2/2009 - NT - changed no. coverage yearIndex to read from vector, in order to do calculations at issue, ignoring changes post-issueŠ10/31/2007 CSC Initial Calculation/Rule
26e34292 -2 -2
Description:  Returns the coi charge for yearIndex.Š ŠModification Log:Š5/12/2011 - PAC013 calcType - BT - Moved calcType functions into CalcType modelŠ02/07/2011 - pA Regression CMC updates for Face Solves and corridor usage in solvesŠ2/1/2011 - PAC013 calcType - BT - RestructureŠ1/26/2011 - PAC013 calctype CMC removed extra coverage and coverage option indexŠ1/14/2011 - PAC013 calcType - BT - RestructureŠ1/12/2011 - PAC013 calcType - BT - RestructureŠ9/16/2010 - PAC013 calcType - BT - remove calcType parm since can use vectorSearchCriteria to get calcType fromŠ7/2/2010 - PAC013 calcType - BT - Initially adding calcType parmŠ06/15/2010 pA RegTest JL Use total base FA, not just first covŠ11/27/2009 - PAC006 - wdp - Added coverageIndex parameter to SharedVector SolveParms FaceAmount functionsŠ12/5/2007  SPR GLP001 pA Phase 2 Changed the divisor to be for all death benefit options.Š10/31/2007 CSC Initial Calculation/Rule
3979958a -2 -2
Description:  Returns the monthly expenses to be used in the calculation for year yearIndex. These are adjusted for fee modality.Š ŠModification Log:Š5/12/2011 - PAC013 calcType - BT - Moved calcType functions into CalcType modelŠ02/07/2011 - pA Regression CMC updates for Face Solves and corridor usage in solvesŠ2/1/2011 - PAC013 calcType - BT - RestructureŠ1/26/2011 - PAC013 calctype CMC removed extra coverage and coverage option indexŠ1/12/2011 - PAC013 calcType - BT - RestructureŠ9/16/2010 - PAC013 calcType - BT - remove calcType parm since can use vectorSearchCriteria to get calcType fromŠ7/2/2010 - PAC013 calcType - BT - Initially adding calcType parmŠ06/28/2010 wmA_ENH992_merge JL Merge wmA changes to Staging
294bce22 -2 -2
Description:  Returns the annualized R factor.Š ŠModification Log:Š9/16/2010 - PAC013 calcType - BT - Remove calcType where SearchCriteria is usedŠ7/2/2010 - PAC013 calcType - BT - Initially adding calcType parmŠ03/14/2008 CMC ILLUS001 pA Phase 2  Updated to add vectorSolveParms as a parameter.  This is used to pass death benefit option to the coi functions.Š10/31/2007 CSC Initial Calculation/Rule
6462f8df -2 -2
Description:  Present value R factor.Š‰ŠR factor= 1 / ( ( 1 + q) * (1 + i) ) for option AŠ‰1 /  (1 +i) for option BŠwhere q is monthly COI per $1, and i is monthly interest rateŠ ŠModification Log:Š5/12/2011 - PAC013 calcType - BT - Moved calcType functions into CalcType modelŠ02/07/2011 - pA Regression CMC updates for Face Solves and corridor usage in solvesŠ2/1/2011 - PAC013 calcType - BT - RestructureŠ1/26/2011 - PAC013 calctype CMC removed extra coverage and coverage option indexŠ1/12/2011 - PAC013 calcType - BT - RestructureŠ9/16/2010 - PAC013 calcType - BT - remove calcType parm since can use vectorSearchCriteria to get calcType fromŠ8/11/2010 - PAC013 calcType - BT - Change order of COV CovOption COI Rate parmsŠ7/2/2010 - PAC013 calcType - BT - Initially adding calcType parmŠ03/14/2008 CMC ILLUS001 pA Phase 2  Updated to add vectorSolveParms as a parameter.  This is used to pass death benefit option to the coi functions.Š12/6/2007  SPR GLP001 pA Phase 2 Revised the R factor as followsŠ10/31/2007 CSC Initial Calculation/RuleŠ ŠR factor= 1 / ( ( 1 + q) * (1 + i) ) for option A and CŠ‰1 /  (1 +i+iq) for option BŠwhere q is monthly COI per $1, and i is monthly interest rateŠ ŠWith waiver of monthly deductionŠR factor= 1 / ( ( 1 + i) * (1 + q+qw) ) for option A and CŠ‰1 /  (1 +i+iq+iqw) for option BŠ Š Š
52fa3199 -2 -2
Description:  The adjustment applies all charges except premium load up to the target premium.  This is necessary so that a common discount factor "R" can be used against all expenses.Š ŠModification Log:Š5/12/2011 - PAC013 calcType - BT - Moved calcType functions into CalcType modelŠ02/07/2011 - pA Regression CMC updates for Face Solves and corridor usage in solvesŠ2/1/2011 - PAC013 calcType - BT - RestructureŠ1/26/2011 - PAC013 calctype CMC removed extra coverage and coverage option indexŠ1/12/2011 - PAC013 calcType - BT - RestructureŠ9/16/2010 - PAC013 calcType - BT - remove calcType parm since can use vectorSearchCriteria to get calcType fromŠ8/11/2010 - PAC013 calcType - BT - Change order of COV CovOption COI Rate parmsŠ7/2/2010 - PAC013 calcType - BT - Initially adding calcType parmŠ03/14/2008 CMC ILLUS001 pA Phase 2  Updated to add vectorSolveParms as a parameter.  This is used to pass death benefit option to the coi functions.Š12/6/2007 SPR GLP001 pA Phase 2
76c4ef1e -2 -2
Description:  The adjustment applies all charges except premium load up to the target premium.  This is necessary so that a common discount factor "R" can be used against all expenses.Š ŠModification Log:Š5/12/2011 - PAC013 calcType - BT - Moved calcType functions into CalcType modelŠ02/07/2011 - pA Regression CMC updates for Face Solves and corridor usage in solvesŠ2/1/2011 - PAC013 calcType - BT - RestructureŠ1/26/2011 - PAC013 calctype CMC removed extra coverage and coverage option indexŠ1/12/2011 - PAC013 calcType - BT - RestructureŠ9/16/2010 - PAC013 calcType - BT - remove calcType parm since can use vectorSearchCriteria to get calcType fromŠ8/11/2010 - PAC013 calcType - BT - Change order of COV CovOption COI Rate parmsŠ7/2/2010 - PAC013 calcType - BT - Initially adding calcType parmŠ03/14/2008 CMC ILLUS001 pA Phase 2  Updated to add vectorSolveParms as a parameter.  This is used to pass death benefit option to the coi functions.Š12/6/2007 SPR GLP001 pA Phase 2
4a8b715f -2 -2
Description:  This adjusts for the timing of expense and rider charges with respect to the Net Amount at Risk CalculationŠ ŠModification Log:Š7/2/2010 - PAC013 calcType - BT - Initially adding calcType parmŠ03/14/2008 CMC ILLUS001 pA Phase 2  Updated to add vectorSolveParms as a parameter.  This is used to pass death benefit option to the coi functions.Š12/6/2007 SPR GLP001 pA Phase 2
71848698 -2 -2
Description:  Returns the annualized present value of payments factor (adjusted by the premium load rate).Š ŠModification Log:Š5/12/2011 - PAC013 calcType - BT - Moved calcType functions into CalcType modelŠ02/07/2011 - pA Regression CMC updates for Face Solves and corridor usage in solvesŠ2/1/2011 - PAC013 calcType - BT - RestructureŠ9/16/2010 - PAC013 calcType - BT - remove calcType parm since can use vectorSearchCriteria to get calcType fromŠ7/2/2010 - PAC013 calcType - BT - Initially adding calcType parmŠ03/14/2008 CMC ILLUS001 pA Phase 2  Updated to add vectorSolveParms as a parameter used to pass death benefit option.  This is to pass death benefit Šoption to the coi functions.Š12/6/2007 SPR GLP001 pA Phase 2 Added an adjusted that reflects the cost of insurance charge under death benefit Šoption C for the premium component of the death benefitŠ10/31/2007 CSC Initial Calculation/Rule
135debb4 -2 -2
Description:  Returns the net premium factor for the year.Š ŠModification Log:Š5/20/2011 wmA-J CMC Premium Load Charges enhancement for Premium Taxes (added feeType parm to higher level functions)Š5/12/2011 - PAC013 calcType - BT - Moved calcType functions into CalcType modelŠ02/07/2011 - pA Regression CMC updates for Face Solves and corridor usage in solvesŠ2/1/2011 - PAC013 calcType - BT - RestructureŠ1/26/2011 - PAC013 calctype CMC removed extra coverage and coverage option indexŠ1/12/2011 - PAC013 calcType - BT - RestructureŠ9/16/2010 - PAC013 calcType - BT - remove calcType parm since can use vectorSearchCriteria to get calcType fromŠ06/28/2010 wmA_ENH992_merge JL Merge wmA changes to StagingŠ10/31/2007 CSC Initial Calculation/Rule
72b2c6d5 -2 -2
Description - more accurate premium load rate, taking target premiums into accountŠ ŠModification Log:Š5/20/2011 wmA-J CMC Premium Load Charges enhancement for Premium Taxes (added feeType parm to higher level functions)Š5/12/2011 - PAC013 calcType - BT - Moved calcType functions into CalcType modelŠ02/07/2011 - pA Regression CMC updates for Face Solves and corridor usage in solvesŠ2/2/2011 - PAC013 calctype - BT - add TARGET PremiumŠ1/26/2011 - PAC013 calctype CMC removed extra coverage and coverage option indexŠ1/12/2011 - PAC013 calcType - BT - RestructureŠ7/2/2010 - PAC013 calcType - BT - Initially adding calcType parmŠ11/25/2008 CSC Updated to calc target when run for IllustrationsŠ10/31/2007 CSC Initial Calculation/Rule
183fa277 -2 -2
Description - more accurate premium load rate, taking target premiums into accountŠ ŠModification Log:Š07/10/2013 PA1401-26 KC added yearIndex parmŠ5/20/2011 wmA-J CMC Premium Load Charges enhancement for Premium Taxes (added feeType parm to higher level functions)Š5/12/2011 - PAC013 calcType - BT - Moved calcType functions into CalcType modelŠ02/07/2011 - pA Regression CMC updates for Face Solves and corridor usage in solvesŠ2/2/2011 - PAC013 calctype - BT - add TARGET PremiumŠ1/26/2011 - PAC013 calctype CMC removed extra coverage and coverage option indexŠ1/12/2011 - PAC013 calcType - BT - RestructureŠ7/2/2010 - PAC013 calcType - BT - Initially adding calcType parmŠ11/25/2008 CSC Updated to calc target when run for IllustrationsŠ10/31/2007 CSC Initial Calculation/Rule
3a9f513b -2 -2
Description - Guess for premium using information up to, but excluding accurate premium load rateŠ ŠModification Log:Š9/16/2010 - PAC013 calcType - BT - Remove calcType where SearchCriteria is usedŠ7/2/2010 - PAC013 calcType - BT - Initially adding calcType parmŠ10/31/2007 CSC Initial Calculation/Rule
7981e5b8 -2 -2
Description:  Returns an amount that reflects the cost of insurance charge under death benefit option C for the premium component of the death benefitŠ ŠModification Log:Š5/12/2011 - PAC013 calcType - BT - Moved calcType functions into CalcType modelŠ02/07/2011 - pA Regression CMC updates for Face Solves and corridor usage in solvesŠ2/1/2011 - PAC013 calcType - BT - RestructureŠ1/26/2011 - PAC013 calctype CMC removed extra coverage and coverage option indexŠ1/12/2011 - PAC013 calcType - BT - RestructureŠ9/16/2010 - PAC013 calcType - BT - remove calcType parm since can use vectorSearchCriteria to get calcType fromŠ8/11/2010 - PAC013 calcType - BT - Change order of COV CovOption COI Rate parmsŠ7/2/2010 - PAC013 calcType - BT - Initially adding calcType parmŠ03/14/2008 CMC ILLUS001 pA Phase 2  Updated to add vectorSolveParms as a parameter.  This is used to pass death benefit option to the coi functions.Š12/6/2007 SPR GLP001 pA Phase 2
26503a8 -2 -2
The premium search criteria vector is expected to be passed with the following positions:Š0 = Calculation TypeŠ1 = Target Cash ValueŠ2 = Target DurationŠ3 = Premium DurationŠ4 = Interest RateŠ5 = Cash Value ToleranceŠ6 = Premium ToleranceŠ7 = Requested Stop DurationŠ8 = Vector of Additional CV projection informationŠ‰0 = Check for lapse (True or False)Š‰1 = Initial lump sum amountŠ‰2 = Adjust for DEFRA (True or False)Š‰3 = Vector of guideline limitsŠ‰4 = Varying premiums (True or False)Š‰5 = Vector of periodic premiumsŠ‰6 = Vector of load target premiums by coverageŠ‰7 = Projection start yearŠ‰8 = Projection start month
2650780 -2 -2
Description:  Extract the target cash value from the search criteria vector.Š ŠModification Log:Š10/31/2007 CSC Initial Calculation/Rule
2650898 -2 -2
Description:  Extract the target cash value from the search criteria vector.Š ŠModification Log:Š10/31/2007 CSC Initial Calculation/Rule
2650b40 -2 -2
Description:  Extract the target duration from the search criteria vector.Š ŠModification Log:Š10/31/2007 CSC Initial Calculation/Rule
2650c60 -2 -2
Description:  Extract the premium duration from the search criteria vector.Š ŠModification Log:Š10/31/2007 CSC Initial Calculation/Rule
2650d80 -2 -2
Description:  Extract the interest rate from the search criteria vector.Š ŠModification Log:Š05/02/2010 ENH922 JL yearIndex for "Solve Criteria Interest Rate"Š10/31/2007 CSC Initial Calculation/Rule
2650ea0 -2 -2
Description:  Extract the cash value tolerance from the search criteria vector.Š ŠModification Log:Š10/31/2007 CSC Initial Calculation/Rule
2650fc0 -2 -2
Description:  Extract the premium tolerance from the search criteria vector.Š ŠModification Log:Š10/31/2007 CSC Initial Calculation/Rule
26510e0 -2 -2
Description:  Extract the requested stop duration from the search criteria vector.Š ŠModification Log:Š10/31/2007 CSC Initial Calculation/Rule
2651208 -2 -2
Description:  Extract the vector of additional criteria needed for the CV projection.Š ŠModification Log:Š10/31/2007 CSC Initial Calculation/Rule
44f8b8 -2 -2
Description:  Replaces the guideline premiums in the search criteria vector using the given face amountŠ ŠModification Log:Š02/07/2011 - pA Regression CMC updates for Face Solves and corridor usage in solves
7174b1ba -2 -2
Description:  Replaces the target premium in the search criteria vector using the given face amountŠ ŠModification Log:Š5/12/2011 - PAC013 calcType - BT - Moved calcType functions into CalcType modelŠ02/08/2011 - pA Regression CMC added check for target usage.Š02/07/2011 - pA Regression CMC updates for Face Solves and corridor usage in solvesŠ
4e1d5b98 -2 -2
Description:  Replaces the target premium in the search criteria vector using the given face amountŠ ŠModification Log:Š11/8/2013pA 1401 - 26 CMC removed yearIndex from target face solve function callŠ07/10/2013 PA1401-26 KC added yearIndex parmŠ5/12/2011 - PAC013 calcType - BT - Moved calcType functions into CalcType modelŠ02/08/2011 - pA Regression CMC added check for target usage.Š02/07/2011 - pA Regression CMC updates for Face Solves and corridor usage in solvesŠ
3bf1066d -2 -2
Description:  Indicator for premium loads using target premiumsŠ ŠModificiation Log:Š5/20/2011 wmA-J CMC Premium Load Charges enhancement for Premium Taxes (added feeType parm to higher level functions)Š5/12/2011 - PAC013 calcType - BT - Moved calcType functions into CalcType modelŠ02/08/2011 CMC pA Regression Added Function.
559cf351 -2 -2
Description:  Extract the calculation type from the search criteria vector.Š ŠModification Log:Š10/31/2007 CSC Initial Calculation/Rule
48e42044 -2 -2
Description:  Determines if the COI should be used when the policy is in corridor.Š ŠModification Log:Š11/10/2011 pA PAD-819 CMC added current illustration to use cois in corridor.Š5/12/2011 - PAC013 calcType - BT - Moved calcType functions into CalcType modelŠ02/07/2011 - pA Regression CMC updates for Face Solves and corridor usage in solvesŠ
509b39dd -2 -2
ŠModification Log:Š5/12/2011 - PAC013 calcType - BT - Moved calcType functions into CalcType model
26519f8 -2 -2
Description:    Forward projection of cash values using an annual calculation and only monthly when the NAR dictates.Š ŠModification log:Š11/30/2012 PAC029 ITR JL - Add Cov Index for R factor COI rate to Corridor Indicator parmŠ9/6/2011 - pA1101 - cleanup - BT - update roundingŠ02/07/2011 - pA Regression CMC updates for Face Solves and corridor usage in solvesŠ9/16/2010 - PAC013 calcType - BT - Remove calcType where SearchCriteria is usedŠ7/2/2010 - PAC013 calcType - BT - Initially adding calcType parmŠ03/04/2010 pA Performance Intial Calculation
48547467 -2 -2
Description:    Call to monthly cash value calculationŠ ŠModification log:Š5/12/2011 - PAC013 calcType - BT - Moved calcType functions into CalcType modelŠ02/07/2011 - pA Regression CMC updates for Face Solves and corridor usage in solvesŠ2/1/2011 - PAC013 calcType - BT - RestructureŠ9/16/2010 - PAC013 calcType - BT - remove calcType parm since can use vectorSearchCriteria to get calcType fromŠ03/04/2010 pA Performance Intial Calculation
64a44c54 -2 -2
Description:    Check of NAR to determine which calculation method to use for the current year.Š ŠModification log:Š11/30/2012 PAC029 ITR JL - Add check to determine whether COI rate used in R factor is for the same coverage during the year. If so, continue with relevant annual build; else use monthly accumulation.Š5/12/2011 - PAC013 calcType - BT - Moved calcType functions into CalcType modelŠ02/07/2011 - pA Regression CMC updates for Face Solves and corridor usage in solvesŠ2/1/2011 - PAC013 calcType - BT - RestructureŠ9/16/2010 - PAC013 calcType - BT - remove calcType parm since can use vectorSearchCriteria to get calcType fromŠ7/2/2010 - PAC013 calcType - BT - Initially adding calcType parmŠ03/08/2010 pA Performance added the new death benefit function.Š03/04/2010 pA Performance Initial Calculation
79d2cf47 -2 -2
Description:    Returns the death benefit to be used in the NAR check.Š ŠModification log:Š5/12/2011 - PAC013 calcType - BT - Moved calcType functions into CalcType modelŠ02/07/2011 - pA Regression CMC updates for Face Solves and corridor usage in solvesŠ2/1/2011 - PAC013 calcType - BT - RestructureŠ10/29/2010 PAC014 - MAS - Solve needs to reference 'Base plus increases', not just base.Š9/16/2010 - PAC013 calcType - BT - remove calcType parm since can use vectorSearchCriteria to get calcType fromŠ7/2/2010 - PAC013 calcType - BT - Initially adding calcType parmŠ03/08/2010 pA Performance Intial Calculation
7744e11a -2 -2
Description:   Calculation of the cash value used in NAR calculation to check for a situation where the NAR is < specified amount at the beginning and end of the year but due to premium payment crosses twice during the year.Š ŠModification log:Š5/12/2011 - PAC013 calcType - BT - Moved calcType functions into CalcType modelŠ02/07/2011 - pA Regression CMC updates for Face Solves and corridor usage in solvesŠ2/1/2011 - PAC013 calcType - BT - RestructureŠ1/12/2011 - PAC013 calcType - BT - RestructureŠ9/16/2010 - PAC013 calcType - BT - remove calcType parm since can use vectorSearchCriteria to get calcType fromŠ9/7/2010 - PAC021 - rm - Replaced coverageIndex=0 with standard function 'Std BaseCov Index'(calcType)Š06/28/2010 wmA_ENH992_merge JL Merge wmA changes to Staging03/04/2010 pA Performance Intial CalculationŠ
2652d68 -2 -2
Description:    Specified amount used to determine the NAR.Š ŠModification log:Š02/14/2013 - PAD1213 - JL - Use "Std Coverage is Inforce" instead of "Coverage is Inforce"Š02/07/2011 - pA Regression CMC updates for Face Solves and corridor usage in solvesŠ2/1/2011 - PAC013 calcType - BT - RestructureŠ7/2/2010 - PAC013 calcType - BT - Initially adding calcType parmŠ03/04/2010 pA Performance Intial CalculationŠ06/03/2009 - DT - PA1013 - added parm TransEffDur to 'Coverage Is InForce'
401ec53b -2 -2
Description:    Annual forward projection of cash values.Š ŠModification log:Š11/30/2012 PAC029 ITR JL - Add corridor indicator parms to Initial COI Charge functionŠ5/12/2011 - PAC013 calcType - BT - Moved calcType functions into CalcType modelŠ02/07/2011 - pA Regression CMC updates for Face Solves and corridor usage in solvesŠ2/1/2011 - PAC013 calcType - BT - RestructureŠ1/12/2011 - PAC013 calcType - BT - RestructureŠ9/16/2010 - PAC013 calcType - BT - remove calcType parm since can use vectorSearchCriteria to get calcType fromŠ9/7/2010 - PAC021 - rm - Replaced coverageIndex=0 with standard function 'Std BaseCov Index'(calcType)Š7/2/2010 - PAC013 calcType - BT - Initially adding calcType parmŠ06/28/2010 wmA_ENH992_merge JL Merge wmA changes to Staging06/18/2010 wmA_ENH992_merge JL Add modal premium annuity factor to allow for modal premums in solve; include in prem loadsŠ03/08/2010 pA Performance changed to reference the new COI projection function.Š03/04/2010 pA Performance Intial CalculationŠ
25408f12 -2 -2
Description:  Annuity factor to allow for calculation of modal premiums. Uses present value R factor to take COI into account.ŠCalulated as (1 - v^(payments in year)) / (1 - v) where v = R ^ (months in paymode)Š ŠModification log:Š5/12/2011 - PAC013 calcType - BT - Moved calcType functions into CalcType modelŠ02/07/2011 - pA Regression CMC updates for Face Solves and corridor usage in solvesŠ2/1/2011 - PAC013 calcType - BT - RestructureŠ9/16/2010 - PAC013 calcType - BT - remove calcType parm since can use vectorSearchCriteria to get calcType fromŠ7/2/2010 - PAC013 calcType - BT - Initially adding calcType parmŠ06/24/2010 RegTest JL Do not calculate if mode =1 (factor is 1, avoid extra calculation)Š06/18/2010 wmA_ENH992_merge JL Initial Calculation
41468811 -2 -2
Description:  Premium payment modeŠ ŠModification log:Š1/26/2011 - PAC013 calctype CMC removed extra coverage and coverage option indexŠ1/12/2011 - PAC013 calcType - BT - RestructureŠ7/2/2010 - PAC013 calcType - BT - Initially adding calcType parmŠ06/18/2010 wmA_ENH992_merge JL Initial Calculation
43dffb3d -2 -2
Description:  Annuity factor to allow for calculation of modal amounts. Uses present value R factor to take COI into account.ŠCalulated as (1 - v^(payments in year)) / (1 - v) where v = R ^ (months in mode)Š ŠModification log:Š02/07/2011 - pA Regression CMC updates for Face Solves and corridor usage in solvesŠ9/16/2010 - PAC013 calcType - BT - Remove calcType where SearchCriteria is usedŠ7/2/2010 - PAC013 calcType - BT - Initially adding calcType parmŠ06/28/2010 wmA_ENH992_merge JL Merge wmA changes to Staging
7efd9428 -2 -2
Description:  Returns the coi charge for yearIndex to be used in the annual cash value projections for solves.Š ŠModification Log:Š11/30/2012 PAC029 ITR JL - The COI rate multiplier (in Discounted DB * COI) needs to be the largest of (1) the coverage for which the COI rate is used in the R factor (e.g. the partially funded by CV cov on a FIFO basis) and (2) the cov for the which the COI charge is being calculated (#covIndex). This assume that the overages are read in order if FIFO applies (e.g. use 1 before 1 for NAR purposes, etc). The COI rate divisor (in / (1+ COI) ) needs to be the COI rate used when calculating the R-factor (e.g. the partially funded by CV cov on a FIFO basis).Š5/12/2011 - PAC013 calcType - BT - Moved calcType functions into CalcType modelŠ02/07/2011 - pA Regression CMC updates for Face Solves and corridor usage in solvesŠ2/1/2011 - PAC013 calcType - BT - RestructureŠ1/12/2011 - PAC013 calcType - BT - RestructureŠ9/16/2010 - PAC013 calcType - BT - remove calcType parm since can use vectorSearchCriteria to get calcType fromŠ7/2/2010 - PAC013 calcType - BT - Initially adding calcType parmŠ06/03/2010 - Merge nbA to Staging - BT - sumX coverageIndexŠ04/14/2010 - Merge nbA to Staging - BT - add 0 coverageIndex to SharedVector SolveParms FaceAmountŠ03/08/2010 pA Performance Intial Calculation
5b19d801 -2 -2
Description:  Solve method using monthly values.Š ŠModification log:Š9/6/2011 - pA1101 - cleanup - BT - update roundingŠ7/14/2011 - pA1101 - cleanup - BT - code reuseŠ02/07/2011 - pA Regression CMC updates for Face Solves and corridor usage in solvesŠ7/2/2010 - PAC013 calcType - BT - Initially adding calcType parm
56c95656 -2 -2
Description:  Annual beginning of month cash valueŠ ŠModification Log:Š02/07/2011 - pA Regression CMC updates for Face Solves and corridor usage in solvesŠ1/12/2011 - PAC013 calcType - BT - RestructureŠ9/16/2010 - PAC013 calcType - BT - Remove calcType where SearchCriteria is usedŠ7/2/2010 - PAC013 calcType - BT - Initially adding calcType parmŠ4/14/2010 - Merge nbA to Staging - BT - Add targetLoadInd 0 to SolveNetPremiumFactor
1b3cd053 -2 -2
ŠModification Log:Š5/12/2011 - PAC013 calcType - BT - Moved calcType functions into CalcType modelŠ1/12/2011 - PAC013 calcType - BT - Restructure
10ab2f4a -2 -2
Description:  Returns the annualized R factor.Š ŠModification Log:Š02/07/2011 - pA Regression CMC updates for Face Solves and corridor usage in solvesŠ9/16/2010 - PAC013 calcType - BT - Remove calcType where SearchCriteria is usedŠ7/2/2010 - PAC013 calcType - BT - Initially adding calcType parmŠ03/14/2008 CMC ILLUS001 pA Phase 2  Updated to add vectorSolveParms as a parameter.  This is used to pass death benefit option to the coi functions.Š10/31/2007 CSC Initial Calculation/Rule
6759bfc5 -2 -2
Description:  The adjustment applies all charges except premium load up to the target premium.  This is necessary so that a common discount factor "R" can be used against all expenses.  This version includes the ability to remove COIs from the calculation.Š ŠModification log:Š5/12/2011 - PAC013 calcType - BT - Moved calcType functions into CalcType modelŠ02/07/2011 - pA Regression CMC updates for Face Solves and corridor usage in solvesŠ2/1/2011 - PAC013 calcType - BT - RestructureŠ1/26/2011 - PAC013 calctype CMC removed extra coverage and coverage option indexŠ1/19/2011 - PAC013 calcType - BT - RestructureŠ1/12/2011 - PAC013 calcType - BT - RestructureŠ9/16/2010 - PAC013 calcType - BT - remove calcType parm since can use vectorSearchCriteria to get calcType fromŠ8/11/2010 - PAC013 calcType - BT - Change order of COV CovOption COI Rate parmsŠ7/2/2010 - PAC013 calcType - BT - Initially adding calcType parmŠ03/04/2010 pA Performance Intial Calculation
53b81d8c -2 -2
Description:  Returns an amount that reflects the cost of insurance charge under death benefit option C for the premium component of the death benefit.  Adjusts for negative NAR due to corridor factors of 1.Š ŠModification log:Š02/07/2011 - pA Regression CMC updates for Face Solves and corridor usage in solvesŠ9/16/2010 - PAC013 calcType - BT - Remove calcType where SearchCriteria is usedŠ7/2/2010 - PAC013 calcType - BT - Initially adding calcType parmŠ06/16/2010 pA Regression Testing Intial CalculationŠ
784be161 -2 -2
Description:   Annual calculation for the option 3 adjusment.  This is used when the policy is either in corridor on not in corridor for a full year.Š ŠModification log:Š02/07/2011 - pA Regression CMC updates for Face Solves and corridor usage in solvesŠ9/16/2010 - PAC013 calcType - BT - Remove calcType where SearchCriteria is usedŠ7/2/2010 - PAC013 calcType - BT - Initially adding calcType parmŠ06/16/2010 pA Regression Testing Intial Calculation
3c8a32a6 -2 -2
Description:  Returns an amount that reflects the cost of insurance charge under death benefit option C for the premium component of the death benefit.Š ŠModification log:Š02/07/2011 - pA Regression CMC updates for Face Solves and corridor usage in solvesŠ2/1/2011 - PAC013 calcType - BT - RestructureŠ1/26/2011 - PAC013 calctype CMC removed extra coverage and coverage option indexŠ1/12/2011 - PAC013 calcType - BT - RestructureŠ9/16/2010 - PAC013 calcType - BT - remove calcType parm since can use vectorSearchCriteria to get calcType fromŠ8/11/2010 - PAC013 calcType - BT - Change order of COV CovOption COI Rate parmsŠ7/2/2010 - PAC013 calcType - BT - Initially adding calcType parmŠ06/16/2010 pA Regression Testing Intial Calculation
3f184711 -2 -2
Description:  Monthly calculation for the option 3 adjusment.  This is used in the year in which the policy enters or leaves corridor.Š ŠModification log:Š2/1/2011 - PAC013 calcType - BT - RestructureŠ9/16/2010 - PAC013 calcType - BT - Remove calcType where SearchCriteria is usedŠ7/2/2010 - PAC013 calcType - BT - Initially adding calcType parmŠ06/16/2010 pA Regression Testing Intial Calculation
333349ae -2 -2
Description:  switches between the adjustment factor using corrior or not using corridorŠ ŠModification log:Š02/07/2011 - pA Regression CMC updates for Face Solves and corridor usage in solves
54d69611 -2 -2
Description:  The adjustment applies all charges except premium load up to the target premium.  This is necessary so that a common discount factor "R" can be used against all expenses.  This version includes the ability to remove COIs from the calculation.Š ŠModification log:Š5/12/2011 - PAC013 calcType - BT - Moved calcType functions into CalcType modelŠ9/16/2010 - PAC013 calcType - BT - remove calcType parm since can use vectorSearchCriteria to get calcType fromŠ8/11/2010 - PAC013 calcType - BT - Change order of COV CovOption COI Rate parmsŠ7/2/2010 - PAC013 calcType - BT - Initially adding calcType parmŠ03/08/2010 pA Performance clean up for death benefit divisorŠ03/04/2010 pA Performance Intial Calculation
6acb85de -2 -2
Description:  switches between the adjustment factor using corrior or not using corridorŠ ŠModification log:Š02/07/2011 - pA Regression CMC updates for Face Solves and corridor usage in solves
62a00985 -2 -2
Description:  Present value R factor.Š‰ŠR factor= 1 / ( ( 1 + q) * (1 + i) ) for option AŠ‰1 /  (1 +i) for option BŠwhere q is monthly COI per $1, and i is monthly interest rateŠ ŠR factor= 1 / ( ( 1 + q) * (1 + i) ) for option A and CŠ‰1 /  (1 +i+iq) for option BŠwhere q is monthly COI per $1, and i is monthly interest rateŠ ŠWith waiver of monthly deductionŠR factor= 1 / ( ( 1 + i) * (1 + q+qw) ) for option A and CŠ‰1 /  (1 +i+iq+iqw) for option BŠ ŠModification Log:Š11/30/2012 PAC029 ITR JL - The COI rate used in the R factor is based on the coverage index for which the CV provides partial funding throughout that year. In the case of non base coverages (e.g. ITR) this COI rate may vary from the Base COI rate. The cov index needed is passed in the corridor indicator parm.Š5/12/2011 - PAC013 calcType - BT - Moved calcType functions into CalcType modelŠ9/16/2010 - PAC013 calcType - BT - remove calcType parm since can use vectorSearchCriteria to get calcType fromŠ8/11/2010 - PAC013 calcType - BT - Change order of COV CovOption COI Rate parmsŠ7/2/2010 - PAC013 calcType - BT - Initially adding calcType parmŠ03/08/2010 pA Performance clean up for death benefit divisorŠ03/04/2010 pA Performance additional ability to remove the COIs from the R calculation when necessary.
8963a86 -2 -2
Description:  Present value R factor.Š‰ŠR factor= 1 / ( ( 1 + q) * (1 + i) ) for option AŠ‰1 /  (1 +i) for option BŠwhere q is monthly COI per $1, and i is monthly interest rateŠ ŠR factor= 1 / ( ( 1 + q) * (1 + i) ) for option A and CŠ‰1 /  (1 +i+iq) for option BŠwhere q is monthly COI per $1, and i is monthly interest rateŠ ŠWith waiver of monthly deductionŠR factor= 1 / ( ( 1 + i) * (1 + q+qw) ) for option A and CŠ‰1 /  (1 +i+iq+iqw) for option BŠ ŠModification Log:Š5/12/2011 - PAC013 calcType - BT - Moved calcType functions into CalcType modelŠ9/16/2010 - PAC013 calcType - BT - remove calcType parm since can use vectorSearchCriteria to get calcType fromŠ8/11/2010 - PAC013 calcType - BT - Change order of COV CovOption COI Rate parmsŠ7/2/2010 - PAC013 calcType - BT - Initially adding calcType parmŠ03/08/2010 pA Performance clean up for death benefit divisorŠ03/04/2010 pA Performance additional ability to remove the COIs from the R calculation when necessary.
1affb042 -2 -2
ŠModification Log:Š5/12/2011 - PAC013 calcType - BT - Moved calcType functions into CalcType model
5ab1f9fd -2 -2
ŠModification Log:Š5/12/2011 - PAC013 calcType - BT - Moved calcType functions into CalcType model
66c31642 -2 -2
Description: Returns the Coverage Index of the NAR cov to be used for the COI rate in the R-factor. When non-base coverages (e.g. ITR) are added onto a policy, the COI rate may needed here may differ from the Base COI (e.g. when the CV is sufficient such that the NAR reduces the ITR cov in a FIFO set-up).Š ŠModification Log:Š11/30/2012 PAC029 ITR JL - Initial Rule
6375adf3 -2 -2
Description: Recursive function for "Solve COI Cov for R Factor"Š ŠModification Log:Š11/30/2012 PAC029 ITR JL - Initial Rule
77b46792 -2 -2
Description: Returns the current CovIdx if that cov is a NAR cov; else looks back-wards and returns the first NAR cov found.Š ŠModification Log:Š11/30/2012 PAC029 ITR JL - Initial Rule
3192babe -2 -2
Description: Total NAR DB per cov. Used to determine which Coverage is being partially funded by the CV in a LIFO set-up.Š ŠModification Log:Š11/30/2012 PAC029 ITR JL - Initial Rule
73fafef -2 -2
Description: Checks whether the COI rate used in the R-factor changes in the current year. If so, returns TRUE (and the solve uses a monthly accumulation); else returns FALSE (and the solve uses an annual accumulation).Š ŠModification Log:Š11/30/2012 PAC029 ITR JL - Initial Rule
5035a592 -2 -2
Description: Coverage which the R factor uses for the COI rate at the End of the previous year.Š ŠModification Log:Š11/30/2012 PAC029 ITR JL - Initial Rule
31f01d83 -2 -2
Description: Coverage which the R factor uses for the COI rate at the End of the current year.Š ŠModification Log:Š11/30/2012 PAC029 ITR JL - Initial Rule
69ade4d0 -2 -2
Description:  Returns an initial guess for face amount solves.Š ŠModification Log:Š9/16/2010 - PAC013 calcType - BT - Remove calcType where SearchCriteria is usedŠ7/2/2010 - PAC013 calcType - BT - Initially adding calcType parmŠ03/14/2008 CMC ILLUS001 pA Phase 2  Updated to add vectorSolveParms as a parameter.  This is used to pass death benefit option to the coi functions.
3d48f873 -2 -2
Description:  This is the present value of all charges that are not per unit or face amount basedŠ ŠModification Log:Š9/16/2010 - PAC013 calcType - BT - Remove calcType where SearchCriteria is usedŠ7/2/2010 - PAC013 calcType - BT - Initially adding calcType parmŠ03/14/2008 CMC ILLUS001 pA Phase 2  Updated to add vectorSolveParms as a parameter.  This is used to pass death benefit option to the coi functions.
3666db69 -2 -2
Description:  Returns the present value of charges less per unit and face amount based charges for a given policy year.Š ŠModification Log:Š1/12/2011 - PAC013 calcType - BT - RestructureŠ9/16/2010 - PAC013 calcType - BT - remove calcType parm since can use vectorSearchCriteria to get calcType fromŠ7/2/2010 - PAC013 calcType - BT - Initially adding calcType parmŠ03/14/2008 CMC ILLUS001 pA Phase 2  Updated to add vectorSolveParms as a parameter.  This is used to pass death benefit option to the coi functions.
d1225c5 -2 -2
ŠModification Log:Š1/12/2011 - PAC013 calcType - BT - Restructure
14b1342b -2 -2
ŠModification Log:Š5/20/2011 wmA-J CMC Premium Load Charges enhancement for Premium Taxes (added feeType parm to higher level functions)Š5/12/2011 - PAC013 calcType - BT - Moved calcType functions into CalcType modelŠ2/1/2011 - PAC013 calcType - BT - RestructureŠ1/26/2011 - PAC013 calctype CMC removed extra coverage and coverage option indexŠ1/12/2011 - PAC013 calcType - BT - Restructure
30d565f8 -2 -2
ŠModification Log:Š5/20/2011 wmA-J CMC Premium Load Charges enhancement for Premium Taxes (added feeType parm to higher level functions)Š5/12/2011 - PAC013 calcType - BT - Moved calcType functions into CalcType modelŠ2/1/2011 - PAC013 calcType - BT - RestructureŠ1/26/2011 - PAC013 calctype CMC removed extra coverage and coverage option indexŠ1/12/2011 - PAC013 calcType - BT - Restructure
22a047b1 -2 -2
Description:  Returns the charges less per unit and face amount based charges for a given policy year.Š ŠModification Log:Š5/12/2011 - PAC013 calcType - BT - Moved calcType functions into CalcType modelŠ2/1/2011 - PAC013 calcType - BT - RestructureŠ1/26/2011 - PAC013 calctype CMC removed extra coverage and coverage option indexŠ1/12/2011 - PAC013 calcType - BT - RestructureŠ9/16/2010 - PAC013 calcType - BT - remove calcType parm since can use vectorSearchCriteria to get calcType fromŠ9/7/2010 - PAC021 - rm - Replaced coverageIndex=0 with standard function 'Std BaseCov Index'(calcType)Š7/2/2010 - PAC013 calcType - BT - Initially adding calcType parmŠ03/14/2008 CMC ILLUS001 pA Phase 2  Updated to add vectorSolveParms as a parameter.  This is used to pass death benefit option to the coi functions.
30fbabbd -2 -2
Description:  Returns the expense charges less per unit and face amount based charges for a given policy year.Š ŠModification Log:Š5/12/2011 - PAC013 calcType - BT - Moved calcType functions into CalcType modelŠ1/26/2011 - PAC013 calctype CMC removed extra coverage and coverage option indexŠ1/12/2011 - PAC013 calcType - BT - RestructureŠ06/28/2010 wmA_ENH992_merge JL Merge wmA changes to StagingŠ03/14/2008 CMC ILLUS001 pA Phase 2  Updated to add vectorSolveParms as a parameter.  This is used to pass death benefit option to the coi functions.
790d5361 -2 -2
Description:  Calculates the expense charges less per unit and face amount based charges for a given policy year.Š ŠModification Log:Š1/12/2011 - PAC013 calcType - BT - RestructureŠ03/14/2008 CMC ILLUS001 pA Phase 2  Updated to add vectorSolveParms as a parameter.  This is used to pass death benefit option to the coi functions.
32f032c8 -2 -2
Description:  Calculates the expense charges less per unit and face amount based charges for a given policy year for Shadow AccountsŠ ŠModification Log:Š1/12/2011 - PAC013 calcType - BT - RestructureŠ7/2/2010 - PAC013 calcType - BT - Initially adding calcType parmŠ06/28/2010 wmA_ENH992_merge JL Merge wmA changes to Staging
5174835 -2 -2
Description:  Present value of all per unit and face amount charges on a per dollar basisŠ ŠModification Log:Š7/2/2010 - PAC013 calcType - BT - Initially adding calcType parmŠ03/14/2008 CMC ILLUS001 pA Phase 2  Updated to add vectorSolveParms as a parameter.  This is used to pass death benefit option to the coi functions.
a58940 -2 -2
Description:  Present value of all per unit and face amount charges on a per dollar basis for a given year.Š ŠModification Log:Š9/16/2010 - PAC013 calcType - BT - Remove calcType where SearchCriteria is usedŠ7/2/2010 - PAC013 calcType - BT - Initially adding calcType parmŠ03/14/2008 CMC ILLUS001 pA Phase 2  Updated to add vectorSolveParms as a parameter.  This is used to pass death benefit option to the coi functions.
7557f2c1 -2 -2
Description:  All per unit and face amount charges on a per dollar basis for a given year.Š ŠModification Log:Š5/12/2011 - PAC013 calcType - BT - Moved calcType functions into CalcType modelŠ2/1/2011 - PAC013 calcType - BT - RestructureŠ9/16/2010 - PAC013 calcType - BT - remove calcType parm since can use vectorSearchCriteria to get calcType fromŠ7/2/2010 - PAC013 calcType - BT - Initially adding calcType parmŠ03/14/2008 CMC ILLUS001 pA Phase 2  Updated to add vectorSolveParms as a parameter.  This is used to pass death benefit option to the coi functions.
4415c497 -2 -2
Description:  Monthly expense chargees based on face amount returned on a per dollar basis for a given year.Š ŠModification Log:Š03/14/2008 CMC ILLUS001 pA Phase 2  Updated to add vectorSolveParms as a parameter.  This is used to pass death benefit option to the coi functions.
8129194 -2 -2
Description:  Calculation of monthly expense chargees based on face amount returned on a per dollar basis for a given year.Š ŠModification Log:Š1/26/2011 - PAC013 calctype CMC removed extra coverage and coverage option indexŠ1/12/2011 - PAC013 calcType - BT - RestructureŠ7/2/2010 - PAC013 calcType - BT - Initially adding calcType parmŠ03/14/2008 CMC ILLUS001 pA Phase 2  Updated to add vectorSolveParms as a parameter.  This is used to pass death benefit option to the coi functions.
4e13f05c -2 -2
Description:  Monthly COI charges  returned on a per dollar basis for a given year.Š ŠModification Log:Š5/12/2011 - PAC013 calcType - BT - Moved calcType functions into CalcType modelŠ2/1/2011 - PAC013 calcType - BT - RestructureŠ1/26/2011 - PAC013 calctype CMC removed extra coverage and coverage option indexŠ1/12/2011 - PAC013 calcType - BT - RestructureŠ9/16/2010 - PAC013 calcType - BT - remove calcType parm since can use vectorSearchCriteria to get calcType fromŠ7/2/2010 - PAC013 calcType - BT - Initially adding calcType parmŠ03/14/2008 CMC ILLUS001 pA Phase 2  Updated to add vectorSolveParms as a parameter.  This is used to pass death benefit option to the coi functions.
ad5a770 -2 -2
Description:  Present value of the target cash value for a face amount solve.Š ŠModification Log:Š9/16/2010 - PAC013 calcType - BT - Remove calcType where SearchCriteria is usedŠ7/2/2010 - PAC013 calcType - BT - Initially adding calcType parmŠ03/14/2008 CMC ILLUS001 pA Phase 2  Updated to add vectorSolveParms as a parameter.  This is used to pass death benefit option to the coi functions.
3bc6c5cb -2 -2
Description:  Target premium guess based on Sum of Charges method for face solves.Š ŠModification Log:Š5/12/2011 - PAC013 calcType - BT - Moved calcType functions into CalcType modelŠ2/1/2011 - PAC013 calcType - BT - RestructureŠ1/26/2011 - PAC013 calctype CMC removed extra coverage and coverage option indexŠ1/12/2011 - PAC013 calcType - BT - RestructureŠ9/16/2010 - PAC013 calcType - BT - Remove calcType where SearchCriteria is usedŠ7/2/2010 - PAC013 calcType - BT - Initially adding calcType parmŠ03/14/2008 ILLUS001 pA Phase 2  Initial Calcs.
45b64cdf -2 -2
Description:  Target premium guess based on Rate file method for face solves.Š ŠModification Log:Š5/12/2011 - PAC013 calcType - BT - Moved calcType functions into CalcType modelŠ2/1/2011 - PAC013 calcType - BT - RestructureŠ1/26/2011 - PAC013 calctype CMC removed extra coverage and coverage option indexŠ1/12/2011 - PAC013 calcType - BT - RestructureŠ9/16/2010 - PAC013 calcType - BT - remove calcType parm since can use vectorSearchCriteria to get calcType fromŠ9/7/2010 - PAC021 - rm - Replaced coverageIndex=0 with standard function 'Std BaseCov Index'(calcType)Š7/2/2010 - PAC013 calcType - BT - Initially adding calcType parmŠ03/14/2008 ILLUS001 pA Phase 2  Initial Calcs.
7ec41d87 -2 -2
Description:  Target premium guess based on Rate file method for face solves.Š ŠModification Log:Š07/10/2013 PA1401-26 KC added yearIndex parmŠ5/12/2011 - PAC013 calcType - BT - Moved calcType functions into CalcType modelŠ2/1/2011 - PAC013 calcType - BT - RestructureŠ1/26/2011 - PAC013 calctype CMC removed extra coverage and coverage option indexŠ1/12/2011 - PAC013 calcType - BT - RestructureŠ9/16/2010 - PAC013 calcType - BT - remove calcType parm since can use vectorSearchCriteria to get calcType fromŠ9/7/2010 - PAC021 - rm - Replaced coverageIndex=0 with standard function 'Std BaseCov Index'(calcType)Š7/2/2010 - PAC013 calcType - BT - Initially adding calcType parmŠ03/14/2008 ILLUS001 pA Phase 2  Initial Calcs.
35703c73 -2 -2
Description:  Deterimines the Target premium type for the calculation.Š ŠModification Log:Š11/01/2012 wmA-J 1301 Release 2 Sprint 6 CMC updated error messageŠ5/12/2011 - PAC013 calcType - BT - Moved calcType functions into CalcType modelŠ2/1/2011 - PAC013 calcType - BT - RestructureŠ1/26/2011 - PAC013 calctype CMC removed extra coverage and coverage option indexŠ1/12/2011 - PAC013 calcType - BT - RestructureŠ9/16/2010 - PAC013 calcType - BT - remove calcType parm since can use vectorSearchCriteria to get calcType fromŠ7/2/2010 - PAC013 calcType - BT - Initially adding calcType parmŠ03/14/2008 ILLUS001 pA Phase 2  Initial Calcs.
1f8b79c4 -2 -2
Description:  Calculations the rider target premium to be used for initial face amount guess.  This is used for any premium loads below the target amount.Š ŠModification Log:Š5/12/2011 - PAC013 calcType - BT - Moved calcType functions into CalcType modelŠ2/1/2011 - PAC013 calcType - BT - RestructureŠ1/26/2011 - PAC013 calctype CMC removed extra coverage and coverage option indexŠ1/12/2011 - PAC013 calcType - BT - RestructureŠ9/16/2010 - PAC013 calcType - BT - remove calcType parm since can use vectorSearchCriteria to get calcType fromŠ7/2/2010 - PAC013 calcType - BT - Initially adding calcType parmŠ03/14/2008 ILLUS001 pA Phase 2  Initial Calcs.
4a33a897 -2 -2
Description:  Calculations the rider target premium to be used for initial face amount guess.  For the Sum of Charges Method.Š ŠModification Log:Š5/20/2011 wmA-J CMC Premium Load Charges enhancement for Premium Taxes (added feeType parm to higher level functions)Š5/12/2011 - PAC013 calcType - BT - Moved calcType functions into CalcType modelŠ2/1/2011 - PAC013 calcType - BT - RestructureŠ1/12/2011 - PAC013 calcType - BT - RestructureŠ9/16/2010 - PAC013 calcType - BT - Remove calcType where SearchCriteria is usedŠ7/2/2010 - PAC013 calcType - BT - Initially adding calcType parmŠ03/14/2008 ILLUS001 pA Phase 2  Initial Calcs.
4b2664ca -2 -2
Description:  Calculations the rider target premium to be used for initial face amount guess.  For the Present Value Method.Š ŠModification Log:Š2/1/2011 - PAC013 calcType - BT - RestructureŠ1/12/2011 - PAC013 calcType - BT - RestructureŠ9/16/2010 - PAC013 calcType - BT - Remove calcType where SearchCriteria is usedŠ7/2/2010 - PAC013 calcType - BT - Initially adding calcType parmŠ03/14/2008 ILLUS001 pA Phase 2  Initial Calcs.
35922381 -2 -2
Description:  Calculations the rider target premium to be used for initial face amount guess.  For the Rate File Method.Š ŠModification Log:Š2/1/2011 - PAC013 calcType - BT - RestructureŠ1/12/2011 - PAC013 calcType - BT - RestructureŠ9/16/2010 - PAC013 calcType - BT - Remove calcType where SearchCriteria is usedŠ7/2/2010 - PAC013 calcType - BT - Initially adding calcType parmŠ03/14/2008 ILLUS001 pA Phase 2  Initial Calcs.
521b0fa9 -2 -2
Description:  Calculations the base target premium to be used for initial face amount guess.  This is used for any premium loads below the target amount.Š ŠModification Log:Š5/12/2011 - PAC013 calcType - BT - Moved calcType functions into CalcType modelŠ2/1/2011 - PAC013 calcType - BT - RestructureŠ1/26/2011 - PAC013 calctype CMC removed extra coverage and coverage option indexŠ1/12/2011 - PAC013 calcType - BT - RestructureŠ9/16/2010 - PAC013 calcType - BT - remove calcType parm since can use vectorSearchCriteria to get calcType fromŠ7/2/2010 - PAC013 calcType - BT - Initially adding calcType parmŠ03/14/2008 ILLUS001 pA Phase 2  Initial Calcs.
2e03613d -2 -2
Description:  Sum of the Calculations of  the base target premium to be used for initial face amount guess.  For the Present Value Method.Š ŠModification Log:Š5/12/2011 - PAC013 calcType - BT - Moved calcType functions into CalcType modelŠ2/1/2011 - PAC013 calcType - BT - RestructureŠ1/12/2011 - PAC013 calcType - BT - RestructureŠ9/16/2010 - PAC013 calcType - BT - Remove calcType where SearchCriteria is usedŠ7/2/2010 - PAC013 calcType - BT - Initially adding calcType parmŠ03/14/2008 ILLUS001 pA Phase 2  Initial Calcs.
ffe715 -2 -2
Description:  Calculations of  the base target premium to be used for initial face amount guess.  For the Present Value Method.Š ŠModification Log:Š5/20/2011 wmA-J CMC Premium Load Charges enhancement for Premium Taxes (added feeType parm to higher level functions)Š5/12/2011 - PAC013 calcType - BT - Moved calcType functions into CalcType modelŠ2/1/2011 - PAC013 calcType - BT - RestructureŠ1/12/2011 - PAC013 calcType - BT - RestructureŠ9/16/2010 - PAC013 calcType - BT - remove calcType parm since can use vectorSearchCriteria to get calcType fromŠ7/2/2010 - PAC013 calcType - BT - Initially adding calcType parmŠ03/14/2008 ILLUS001 pA Phase 2  Initial Calcs.
2283bd86 -2 -2
Description:  Calculations of  the base target premium to be used for initial face amount guess.  For the Present Value Method.Š ŠModification Log:Š07/10/2013 PA1401-26 KC added yearIndex parmŠ5/20/2011 wmA-J CMC Premium Load Charges enhancement for Premium Taxes (added feeType parm to higher level functions)Š5/12/2011 - PAC013 calcType - BT - Moved calcType functions into CalcType modelŠ2/1/2011 - PAC013 calcType - BT - RestructureŠ1/12/2011 - PAC013 calcType - BT - RestructureŠ9/16/2010 - PAC013 calcType - BT - remove calcType parm since can use vectorSearchCriteria to get calcType fromŠ7/2/2010 - PAC013 calcType - BT - Initially adding calcType parmŠ03/14/2008 ILLUS001 pA Phase 2  Initial Calcs.
217a409e -2 -2
Description:  Sum of the Calculations of  the base target premium to be used for initial face amount guess.  For the Rate file Method.Š ŠModification Log:Š5/12/2011 - PAC013 calcType - BT - Moved calcType functions into CalcType modelŠ2/1/2011 - PAC013 calcType - BT - RestructureŠ1/12/2011 - PAC013 calcType - BT - RestructureŠ9/16/2010 - PAC013 calcType - BT - Remove calcType where SearchCriteria is usedŠ7/2/2010 - PAC013 calcType - BT - Initially adding calcType parmŠ03/14/2008 ILLUS001 pA Phase 2  Initial Calcs.
667f4e79 -2 -2
Description:  Calculations of  the base target premium to be used for initial face amount guess.  For the Rate file Method.Š ŠModification Log:Š5/20/2011 wmA-J CMC Premium Load Charges enhancement for Premium Taxes (added feeType parm to higher level functions)Š5/12/2011 - PAC013 calcType - BT - Moved calcType functions into CalcType modelŠ2/1/2011 - PAC013 calcType - BT - RestructureŠ1/12/2011 - PAC013 calcType - BT - RestructureŠ9/16/2010 - PAC013 calcType - BT - remove calcType parm since can use vectorSearchCriteria to get calcType fromŠ7/2/2010 - PAC013 calcType - BT - Initially adding calcType parmŠ03/14/2008 ILLUS001 pA Phase 2  Initial Calcs.
2d922c43 -2 -2
Description:  Calculations of  the base target premium to be used for initial face amount guess.  For the Rate file Method.Š ŠModification Log:Š07/10/2013 PA1401-26 KC added yearIndex parmŠ5/20/2011 wmA-J CMC Premium Load Charges enhancement for Premium Taxes (added feeType parm to higher level functions)Š5/12/2011 - PAC013 calcType - BT - Moved calcType functions into CalcType modelŠ2/1/2011 - PAC013 calcType - BT - RestructureŠ1/12/2011 - PAC013 calcType - BT - RestructureŠ9/16/2010 - PAC013 calcType - BT - remove calcType parm since can use vectorSearchCriteria to get calcType fromŠ7/2/2010 - PAC013 calcType - BT - Initially adding calcType parmŠ03/14/2008 ILLUS001 pA Phase 2  Initial Calcs.
700e35cd -2 -2
Description:  Sum of the Calculations of  the base target premium to be used for initial face amount guess.  For the Sum of Charges Method.Š ŠModification Log:Š5/20/2011 wmA-J CMC Premium Load Charges enhancement for Premium Taxes (added feeType parm to higher level functions)Š5/12/2011 - PAC013 calcType - BT - Moved calcType functions into CalcType modelŠ2/1/2011 - PAC013 calcType - BT - RestructureŠ1/12/2011 - PAC013 calcType - BT - RestructureŠ9/16/2010 - PAC013 calcType - BT - remove calcType parm since can use vectorSearchCriteria to get calcType fromŠ7/2/2010 - PAC013 calcType - BT - Initially adding calcType parmŠ03/14/2008 ILLUS001 pA Phase 2  Initial Calcs.
662fe2fc -2 -2
Description: This function is used by the solve function to have a function so solve forŠ ŠModification Log:Š1/12/2011 - PAC013 calcType - BT - RestructureŠ10/19/2009 - wdp - CSC Initial function
9610063 -2 -2
Description: Creates a vector used by the solve function.Š ŠModification Log:Š5/12/2011 - PAC013 calcType - BT - Moved calcType functions into CalcType modelŠ2/1/2011 - PAC013 calcType - BT - RestructureŠ10/19/2009 - wdp - CSC Initial function
37fe1eb2 -2 -2
Description: This function is used by the solve function to have a function so solve for. Specifically for face amount solves.Š ŠModification Log:Š02/07/2011 - pA Regression CMC updates for Face Solves and corridor usage in solvesŠ
26585a8 -2 -2
Description: Returns the Death Benefit Option for  the policy.  This checks to see if the death benefit option is in the vector will be using input functions.Š ŠModification Log:Š7/2/2010 - PAC013 calcType - BT - Initially adding calcType parmŠ03/14/2008 CMC ILLUS001 pA Phase 2  Updated to add vectorSolveParms as a parameter used to pass death benefit option
7dd2eff7 -2 -2
Description:  Next guess cash value for regula falsi methodŠ ŠModification Log:Š02/07/2011 - pA Regression CMC updates for Face Solves and corridor usage in solvesŠ
77acf2e2 -2 -2
Description:  Next guess cash value for regula falsi methodŠ ŠModification Log:Š02/07/2011 - pA Regression CMC updates for Face Solves and corridor usage in solvesŠ1/26/2011 - PAC013 calctype CMC removed extra coverage and coverage option index
4353a7da -2 -2
Description: Face Amount for base coverage & IncreasesŠ ŠModification Log:Š11/30/2012 PAC029 ITR JL - Include all NAR covs, not just base & base increaseŠ7/2/2010 - PAC013 calcType - BT - Initially adding calcType parmŠ06/15/2010 pA RegTest JL Initial Calculation
3b02b62f -2 -2
Description: Function checks whether a admin charge is applicable based on policy durationŠ ŠModification Log:Š5/12/2011 - PAC013 calcType - BT - Moved calcType functions into CalcType modelŠ2/1/2011 - PAC013 calcType - BT - RestructureŠ9/16/2010 - PAC013 calcType - BT - remove calcType parm since can use vectorSearchCriteria to get calcType fromŠ10/31/2007 CSC Initial Calculation/Rule
18306bb6 -2 -2
Description:  Fee payment modeŠ ŠModification log:Š06/28/2010 wmA_ENH992_merge JL Merge wmA changes to StagingŠ
24e6a70 -2 -2
Internal case takes >3 min to run. Export to UTV to Test.
24e6d00 -2 -2
Internal case takes >3 min to run. Export to UTV to Test.
;Offset=00000000
