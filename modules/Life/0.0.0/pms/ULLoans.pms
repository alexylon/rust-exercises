;1	08.12.2016 13:29:34	jlawrie2	
X0 3f4048 0 3f46b8 0 0 0 0

X8 3f46b8 3f4048 0 3f4a78 0 0 2
ULLoan Base Balance At Time(loanIndex; pointInTimeDate)
ULLoan Base Balance At Time("C";0;"1/1/2006")
1000
INPUT Policy number of FinancialActivity
0
INPUT Policy Loan LoanOriginationDate
1/1/2007
INPUT Calling Program

INPUT Calling System
I1
Input TransEffDate
01/01/2006
INPUT Policy FinancialActivity FinEffDate
1/1/2006
INPUT Policy Loan LoanAmt
1000
X0 3f4a78 3f4048 3f4b38 19b8c30 0 0 0
-- Internal Test Cases --
X0 3f4b38 3f4a78 0 19a10b8 0 0 0
-- OUTPUTS --
X0 19a10b8 3f4a78 19a1f68 0 0 0 0
-- FUNCTIONS --
X0 19a1f68 19a10b8 0 3f6008 0 0 0
-- Current Loan Balance --
X0 3f6008 19a10b8 3f60a8 3fe040 0 0 0
-- Projected Loan Balance --
X60 3f60a8 3f6008 3f63b0 0 0 0 2
ULLoan Total Projected Balance(rateAssumption; yearIndex; vectorWLProj)
ULLoan Total Projected Balance("C"; 2; v_(400;700;1000;0;0))
0
INPUT Policy Loan LoanIntTiming
1
INPUT Calling Program

INPUT Policy Loan LoanPaymentAmt[1]
100
INPUT Policy Loan LoanPaymentMode
1
INPUT Policy Loan LoanInterestRate
5
INPUT Policy Life DivType
0
INPUT Policy ProductCode
WL1PA
INPUT Policy EffDate
01/01/2006
INPUT Calling System
I1
INPUT Policy CarrierCode
00
INPUT Policy ProductVersionCode

INPUT Policy Jurisdiction
1000
INPUT Policy number of Coverage
1
INPUT Policy Coverage ProductCode
WL1PA
Input TransEffDate
01/01/2006
INPUT Policy LifeParticipant IssueAge
35
INPUT Policy LifeParticipant IssueGender
1
INPUT Policy LifeParticipant UnderwritingClass
1
INPUT Policy LifeParticipant TobaccoPremiumBasis
1
INPUT Policy Coverage BandCode
0
INPUT Policy Coverage LifeCovTypeCode
1
INPUT Policy Coverage CurrentNumberOfUnits
1000
INPUT Policy Coverage IndicatorCode
1
INPUT Policy Life CurrLoanIntRate
5
INPUT Policy Number of Loan
2
INPUT Policy Loan LoanBalance
1000
INPUT Policy Loan LoanPaymentAmt[2]
100
INPUT Policy Loan LoanInterestRate[1]
5
INPUT Policy Loan LoanPaymentMode[1]
1
INPUT Policy Loan LoanAmt
1000
INPUT Policy Loan LoanAmt[1]
1000
INPUT Message Language
English
INPUT Policy Loan LoanOriginationDate
01/01/2006
INPUT Illus LoanAmt[1]
1000
INPUT Illus LoanAmt[2]
300
INPUT Illus LoanRepaymentAmt[0;1]
100
INPUT Illus DivType[1]
161
INPUT Illus FaceAmtDesignType
1000500001
INPUT Policy Coverage CurrentAmt
100000
INPUT Illus LoanRepaymentAmt[0;2]
100
INPUT Illus DivType[2]
161
INPUT Policy Coverage LifeCovStatus
1
INPUT Policy Coverage RequestedEffDur
1
INPUT Policy Coverage RequestedMaturityDur
20
INPUT Policy Coverage ProductVersionCode
1
INPUT Policy Coverage EffDate
01/01/2006
INPUT Invest Rate Type
11
INPUT Invest Rate Sub Type
1
INPUT Policy LifeParticipant TempTableRating
1
INPUT Policy LifeParticipant PermTableRating
1
INPUT Policy Number of LifeParticipant
1
INPUT Policy LifeParticipant PermFlatExtraAmount
0
INPUT Policy LifeParticipant TempFlatExtraAmount
0
INPUT Illus WithdrawalDesignType
1000500001
INPUT Policy LifeParticipant IssueAge[1]
35
INPUT Illus LoanRepaymentAmt[1;2]
100
INPUT Policy Loan LoanIntType
2
INPUT Policy Loan LoanOriginationDate[1]
01/01/2006
INPUT Policy Loan LoanPaymentAmt
100
X34 3f63b0 3f60a8 0 0 0 0 2
ULLoan Projected Balance(rateAssumption; yearIndex; loanIndex; vectorWLProj)
ULLoan Projected Balance("C"; 2; v_(400;700;1000;0))

INPUT Policy Loan LoanIntTiming
1
INPUT Calling Program

INPUT Policy Loan LoanPaymentAmt[1]
100
INPUT Policy Loan LoanPaymentMode
1
INPUT Policy Loan LoanInterestRate
5
INPUT Policy Life DivType
0
INPUT Policy ProductCode
UL1PA
INPUT Policy EffDate
01/01/2006
INPUT Calling System
I1
INPUT Policy CarrierCode
00
INPUT Policy ProductVersionCode

INPUT Policy Jurisdiction
1000
INPUT Policy number of Coverage
1
INPUT Policy Coverage ProductCode
WL1PA
Input TransEffDate
01/01/2006
INPUT Policy LifeParticipant IssueAge
35
INPUT Policy LifeParticipant IssueGender
1
INPUT Policy LifeParticipant UnderwritingClass
1
INPUT Policy LifeParticipant TobaccoPremiumBasis
1
INPUT Policy Coverage BandCode
0
INPUT Policy Coverage LifeCovTypeCode
1
INPUT Policy Coverage CurrentNumberOfUnits
1000
INPUT Policy Coverage IndicatorCode
1
INPUT Policy Life CurrLoanIntRate
5
INPUT Policy Number of Loan
1
INPUT Policy Loan LoanBalance
1000
INPUT Policy Loan LoanPaymentAmt[2]
100
INPUT Policy Loan LoanAmt
1000
INPUT Policy Loan LoanOriginationDate
01/01/2006
INPUT Policy Loan LoanIntType
2
INPUT Message Language
9
INPUT Illus LoanAmt[1]
1000
INPUT Policy Loan LoanPaymentAmt
100
X0 3fe040 19a10b8 3fdbd0 19a3e58 0 0 0
-- Current Maximum Loan Remaining --
X44 3fdbd0 3fe040 3fe650 19a3568 0 0 2
ULLoan Maximum Loan Amount
ULLoan Maximum Loan Amount("C")
28083.52
Input TransEffDate
01/01/2007
INPUT Calling Program

INPUT Policy number of Coverage
1
INPUT Policy Coverage IndicatorCode
1
INPUT Policy Coverage LifeCovStatus
1
INPUT Policy Coverage EffDate
01/01/2006
INPUT Policy Coverage TermDate
12/31/2999
INPUT Policy EffDate
01/01/2006
INPUT Policy Coverage CurrentNumberOfUnits
1000
INPUT Policy LifeParticipant IssueAge
35
INPUT Policy ProductCode
WL1PA
INPUT Calling System
I1
INPUT Policy CarrierCode
00
INPUT Policy ProductVersionCode

INPUT Policy Jurisdiction
1000
INPUT Policy Coverage ProductCode
WL1PA
INPUT Policy Coverage ProductVersionCode
1
INPUT Policy LifeParticipant IssueGender
1
INPUT Policy LifeParticipant UnderwritingClass
1
INPUT Policy LifeParticipant TobaccoPremiumBasis
1
INPUT Policy LifeParticipant TempTableRating
1
INPUT Policy LifeParticipant PermTableRating
1
INPUT Policy Number of LifeParticipant
1
INPUT Policy LifeParticipant PermFlatExtraAmount
0
INPUT Policy LifeParticipant TempFlatExtraAmount
0
INPUT Policy Number of ParAccumValues
0
INPUT Policy Life DivType
0
INPUT Policy Number of Loan
1
INPUT Policy Coverage BandCode
0
INPUT Policy Loan LoanType
2
INPUT Policy Loan LoanIntTiming
0
INPUT Policy Loan LoanOriginationDate
01/01/2007
INPUT Policy Loan LoanAmt
1000
INPUT Policy number of FinancialActivity
0
INPUT Policy LifeParticipant IssueAge[1]
35
INPUT Policy LifeParticipant IssueGender[1]
1
INPUT Policy LifeParticipant UnderwritingClass[1]
1
INPUT Policy LifeParticipant TobaccoPremiumBasis[1]
1
INPUT Policy Coverage BandCode[1]
0
INPUT Policy Loan LoanType[1]
2
INPUT Policy Life CashValueAmt
29136.02
INPUT Policy Loan LoanIntMethod
0
INPUT Message Language
English
X42 3fe650 3fdbd0 3ff940 0 0 0 2
ULLoan Min Balance Amount(typeAssumption)
ULLoan Min Balance Amount("C";8;1;"")
52.5
Input TransEffDate
01/01/2007
INPUT Calling Program

INPUT Policy number of Coverage
1
INPUT Policy Coverage IndicatorCode
1
INPUT Policy Coverage LifeCovStatus
1
INPUT Policy Coverage EffDate
01/01/2006
INPUT Policy Coverage TermDate
12/31/2999
INPUT Policy EffDate
01/01/2006
INPUT Policy Coverage CurrentNumberOfUnits
1000
INPUT Policy LifeParticipant IssueAge
35
INPUT Policy ProductCode
WL1PA
INPUT Calling System
I1
INPUT Policy CarrierCode
00
INPUT Policy ProductVersionCode

INPUT Policy Jurisdiction
1000
INPUT Policy Coverage ProductCode
WL1PA
INPUT Policy Coverage ProductVersionCode
1
INPUT Policy LifeParticipant IssueGender
1
INPUT Policy LifeParticipant UnderwritingClass
1
INPUT Policy LifeParticipant TobaccoPremiumBasis
1
INPUT Policy LifeParticipant TempTableRating
1
INPUT Policy LifeParticipant PermTableRating
1
INPUT Policy Number of LifeParticipant
1
INPUT Policy LifeParticipant PermFlatExtraAmount
0
INPUT Policy LifeParticipant TempFlatExtraAmount
0
INPUT Policy Number of ParAccumValues
0
INPUT Policy Life DivType
0
INPUT Policy Number of Loan
1
INPUT Policy Coverage BandCode
0
INPUT Policy Loan LoanType
2
INPUT Policy Loan LoanIntTiming
0
INPUT Policy Loan LoanOriginationDate
01/01/2007
INPUT Policy Loan LoanAmt
1000
INPUT Policy number of FinancialActivity
0
INPUT Policy LifeParticipant IssueAge[1]
35
INPUT Policy LifeParticipant IssueGender[1]
1
INPUT Policy LifeParticipant UnderwritingClass[1]
1
INPUT Policy LifeParticipant TobaccoPremiumBasis[1]
1
INPUT Policy Coverage BandCode[1]
0
INPUT Policy Loan LoanType[1]
2
INPUT Policy Loan LoanIntMethod
0
X37 3ff940 3fe650 0 19a26c8 0 0 2
ULLoan Surrender Value
ULLoan Surrender Value
30610.404
Input TransEffDate
01/01/2007
INPUT Calling Program

INPUT Policy number of Coverage
1
INPUT Policy Coverage IndicatorCode
1
INPUT Policy Coverage LifeCovStatus
1
INPUT Policy Coverage EffDate
01/01/2006
INPUT Policy Coverage TermDate
12/31/2999
INPUT Policy EffDate
01/01/2006
INPUT Policy Coverage CurrentNumberOfUnits
1000
INPUT Policy LifeParticipant IssueAge
35
INPUT Policy ProductCode
WL1PA
INPUT Calling System
I1
INPUT Policy CarrierCode
00
INPUT Policy ProductVersionCode

INPUT Policy Jurisdiction
1000
INPUT Policy Coverage ProductCode
UL1PA
INPUT Policy Coverage ProductVersionCode
1
INPUT Policy LifeParticipant IssueGender
1
INPUT Policy LifeParticipant UnderwritingClass
1
INPUT Policy LifeParticipant TobaccoPremiumBasis
1
INPUT Policy LifeParticipant TempTableRating
1
INPUT Policy LifeParticipant PermTableRating
1
INPUT Policy Number of LifeParticipant
1
INPUT Policy LifeParticipant PermFlatExtraAmount
0
INPUT Policy LifeParticipant TempFlatExtraAmount
0
INPUT Policy Number of ParAccumValues
0
INPUT Policy Life DivType
0
INPUT Policy Number of Loan
0
INPUT Policy Coverage BandCode
0
INPUT Policy Loan LoanType
2
INPUT Policy Loan LoanIntTiming
0
INPUT Policy Loan LoanOriginationDate
01/01/2006
INPUT Policy Loan LoanAmt
1000
INPUT Policy number of FinancialActivity
0
INPUT Policy Life CashValueAmt
30610.404
INPUT Policy Life SurrenderChargeAmt
0
X35 19a26c8 3fe650 0 0 0 0 2
ULLoan Interest Deduction(startDate; endDate)
ULLoan Interest Deduction("C";"01/01/2006"; "01/01/2007")
0
Input TransEffDate
01/01/2007
INPUT Calling Program

INPUT Policy number of Coverage
1
INPUT Policy Coverage IndicatorCode
1
INPUT Policy Coverage LifeCovStatus
1
INPUT Policy Coverage EffDate
01/01/2006
INPUT Policy Coverage TermDate
12/31/2999
INPUT Policy EffDate
01/01/2006
INPUT Policy Coverage CurrentNumberOfUnits
1000
INPUT Policy LifeParticipant IssueAge
35
INPUT Policy ProductCode
WL1PA
INPUT Calling System
I1
INPUT Policy CarrierCode
00
INPUT Policy ProductVersionCode

INPUT Policy Jurisdiction
1000
INPUT Policy Coverage ProductCode
UL1PA
INPUT Policy Coverage ProductVersionCode
1
INPUT Policy LifeParticipant IssueGender
1
INPUT Policy LifeParticipant UnderwritingClass
1
INPUT Policy LifeParticipant TobaccoPremiumBasis
1
INPUT Policy LifeParticipant TempTableRating
1
INPUT Policy LifeParticipant PermTableRating
1
INPUT Policy Number of LifeParticipant
1
INPUT Policy LifeParticipant PermFlatExtraAmount
0
INPUT Policy LifeParticipant TempFlatExtraAmount
0
INPUT Policy Number of ParAccumValues
0
INPUT Policy Life DivType
0
INPUT Policy Number of Loan
0
INPUT Policy Coverage BandCode
0
INPUT Policy Loan LoanType
2
INPUT Policy Loan LoanIntTiming
0
INPUT Policy Loan LoanOriginationDate
01/01/2006
INPUT Policy Loan LoanAmt
1000
INPUT Policy number of FinancialActivity
0
X50 19a3568 3fe040 0 0 0 0 2
ULLoan Premium Payments
ULLoan Premium Payments
57200
Input TransEffDate
01/01/2011
INPUT Calling Program

INPUT Policy EffDate
01/01/2006
INPUT Policy ProductCode
UL1PA
INPUT Policy Loan LoanIntTiming
1
INPUT Policy Loan LoanIntType
2
INPUT Calling System
I1
INPUT Policy CarrierCode
00
INPUT Policy ProductVersionCode

INPUT Policy Jurisdiction
1000
INPUT Message Language
English
INPUT Policy number of Coverage
1
INPUT Policy Coverage IndicatorCode
1
INPUT Policy Coverage LifeCovStatus
1
INPUT Policy Coverage EffDate
01/01/2006
INPUT Policy Coverage TermDate
12/31/2999
INPUT Policy Coverage CurrentNumberOfUnits
1000
INPUT Policy LifeParticipant IssueAge
35
INPUT Policy Coverage ProductCode
WL1PA
INPUT Policy Coverage ProductVersionCode
1
INPUT Policy LifeParticipant IssueGender
1
INPUT Policy LifeParticipant UnderwritingClass
1
INPUT Policy LifeParticipant TobaccoPremiumBasis
1
INPUT Policy LifeParticipant TempTableRating
1
INPUT Policy LifeParticipant PermTableRating
1
INPUT Policy Number of LifeParticipant
1
INPUT Policy LifeParticipant PermFlatExtraAmount
0
INPUT Policy LifeParticipant TempFlatExtraAmount
0
INPUT Policy Number of ParAccumValues
0
INPUT Policy Life DivType
2
INPUT Payment Mode
2
INPUT Forced Payment Mode
0
INPUT Mode Premium Calc Option
0
INPUT Commission Premium Calc Ind
0
INPUT Specified Phase
0
INPUT Specified Element
C
INPUT Specified Element Index
0
INPUT Premium Type
P
INPUT Premium Subtype
R
INPUT Rate Info Passed Ind
1
INPUT Payment Form
0
INPUT Rate Assumption
C
INPUT Policy Coverage LifeCovTypeCode
1
INPUT Policy Coverage PremiumPerUnit
10
INPUT Policy LifeParticipant ParticipantRoleCode
1
INPUT Policy Number Of CoverageOption
0
INPUT Policy LifeParticipant number of SubstandardRating
0
INPUT Policy PaymentMode
1
INPUT Policy Life PaymentAmt
57200
X0 19a3e58 19a10b8 19a5300 19a5638 0 0 0
-- Projected Maximum Loan Remaining --
X63 19a5300 19a3e58 0 0 0 0 2
ULLoan Projected Maximum Loan Amount(rateAssumption; yearIndex; vectorWLProj)
ULLoan Projected Maximum Loan Amount("C"; 1; v_(400;700;1000;0))
320
INPUT Policy Loan LoanIntTiming
1
INPUT Calling Program

INPUT Policy Loan LoanPaymentAmt[1]
0
INPUT Policy Loan LoanPaymentMode
1
INPUT Policy Loan LoanInterestRate
5
INPUT Policy Life DivType
0
INPUT Policy ProductCode
UL1PA
INPUT Policy EffDate
01/01/2006
INPUT Calling System
I1
INPUT Policy CarrierCode
00
INPUT Policy ProductVersionCode

INPUT Policy Jurisdiction
1000
INPUT Policy number of Coverage
1
INPUT Policy Coverage ProductCode
WL1PA
Input TransEffDate
01/01/2006
INPUT Policy LifeParticipant IssueAge
35
INPUT Policy LifeParticipant IssueGender
1
INPUT Policy LifeParticipant UnderwritingClass
1
INPUT Policy LifeParticipant TobaccoPremiumBasis
1
INPUT Policy Coverage BandCode
0
INPUT Policy Coverage LifeCovTypeCode
1
INPUT Policy Coverage CurrentNumberOfUnits
1000
INPUT Policy Coverage IndicatorCode
1
INPUT Policy Life CurrLoanIntRate
5
INPUT Policy Number of Loan
2
INPUT Policy Loan LoanBalance
1000
INPUT Policy Loan LoanPaymentAmt[2]
100
INPUT Policy Loan LoanInterestRate[1]
5
INPUT Policy Loan LoanPaymentMode[1]
1
INPUT Policy Coverage LifeCovStatus
1
INPUT Policy Coverage EffDate
01/01/2006
INPUT Policy Coverage TermDate
12/31/2999
INPUT Policy Coverage ProductVersionCode
1
INPUT Policy Life CurrIntRate
5
INPUT Policy LifeParticipant TempTableRating
1
INPUT Policy LifeParticipant PermTableRating
1
INPUT Policy Number of LifeParticipant
1
INPUT Policy LifeParticipant PermFlatExtraAmount
0
INPUT Policy LifeParticipant TempFlatExtraAmount
0
INPUT Policy Life DivOnDepositAmt
0
INPUT Policy Life DivOnDepositIntRate
0
INPUT Policy LifeParticipant IssueAge[2]
35
INPUT Policy LifeParticipant IssueGender[2]
1
INPUT Policy LifeParticipant UnderwritingClass[2]
1
INPUT Policy LifeParticipant TobaccoPremiumBasis[2]
1
INPUT Policy Coverage BandCode[2]
0
INPUT Policy Loan LoanType[2]
2
INPUT Policy Loan LoanType
2
INPUT Policy LifeParticipant IssueAge[1]
35
INPUT Policy LifeParticipant IssueGender[1]
1
INPUT Policy LifeParticipant UnderwritingClass[1]
1
INPUT Policy LifeParticipant TobaccoPremiumBasis[1]
1
INPUT Policy Coverage BandCode[1]
0
INPUT Policy Loan LoanType[1]
2
INPUT Policy Loan LoanAmt
1000
INPUT Policy Loan LoanAmt[1]
1000
INPUT Policy Loan LoanIntType
2
INPUT Policy Loan LoanOriginationDate
01/01/2006
INPUT Policy Loan LoanOriginationDate[1]
01/01/2006
INPUT Message Language
English
INPUT Illus LoanAmt[1]
1000
INPUT Illus LoanAmt[2]
1000
X0 19a5638 19a10b8 19a7178 19a7348 0 0 0
-- Loan Interest Functions --
X9 19a7178 19a5638 0 0 0 0 2
ULLoan Interest Factor For Period(interestRate; endDate; startDate; loanIndex)
ULLoan Interest Factor For Period(0.05; "01/01/2007"; "01/01/2006")
1.05263157894737
INPUT Policy Loan LoanIntTiming
0
INPUT Calling Program

INPUT Policy EffDate
01/01/2006
INPUT Policy ProductCode
UL1PA
INPUT Calling System
I1
INPUT Policy CarrierCode
00
INPUT Policy ProductVersionCode

INPUT Message Language
9
X0 19a7348 19a10b8 19a73e0 19b2830 0 0 0
-- Loan Streams --
X4 19a73e0 19a7348 0 19a75a8 0 0 2
ULLoan PaymentMode(loanIndex)
ULLoan PaymentMode
1
INPUT Calling Program
VPMSTEST
INPUT Calling System
I1
INPUT Policy Loan LoanPaymentMode
1
X30 19a75a8 19a7348 0 19a8290 0 0 2
ULLoan NumberofLoans(yearIndex)
ULLoan NumberofLoans("C"; 4; v_(V_(0;0); v_(0;0); 0; v_(0; 20; 300); 0; 0))
2
INPUT Policy Number of Loan
2
INPUT Calling Program

INPUT Calling System
I1
Input TransEffDate
01/01/2006
INPUT Illus LoanAmt[1]
100
INPUT Illus LoanAmt[2]
3000
INPUT Policy ProductCode
UL1PA
INPUT Policy CarrierCode
00
INPUT Policy ProductVersionCode

INPUT Policy Jurisdiction
1000
INPUT Policy EffDate
01/01/2006
INPUT Policy LifeParticipant IssueAge
35
INPUT Policy LifeParticipant IssueGender
1
INPUT Policy LifeParticipant UnderwritingClass
1
INPUT Policy LifeParticipant TobaccoPremiumBasis
1
INPUT Illus FaceAmtDesignType
1000500001
INPUT Illus LoanAmt[4]
5000
INPUT Illus LoanAmt[3]
4000
INPUT Policy Loan LoanIntTiming
1
INPUT Policy Loan LoanIntType
2
INPUT Message Language
English
INPUT Illus Loan DesignType
1000500001
INPUT Illus LoanRepaymentAmt[0;3]
100
INPUT Illus DivType[3]
162
INPUT Policy number of Coverage
1
INPUT Policy Coverage ProductCode
WL1PA
INPUT Policy Coverage LifeCovTypeCode
1
INPUT Illus Face Amt Solve DesignType
1000500001
INPUT Policy Life DivType
3
X75 19a8290 19a7348 0 19a90c8 0 0 2
-- ULLoan Proj LoanType(rateAssumption; loanIndex; vectorWLProj)
0//ULLoan Proj LoanType("C"; 3; v_(50; 150; 40; 4000; 0.03))
0
INPUT Calling Program
VPMSTEST
INPUT Calling System
I1
Input TransEffDate
01/01/2006
INPUT Illus LoanAmt[1]
100
INPUT Policy ProductCode
UL1PA
INPUT Policy Loan LoanIntTiming
1
INPUT Policy Loan LoanIntType
2
INPUT Policy CarrierCode
00
INPUT Policy ProductVersionCode

INPUT Policy Jurisdiction
1000
INPUT Policy EffDate
01/01/2006
INPUT Message Language
0
INPUT Illus LoanAmt[2]
0
INPUT Illus LoanAmt[3]
4000
INPUT Illus LoanAmt[4]
0
INPUT Illus LoanAmt[5]
4000
INPUT Illus FaceAmtDesignType
1000500002
INPUT Illus FaceAmt[5]
0
INPUT Policy number of Coverage
1
INPUT Illus FaceAmt[4]
0
INPUT Illus FaceAmt[3]
0
INPUT Illus FaceAmt[2]
0
INPUT Illus FaceAmt[1]
10000
INPUT Policy Coverage LifeCovStatus
1
INPUT Policy Coverage RequestedEffDur
1
INPUT Policy Coverage RequestedMaturityDur
20
INPUT Policy LifeParticipant IssueAge
35
INPUT Policy Coverage ProductCode
WL1PA
INPUT Policy Coverage ProductVersionCode
1
INPUT Policy Coverage EffDate
01/01/2006
INPUT Invest Rate Type
11
INPUT Invest Rate Sub Type
1
INPUT Policy LifeParticipant IssueGender
1
INPUT Policy LifeParticipant UnderwritingClass
1
INPUT Policy LifeParticipant TobaccoPremiumBasis
1
INPUT Policy LifeParticipant TempTableRating
1
INPUT Policy LifeParticipant PermTableRating
1
INPUT Policy Number of LifeParticipant
1
INPUT Policy LifeParticipant PermFlatExtraAmount
0
INPUT Policy LifeParticipant TempFlatExtraAmount
0
INPUT Illus DivType[2]
162
INPUT Illus DivType[3]
161
INPUT Illus DivType[4]
161
INPUT Illus DivType[5]
161
INPUT Illus WithdrawalDesignType
1000500001
INPUT Payment Mode
1
INPUT Forced Payment Mode
1
INPUT Mode Premium Calc Option
0
INPUT Commission Premium Calc Ind
0
INPUT Specified Phase
0
INPUT Specified Element
C
INPUT Specified Element Index
0
INPUT Premium Type
P
INPUT Premium Subtype
R
INPUT Rate Info Passed Ind
1
INPUT Payment Form
0
INPUT Rate Assumption
C
INPUT Policy Coverage LifeCovTypeCode
1
INPUT Policy Coverage PremiumPerUnit
10
INPUT Policy LifeParticipant ParticipantRoleCode
1
INPUT Policy Number Of CoverageOption
0
INPUT Policy LifeParticipant number of SubstandardRating
0
INPUT Illus LoanAmt[6]
0
INPUT Illus FaceAmt[6]
0
INPUT Illus DivType[6]
162
INPUT Illus LoanAmt[7]
0
INPUT Illus LoanAmt[8]
1000
INPUT Illus Face Amt Solve DesignType
1000500001
INPUT Policy Number of Loan
0
INPUT Policy Coverage TermDate
12/31/2999
INPUT Policy Coverage IndicatorCode
1
INPUT Illus Loan DesignType
1000500001
INPUT Policy Loan LoanRepayNumYear
5
INPUT Policy Loan LoanRepayNumYear[1]
1
X84 19a90c8 19a7348 0 19acdb8 0 0 2
ULLoan LoanAmt("C"; 0; v_(100; 250; 0;400; 0.03))
ULLoan LoanAmt("C"; 0; v_(100; 250; 3000;v_(0; 50; 200; 300; 500; 600; 1000); 0.03; 0))
0
INPUT Calling Program
VPMSTEST
INPUT Calling System
CL
INPUT Illus LoanAmt[1]
0
INPUT Illus LoanAmt[2]
10000
INPUT Policy ProductCode
WL1PA
Input TransEffDate
01/01/2006
INPUT Policy Loan LoanIntTiming
1
INPUT Policy Loan LoanIntType
2
INPUT Policy CarrierCode
00
INPUT Policy ProductVersionCode

INPUT Policy Jurisdiction
1000
INPUT Policy EffDate
01/01/2006
INPUT Policy number of Coverage
1
INPUT Policy Coverage LifeCovStatus
1
INPUT Policy Coverage RequestedEffDur
1
INPUT Policy Coverage RequestedMaturityDur
100
INPUT Policy LifeParticipant IssueAge
35
INPUT Policy Coverage ProductCode
UL1PA
INPUT Policy Coverage ProductVersionCode
1
INPUT Policy Coverage EffDate
01/01/2006
INPUT Invest Rate Type
11
INPUT Invest Rate Sub Type
1
INPUT Policy LifeParticipant IssueGender
1
INPUT Policy LifeParticipant UnderwritingClass
1
INPUT Policy LifeParticipant TobaccoPremiumBasis
1
INPUT Policy LifeParticipant TempTableRating
1
INPUT Policy LifeParticipant PermTableRating
1
INPUT Policy Number of LifeParticipant
1
INPUT Policy LifeParticipant PermFlatExtraAmount
0
INPUT Policy LifeParticipant TempFlatExtraAmount
0
INPUT Illus Face Amt Solve DesignType
1000500001
INPUT Illus FaceAmtDesignType
1000500001
INPUT Policy Coverage CurrentAmt
100000
INPUT Illus WithdrawalDesignType
1000500001
INPUT Illus LoanAmt[3]
1000
INPUT Illus LoanAmt[4]
0
INPUT Illus LoanAmt[5]
0
INPUT Illus DivType[2]
162
INPUT Illus DivType[3]
162
INPUT Illus DivType[4]
162
INPUT Illus DivType[5]
162
INPUT Payment Mode
1
INPUT Forced Payment Mode
0
INPUT Mode Premium Calc Option
0
INPUT Commission Premium Calc Ind
0
INPUT Specified Phase
0
INPUT Specified Element
C
INPUT Specified Element Index
0
INPUT Premium Type
P
INPUT Premium Subtype
R
INPUT Rate Info Passed Ind
0
INPUT Payment Form
0
INPUT Rate Assumption
C
INPUT Policy Coverage LifeCovTypeCode
1
INPUT Policy LifeParticipant ParticipantRoleCode
1
INPUT Message Language
0
INPUT Policy Number Of CoverageOption
0
INPUT Policy LifeParticipant number of SubstandardRating
0
INPUT Illus LoanAmt[6]
0
INPUT Illus LoanRepaymentAmt[0;2]
100
INPUT Policy Life DivType
3
INPUT Illus LoanRepaymentAmt[0;3]
0
INPUT Illus LoanAmt[7]
1000
INPUT Illus Loan DesignType
1000500001
INPUT Illus LoanRepaymentAmt[0;4]
0
INPUT Illus LoanRepaymentAmt[0;5]
0
INPUT Illus LoanRepaymentAmt[0;6]
0
INPUT Illus DivType[6]
162
INPUT Illus PremiumDesignType
30
INPUT Illus PremiumStreamAmt[1]
500
INPUT PolicyProduct Ownership MaxPremiumInitialAmt
700
INPUT PolicyProduct Ownership MaxPremiumAddOnAmt
300
INPUT PolicyProduct Ownership MinPremiumInitialAmt
0
INPUT PolicyProduct Ownership MinPremiumAddOnAmt
0
INPUT Policy PaymentMode
1
INPUT Illus PremiumStreamAmt[2]
100
INPUT Illus PremiumStreamAmt[3]
100
INPUT Illus PremiumStreamAmt[4]
100
INPUT Illus PremiumStreamAmt[5]
100
INPUT Illus PremiumStreamAmt[6]
1000
INPUT Policy Number of Loan
0
INPUT PolicyProduct LoanProvision MinSingleLoan
0
INPUT Illus DisbDesignType
1000500001
X36 19acdb8 19a7348 0 19b1da0 0 0 2
ULLoan NumberofLoans(rateAssumption; yearIndex; vectorWLProj)
ULLoan NumberofLoans("C"; 2; v_(100; 250; 3000;40000; 0.03))
1
INPUT Calling Program

INPUT Calling System
I1
INPUT Illus LoanAmt[1]
0
INPUT Illus LoanAmt[2]
10000
INPUT Policy ProductCode
UL1PA
Input TransEffDate
01/01/2006
INPUT Policy Loan LoanIntTiming
1
INPUT Policy Loan LoanIntType
2
INPUT Policy CarrierCode
00
INPUT Policy ProductVersionCode

INPUT Policy Jurisdiction
1000
INPUT Policy EffDate
01/01/2006
INPUT Policy number of Coverage
1
INPUT Policy Coverage LifeCovStatus
1
INPUT Policy Coverage RequestedEffDur
1
INPUT Policy Coverage RequestedMaturityDur
100
INPUT Policy LifeParticipant IssueAge
35
INPUT Policy Coverage ProductCode
WL1PA
INPUT Policy Coverage ProductVersionCode
1
INPUT Policy Coverage EffDate
01/01/2006
INPUT Invest Rate Type
11
INPUT Invest Rate Sub Type
1
INPUT Policy LifeParticipant IssueGender
1
INPUT Policy LifeParticipant UnderwritingClass
1
INPUT Policy LifeParticipant TobaccoPremiumBasis
1
INPUT Policy LifeParticipant TempTableRating
1
INPUT Policy LifeParticipant PermTableRating
1
INPUT Policy Number of LifeParticipant
1
INPUT Policy LifeParticipant PermFlatExtraAmount
0
INPUT Policy LifeParticipant TempFlatExtraAmount
0
INPUT Illus Face Amt Solve DesignType
1000500001
INPUT Illus FaceAmtDesignType
1000500001
INPUT Policy Coverage CurrentAmt
100000
INPUT Illus WithdrawalDesignType
1000500001
INPUT Policy Number of Loan
1
X85 19b1da0 19a7348 0 0 0 0 2
ULLoan Total Projected Balance(yearIndexIndex)
ULLoan Total Projected Balance("C";3;"")
0
INPUT Calling Program

INPUT Calling System
I1
Input TransEffDate
01/01/2006
INPUT Illus LoanAmt[1]
10000
INPUT Policy Loan LoanIntTiming
1
INPUT Policy Loan LoanInterestRate
2
INPUT Illus LoanRepaymentAmt[0;1]
100
INPUT Illus DivType[1]
161
INPUT Policy ProductCode
WL1PA
INPUT Policy CarrierCode
00
INPUT Policy ProductVersionCode

INPUT Policy Jurisdiction
1000
INPUT Policy EffDate
01/01/2006
INPUT Policy number of Coverage
1
INPUT Policy Coverage ProductCode
WL1PA
INPUT Policy LifeParticipant IssueAge
35
INPUT Policy LifeParticipant IssueGender
1
INPUT Policy LifeParticipant UnderwritingClass
1
INPUT Policy LifeParticipant TobaccoPremiumBasis
1
INPUT Illus FaceAmtDesignType
1000500002
INPUT Illus FaceAmt[1]
10000
INPUT Policy Coverage LifeCovTypeCode
2
INPUT Policy Life DivType
2
INPUT Policy Loan LoanType
2
INPUT Policy Loan LoanIntType
2
INPUT Message Language
5
INPUT Illus LoanAmt[2]
0
INPUT Illus LoanAmt[3]
0
INPUT Illus LoanAmt[4]
0
INPUT Illus FaceAmt[5]
0
INPUT Illus FaceAmt[4]
0
INPUT Illus FaceAmt[3]
0
INPUT Illus FaceAmt[2]
0
INPUT Policy Coverage LifeCovStatus
1
INPUT Policy Coverage RequestedEffDur
1
INPUT Policy Coverage RequestedMaturityDur
20
INPUT Policy Coverage ProductVersionCode
1
INPUT Policy Coverage EffDate
01/01/2006
INPUT Invest Rate Type
11
INPUT Invest Rate Sub Type
1
INPUT Policy LifeParticipant TempTableRating
1
INPUT Policy LifeParticipant PermTableRating
1
INPUT Policy Number of LifeParticipant
1
INPUT Policy LifeParticipant PermFlatExtraAmount
0
INPUT Policy LifeParticipant TempFlatExtraAmount
0
INPUT Illus LoanAmt[5]
0
INPUT Illus LoanAmt[6]
0
INPUT Illus LoanAmt[7]
0
INPUT Illus LoanAmt[8]
0
INPUT Illus LoanAmt[9]
0
INPUT Illus LoanAmt[10]
0
INPUT Illus LoanAmt[11]
0
INPUT Illus LoanAmt[12]
0
INPUT Illus LoanAmt[13]
0
INPUT Illus LoanAmt[14]
0
INPUT Illus LoanAmt[15]
0
INPUT Illus LoanAmt[16]
0
INPUT Illus LoanAmt[17]
0
INPUT Illus LoanAmt[18]
0
INPUT Illus LoanAmt[19]
100
INPUT Illus LoanAmt[20]
100
INPUT Illus LoanAmt[21]
100
INPUT Illus LoanAmt[22]
0
INPUT Illus LoanAmt[23]
100
INPUT Illus LoanAmt[24]
0
INPUT Illus LoanAmt[25]
0
INPUT Illus LoanAmt[26]
0
INPUT Policy LifeParticipant IssueAge[1]
35
INPUT Policy LifeParticipant IssueGender[1]
1
INPUT Policy LifeParticipant UnderwritingClass[1]
1
INPUT Policy LifeParticipant TobaccoPremiumBasis[1]
1
INPUT Policy Loan LoanType[1]
2
INPUT Illus LoanRepaymentAmt[1;1]
100
INPUT Illus LoanRepaymentAmt[0;2]
100
INPUT Illus DivType[2]
161
INPUT Illus LoanRepaymentAmt[1;2]
100
INPUT Illus LoanRepaymentAmt[0;3]
100
INPUT Illus DivType[3]
161
INPUT Illus LoanRepaymentAmt[1;3]
100
INPUT Policy Number of Loan
1
INPUT Policy Loan LoanOriginationDate
01/01/2006
INPUT Policy Loan LoanAmt
0
INPUT Policy Loan LoanPaymentAmt[2]
0
INPUT Policy Loan LoanPaymentMode
0
X0 19b2830 19a10b8 19b5280 19b5bc8 0 0 0
-- Date Functions --
X3 19b5280 19b2830 0 19b5440 0 0 2
ULLoan Days in Policy Year(date1)
ULLoan Days in Policy Year("01/06/2006")
365
INPUT Calling Program

INPUT Policy EffDate
01/01/2006
X3 19b5440 19b2830 0 19b55e8 0 0 2
ULLoan Days in Policy Year(date1)
ULLoan Days in Policy Year("01/06/2008")
366
INPUT Calling Program

INPUT Policy EffDate
01/01/2006
X1 19b55e8 19b2830 0 19b5698 0 0 2
ULLoan Calc Strict Last Anniversary Date(issue_date; point_in_time_date)
ULLoan Calc Strict Last Anniversary Date("01/01/2006"; "01/01/2008")
01/01/2007
X1 19b5698 19b2830 0 0 0 0 2
ULLoan Calc Strict Next Anniversary Date(issue_date; point_in_time_date)
ULLoan Calc Strict Next Anniversary Date("01/01/2006"; "01/01/2008")
01/01/2009
X67 19b5bc8 19a10b8 0 0 0 0 2
ULLoan Projected Maximum Loan Amount Start of Year(rateAssumption; yearIndex; vectorWLProj)
ULLoan Projected Maximum Loan Amount Start of Year("C"; 3; v_(400;700;1000;0))
320
INPUT Policy Loan LoanIntTiming
1
INPUT Calling Program

INPUT Policy Loan LoanPaymentAmt[1]
0
INPUT Policy Loan LoanPaymentMode
1
INPUT Policy Loan LoanInterestRate
5
INPUT Policy Life DivType
0
INPUT Policy ProductCode
UL1PA
INPUT Policy EffDate
01/01/2006
INPUT Calling System
I1
INPUT Policy CarrierCode
00
INPUT Policy ProductVersionCode

INPUT Policy Jurisdiction
1000
INPUT Policy number of Coverage
1
INPUT Policy Coverage ProductCode
WL1PA
Input TransEffDate
01/01/2006
INPUT Policy LifeParticipant IssueAge
35
INPUT Policy LifeParticipant IssueGender
1
INPUT Policy LifeParticipant UnderwritingClass
1
INPUT Policy LifeParticipant TobaccoPremiumBasis
1
INPUT Policy Coverage BandCode
0
INPUT Policy Coverage LifeCovTypeCode
1
INPUT Policy Coverage CurrentNumberOfUnits
1000
INPUT Policy Coverage IndicatorCode
1
INPUT Policy Life CurrLoanIntRate
5
INPUT Policy Number of Loan
2
INPUT Policy Loan LoanBalance
1000
INPUT Policy Loan LoanPaymentAmt[2]
100
INPUT Policy Loan LoanInterestRate[1]
5
INPUT Policy Loan LoanPaymentMode[1]
1
INPUT Policy Coverage LifeCovStatus
1
INPUT Policy Coverage EffDate
01/01/2006
INPUT Policy Coverage TermDate
12/31/2999
INPUT Policy Coverage ProductVersionCode
1
INPUT Policy Life CurrIntRate
5
INPUT Policy LifeParticipant TempTableRating
1
INPUT Policy LifeParticipant PermTableRating
1
INPUT Policy Number of LifeParticipant
1
INPUT Policy LifeParticipant PermFlatExtraAmount
0
INPUT Policy LifeParticipant TempFlatExtraAmount
0
INPUT Policy Life DivOnDepositAmt
0
INPUT Policy Life DivOnDepositIntRate
0
INPUT Policy LifeParticipant IssueAge[2]
35
INPUT Policy LifeParticipant IssueGender[2]
1
INPUT Policy LifeParticipant UnderwritingClass[2]
1
INPUT Policy LifeParticipant TobaccoPremiumBasis[2]
1
INPUT Policy Coverage BandCode[2]
0
INPUT Policy Loan LoanType[2]
2
INPUT Policy Loan LoanType
2
INPUT Policy LifeParticipant IssueAge[1]
35
INPUT Policy LifeParticipant IssueGender[1]
1
INPUT Policy LifeParticipant UnderwritingClass[1]
1
INPUT Policy LifeParticipant TobaccoPremiumBasis[1]
1
INPUT Policy Coverage BandCode[1]
0
INPUT Policy Loan LoanType[1]
2
INPUT Policy Loan LoanAmt
1000
INPUT Policy Loan LoanAmt[1]
1000
INPUT Invest Rate Type
11
INPUT Invest Rate Sub Type
1
INPUT Policy Loan LoanOriginationDate
01/01/2006
INPUT Policy Loan LoanOriginationDate[1]
01/01/2006
INPUT Policy Loan LoanIntType
2
INPUT Message Language
English
INPUT Illus LoanAmt[1]
000
INPUT Illus LoanAmt[2]
1000
INPUT Policy Loan LoanPaymentAmt
100
INPUT Illus LoanAmt[3]
1000
X0 19b8c30 3f4048 19b9560 19cb6d0 0 0 0
-- OLD TEST CASES --
X29 19b9560 19b8c30 0 19b9878 0 0 2
ULLoan Base Balance(startDate; endDate; loanIndex)
ULLoan Base Balance At Time("C";0; "04/01/2006")
709.6184068249
INPUT Policy Loan LoanOriginationDate
01/01/2006
INPUT Policy Loan LoanAmt
1000
INPUT Policy FinancialActivity FinEffDate
03/01/2006
INPUT Calling Program

INPUT Policy EffDate
01/01/2006
INPUT Policy ProductCode
UL1PA
INPUT Policy LifeParticipant IssueAge
35
INPUT Policy LifeParticipant IssueGender
1
INPUT Policy LifeParticipant UnderwritingClass
1
INPUT Policy LifeParticipant TobaccoPremiumBasis
1
Input TransEffDate
04/01/2006
INPUT Policy Coverage BandCode
0
INPUT Policy Jurisdiction
1000
INPUT Policy Loan LoanType
2
INPUT Calling System
I1
INPUT Policy CarrierCode
00
INPUT Policy ProductVersionCode

INPUT Policy Loan LoanIntTiming
2
INPUT Policy number of FinancialActivity
2
INPUT Policy FinancialActivity FinActivityType
2
INPUT Policy FinancialActivity FinActivityNetAmt
200
INPUT Policy FinancialActivity FinEffDate[1]
03/01/2006
INPUT Policy FinancialActivity FinActivityType[1]
2
INPUT Policy FinancialActivity FinActivityNetAmt[1]
100
INPUT Policy Loan LoanOriginationDate[1]
0
INPUT Policy FinancialActivity FinEffDate[2]
0
INPUT Message Language
2
INPUT Policy Coverage IndicatorCode
1
X35 19b9878 19b8c30 19ba0e8 19beef0 0 0 2
Loan Total Current Balance
ULLoan Total Current Balance("C")
1693.0978046165
INPUT Calling Program

INPUT Policy EffDate
01/01/2006
INPUT Policy Loan LoanOriginationDate
01/01/2006
INPUT Policy Loan LoanAmt
1000
INPUT Policy ProductCode
UL1PA
Input TransEffDate
01/01/2008
INPUT Policy LifeParticipant IssueAge
35
INPUT Policy LifeParticipant IssueGender
1
INPUT Policy LifeParticipant UnderwritingClass
1
INPUT Policy LifeParticipant TobaccoPremiumBasis
1
INPUT Policy Coverage BandCode
0
INPUT Policy Jurisdiction
1000
INPUT Policy Loan LoanType
2
INPUT Calling System
I1
INPUT Policy CarrierCode
00
INPUT Policy ProductVersionCode

INPUT Policy Loan LoanIntTiming
0
INPUT Policy number of FinancialActivity
1
INPUT Policy FinancialActivity FinActivityType
2
INPUT Policy FinancialActivity FinEffDate
01/01/2007
INPUT Policy FinancialActivity FinActivityNetAmount
100
INPUT Policy Loan LoanOriginationDate[1]
01/01/2006
INPUT Policy LifeParticipant IssueAge[1]
35
INPUT Policy LifeParticipant IssueGender[1]
1
INPUT Policy LifeParticipant UnderwritingClass[1]
1
INPUT Policy LifeParticipant TobaccoPremiumBasis[1]
1
INPUT Policy Coverage BandCode[1]
0
INPUT Policy Loan LoanType[1]
2
INPUT Policy Loan LoanAmt[1]
500
INPUT Policy Number of Loan
2
INPUT Policy Loan LoanIntMethod
0
INPUT Policy FinancialActivity FinActivityNetAmt
0
INPUT Message Language
English
INPUT Policy Coverage IndicatorCode
1
X26 19ba0e8 19b9878 0 19bada8 0 0 2
ULLoan Current Balance(loanIndex)
ULLoan Current Balance("C";0)
1015.8586827699
INPUT Calling Program

INPUT Policy EffDate
01/01/2006
INPUT Policy Loan LoanOriginationDate
01/01/2006
INPUT Policy Loan LoanAmt
1000
INPUT Policy ProductCode
UL1PA
Input TransEffDate
01/01/2008
INPUT Policy LifeParticipant IssueAge
35
INPUT Policy LifeParticipant IssueGender
1
INPUT Policy LifeParticipant UnderwritingClass
1
INPUT Policy LifeParticipant TobaccoPremiumBasis
1
INPUT Policy Coverage BandCode
0
INPUT Policy Jurisdiction
1000
INPUT Policy Loan LoanType
2
INPUT Calling System
I1
INPUT Policy CarrierCode
00
INPUT Policy ProductVersionCode

INPUT Policy Loan LoanIntTiming
0
INPUT Policy number of FinancialActivity
1
INPUT Policy FinancialActivity FinActivityType
2
INPUT Policy FinancialActivity FinEffDate
01/01/2007
INPUT Policy FinancialActivity FinActivityNetAmount
100
INPUT Policy Loan LoanIntMethod
0
INPUT Policy FinancialActivity FinActivityNetAmt
100
INPUT Message Language
English
INPUT Policy Coverage IndicatorCode
1
X34 19bada8 19b9878 0 19bb458 0 0 2
ULLoan Current Balance(loanIndex)
ULLoan Current Balance("C";1)
564.3659348722
INPUT Calling Program

INPUT Policy EffDate
01/01/2006
INPUT Policy Loan LoanOriginationDate
01/01/2006
INPUT Policy Loan LoanAmt
1000
INPUT Policy ProductCode
UL1PA
Input TransEffDate
01/01/2008
INPUT Policy LifeParticipant IssueAge
35
INPUT Policy LifeParticipant IssueGender
1
INPUT Policy LifeParticipant UnderwritingClass
1
INPUT Policy LifeParticipant TobaccoPremiumBasis
1
INPUT Policy Coverage BandCode
0
INPUT Policy Jurisdiction
1000
INPUT Policy Loan LoanType
2
INPUT Calling System
I1
INPUT Policy CarrierCode
00
INPUT Policy ProductVersionCode

INPUT Policy Loan LoanIntTiming
0
INPUT Policy number of FinancialActivity
1
INPUT Policy FinancialActivity FinActivityType
2
INPUT Policy FinancialActivity FinEffDate
01/01/2007
INPUT Policy FinancialActivity FinActivityNetAmount
100
INPUT Policy Loan LoanOriginationDate[1]
01/01/2006
INPUT Policy LifeParticipant IssueAge[1]
35
INPUT Policy LifeParticipant IssueGender[1]
1
INPUT Policy LifeParticipant UnderwritingClass[1]
1
INPUT Policy LifeParticipant TobaccoPremiumBasis[1]
1
INPUT Policy Coverage BandCode[1]
0
INPUT Policy Loan LoanType[1]
2
INPUT Policy Loan LoanAmt[1]
500
INPUT Policy Loan LoanIntMethod
0
INPUT Policy FinancialActivity FinActivityNetAmt
0
INPUT Message Language
English
INPUT Policy Coverage IndicatorCode
1
X25 19bb458 19b9878 19bbde8 0 0 0 2
Loan Current Balance at Time(loanIndex; point_in_time_date)
ULLoan Current Balance at Time("C";0; "01/01/2008")
1015.8586827699
INPUT Calling Program

INPUT Policy EffDate
01/01/2006
INPUT Policy Loan LoanOriginationDate
01/01/2006
INPUT Policy Loan LoanAmt
1000
INPUT Policy ProductCode
UL1PA
Input TransEffDate
01/01/2008
INPUT Policy LifeParticipant IssueAge
35
INPUT Policy LifeParticipant IssueGender
1
INPUT Policy LifeParticipant UnderwritingClass
1
INPUT Policy LifeParticipant TobaccoPremiumBasis
1
INPUT Policy Coverage BandCode
0
INPUT Policy Jurisdiction
1000
INPUT Policy Loan LoanType
2
INPUT Calling System
I1
INPUT Policy CarrierCode
00
INPUT Policy ProductVersionCode

INPUT Policy Loan LoanIntTiming
0
INPUT Policy number of FinancialActivity
1
INPUT Policy FinancialActivity FinActivityType
2
INPUT Policy FinancialActivity FinEffDate
01/01/2007
INPUT Policy FinancialActivity FinActivityNetAmount
100
INPUT Policy FinancialActivity FinActivityNetAmt
100
INPUT Message Language
English
INPUT Policy Coverage IndicatorCode
1
X20 19bbde8 19bb458 0 19bc560 0 0 2
ULLoan Current Balance Accrual(endDate; loanBalance; loanIndex)
ULLoan Current Balance Accrual("C";"01/01/2007"; 0; 0)
1061.00795755968
INPUT Calling Program

INPUT Policy EffDate
01/01/2006
INPUT Policy Loan LoanOriginationDate
01/01/2006
INPUT Policy Loan LoanAmt
1000
INPUT Policy ProductCode
UL1PA
Input TransEffDate
01/01/2007
INPUT Policy LifeParticipant IssueAge
35
INPUT Policy LifeParticipant IssueGender
1
INPUT Policy LifeParticipant UnderwritingClass
1
INPUT Policy LifeParticipant TobaccoPremiumBasis
1
INPUT Policy Coverage BandCode
0
INPUT Policy Jurisdiction
1000
INPUT Policy Loan LoanType
2
INPUT Calling System
I1
INPUT Policy CarrierCode
00
INPUT Policy ProductVersionCode

INPUT Policy Loan LoanIntTiming
0
INPUT Message Language
English
INPUT Policy Coverage IndicatorCode
1
X18 19bc560 19bb458 0 19bcb90 0 0 2
ULLoan Activity Accrual For Period(activityNetAmt; loanIndex; activityDate; startDate; endDate)
ULLoan Activity Accrual For Period("C";1000; 0; "01/01/2006"; "01/01/2006"; "01/01/2009")
1203.98066106064
INPUT Calling Program

INPUT Policy EffDate
01/01/2006
INPUT Policy ProductCode
UL1PA
Input TransEffDate
01/01/2007
INPUT Policy LifeParticipant IssueAge
35
INPUT Policy LifeParticipant IssueGender
1
INPUT Policy LifeParticipant UnderwritingClass
1
INPUT Policy LifeParticipant TobaccoPremiumBasis
1
INPUT Policy Coverage BandCode
0
INPUT Policy Jurisdiction
1000
INPUT Policy Loan LoanType
2
INPUT Calling System
I1
INPUT Policy CarrierCode
00
INPUT Policy ProductVersionCode

INPUT Policy Loan LoanIntTiming
0
INPUT Message Language
English
INPUT Policy Coverage IndicatorCode
1
X37 19bcb90 19bb458 19bd210 0 0 0 2
ULLoan Repayments For Period(financialActivityIndex; loanIndex; loanBalance; startDate; endDate)
ULLoan Repayments For Period("C";0; 1; 1000; "01/01/2006"; "01/01/2007")
438.99204244032
INPUT Policy FinancialActivity FinActivityType
2
INPUT Policy FinancialActivity FinEffDate
01/01/2007
INPUT Policy number of FinancialActivity
2
INPUT Policy FinancialActivity FinActivityNetAmount
1000
INPUT Calling Program

INPUT Policy EffDate
01/01/2006
INPUT Policy Loan LoanOriginationDate
01/01/2006
INPUT Policy Loan LoanAmt
1000
INPUT Policy ProductCode
UL1PA
Input TransEffDate
01/01/2007
INPUT Policy LifeParticipant IssueAge
35
INPUT Policy LifeParticipant IssueGender
1
INPUT Policy LifeParticipant UnderwritingClass
1
INPUT Policy LifeParticipant TobaccoPremiumBasis
1
INPUT Policy Coverage BandCode
0
INPUT Policy Jurisdiction
1000
INPUT Policy Loan LoanType
2
INPUT Calling System
I1
INPUT Policy CarrierCode
00
INPUT Policy ProductVersionCode

INPUT Policy Loan LoanIntTiming
0
INPUT Policy FinancialActivity FinEffDate[1]
01/01/2007
INPUT Policy FinancialActivity FinActivityNetAmount[1]
500
INPUT Policy FinancialActivity FinActivityType[1]
2
INPUT Policy Loan LoanOriginationDate[1]
01/01/2007
INPUT Policy LifeParticipant IssueAge[1]
35
INPUT Policy LifeParticipant IssueGender[1]
1
INPUT Policy LifeParticipant UnderwritingClass[1]
1
INPUT Policy LifeParticipant TobaccoPremiumBasis[1]
1
INPUT Policy Coverage BandCode[1]
0
INPUT Policy Loan LoanType[1]
2
INPUT Policy Loan LoanAmt[1]
1000
INPUT Policy FinancialActivity FinActivityNetAmt
1000
INPUT Policy FinancialActivity FinActivityNetAmt[1]
500
INPUT Message Language
English
INPUT Policy Coverage IndicatorCode
1
X32 19bd210 19bcb90 0 19be270 0 0 2
ULLoan Payment Amount Remaining(endLoanIndex; currentLoanIndex; activityGrossAmnt; financialActivityDate)
ULLoan Payment Amount Remaining("C";1; 0; 1500; "01/01/2006")
500
INPUT Calling Program

INPUT Policy EffDate
01/01/2006
INPUT Policy Loan LoanOriginationDate
01/01/2006
INPUT Policy Loan LoanAmt
1000
INPUT Policy number of FinancialActivity
1
INPUT Policy Loan LoanOriginationDate[1]
01/01/2006
INPUT Policy Loan LoanAmt[1]
2000
INPUT Policy ProductCode
UL1PA
Input TransEffDate
01/01/2006
INPUT Policy LifeParticipant IssueAge[1]
35
INPUT Policy LifeParticipant IssueGender[1]
1
INPUT Policy LifeParticipant UnderwritingClass[1]
1
INPUT Policy LifeParticipant TobaccoPremiumBasis[1]
1
INPUT Policy Coverage BandCode[1]
0
INPUT Policy Jurisdiction
1000
INPUT Policy Loan LoanType[1]
2
INPUT Calling System
I1
INPUT Policy CarrierCode
00
INPUT Policy ProductVersionCode

INPUT Policy Loan LoanIntTiming
1
INPUT Policy FinancialActivity FinActivityType
2
INPUT Policy FinancialActivity FinEffDate
01/01/2006
INPUT Policy LifeParticipant IssueAge
35
INPUT Policy LifeParticipant IssueGender
1
INPUT Policy LifeParticipant UnderwritingClass
1
INPUT Policy LifeParticipant TobaccoPremiumBasis
1
INPUT Policy Coverage BandCode
0
INPUT Policy Loan LoanType
2
INPUT Message Language
9
INPUT Policy FinancialActivity FinActivityNetAmt
0
INPUT Policy Coverage IndicatorCode
1
X9 19be270 19bcb90 0 19bed50 0 0 2
ULLoan Payment Amount on Day(currentFinancialActivityIndex; selectedFinancialActivityIndex; activityGrossAmount)
ULLoan Payment Amount on Day(0; 1; 0)
250
INPUT Policy number of FinancialActivity
3
INPUT Policy FinancialActivity FinEffDate
01/01/2006
INPUT Policy FinancialActivity FinEffDate[1]
02/01/2006
INPUT Policy FinancialActivity FinEffDate[2]
02/01/2006
INPUT Policy FinancialActivity FinActivityNetAmount[2]
100
INPUT Policy FinancialActivity FinActivityNetAmount[1]
150
INPUT Policy FinancialActivity FinActivityNetAmt[1]
150
INPUT Policy FinancialActivity FinActivityNetAmt[2]
100
X4 19bed50 19bcb90 0 0 0 0 2
ULLoan Payment Amount on Day(currentFinancialActivityIndex; selectedFinancialActivityIndex; activityGrossAmount)
ULLoan Payment Amount on Day(0; 1; 100)
0
INPUT Policy number of FinancialActivity
3
INPUT Policy FinancialActivity FinEffDate
01/01/2006
INPUT Policy FinancialActivity FinEffDate[1]
01/01/2006
X80 19beef0 19b8c30 0 19bf430 0 0 2
ULLoan Projected Maximum Pref Loan Amount(rateAssumption; yearIndex; vectorWLProj)
ULLoan Projected Maximum Pref Loan Amount("C"; 5; v_(400;700;1000;0))
40
INPUT Policy ProductCode
UL1PA
INPUT Calling Program

INPUT Policy EffDate
01/01/2006
INPUT Policy Loan LoanIntTiming
1
INPUT Policy Loan LoanIntType
2
INPUT Calling System
I1
INPUT Policy CarrierCode
00
INPUT Policy ProductVersionCode

INPUT Policy Jurisdiction
1000
INPUT Policy number of Coverage
1
INPUT Policy Coverage IndicatorCode
1
Input TransEffDate
01/01/2006
INPUT Policy Coverage LifeCovStatus
1
INPUT Policy Coverage EffDate
01/01/2006
INPUT Policy Coverage TermDate
12/31/2999
INPUT Policy LifeParticipant IssueAge
35
INPUT Policy Coverage ProductCode
WL1PA
INPUT Policy Coverage ProductVersionCode
1
INPUT Policy Life CurrIntRate
0
INPUT Policy LifeParticipant IssueGender
1
INPUT Policy LifeParticipant UnderwritingClass
1
INPUT Policy LifeParticipant TobaccoPremiumBasis
1
INPUT Policy LifeParticipant TempTableRating
1
INPUT Policy LifeParticipant PermTableRating
1
INPUT Policy Number of LifeParticipant
1
INPUT Policy LifeParticipant PermFlatExtraAmount
0
INPUT Policy LifeParticipant TempFlatExtraAmount
0
INPUT Policy Coverage CurrentNumberOfUnits
1000
INPUT Policy Life DivOnDepositAmt
0
INPUT Policy Life DivOnDepositIntRate
0
INPUT Policy Life DivType
2
INPUT Payment Mode
1
INPUT Forced Payment Mode
0
INPUT Mode Premium Calc Option
0
INPUT Commission Premium Calc Ind
0
INPUT Specified Phase
0
INPUT Specified Element
C
INPUT Specified Element Index
0
INPUT Premium Type
P
INPUT Premium Subtype
R
INPUT Rate Info Passed Ind
1
INPUT Payment Form
0
INPUT Rate Assumption
C
INPUT Policy Coverage LifeCovTypeCode
1
INPUT Policy Coverage PremiumPerUnit
10
INPUT Policy LifeParticipant ParticipantRoleCode
1
INPUT Message Language
9
INPUT Policy Number Of CoverageOption
0
INPUT Policy LifeParticipant number of SubstandardRating
0
INPUT Invest Rate Type
11
INPUT Invest Rate Sub Type
1
INPUT Illus FaceAmtDesignType
1000500001
INPUT Policy Coverage RequestedEffDur
1
INPUT Policy Coverage RequestedMaturityDur
20
INPUT Policy Coverage CurrentAmt
1000
INPUT Illus DivType[2]
162
INPUT Illus DivType[3]
161
INPUT Illus DivType[4]
162
INPUT Illus DivType[5]
161
INPUT Illus WithdrawalDesignType
1000500001
INPUT Policy Duration
10
INPUT Policy Number of Loan
1
INPUT Policy Loan LoanOriginationDate
01/01/2006
INPUT Policy Loan LoanAmt
1000
INPUT Policy Loan LoanInterestRate
5
INPUT Policy Loan LoanPaymentAmt[1]
0
INPUT Policy Loan LoanPaymentMode
1
INPUT Policy Coverage BandCode
0
INPUT Illus Face Amt Solve DesignType
1000500001
INPUT Policy Loan LoanPaymentAmt[2]
0
INPUT Policy Loan LoanType
2
INPUT Illus LoanAmt[1]
1000
INPUT Illus LoanAmt[2]
0
INPUT Illus LoanAmt[3]
0
INPUT Illus LoanAmt[4]
0
INPUT Illus LoanAmt[5]
0
INPUT Illus LoanAmt[6]
0
INPUT Illus LoanAmt[7]
0
INPUT Policy Loan LoanPaymentAmt
100
X62 19bf430 19b8c30 0 19c36d8 0 0 2
ULLoan Projected Maximum Pref Loan Amount(rateAssumption; yearIndex; vectorWLProj)
ULLoan Projected Maximum Pref Loan Amount("C"; 5; v_(400;700;1000;0))
40
INPUT Policy ProductCode
UL1PA
INPUT Calling Program

INPUT Policy EffDate
01/01/2006
INPUT Policy Loan LoanIntTiming
1
INPUT Policy Loan LoanIntType
2
INPUT Calling System
I1
INPUT Policy CarrierCode
00
INPUT Policy ProductVersionCode

INPUT Policy Jurisdiction
1000
INPUT Policy number of Coverage
1
INPUT Policy Coverage IndicatorCode
1
Input TransEffDate
01/01/2006
INPUT Policy Coverage LifeCovStatus
1
INPUT Policy Coverage EffDate
01/01/2006
INPUT Policy Coverage TermDate
12/31/2999
INPUT Policy LifeParticipant IssueAge
35
INPUT Policy Coverage ProductCode
WL1PA
INPUT Policy Coverage ProductVersionCode
1
INPUT Policy Life CurrIntRate
0
INPUT Policy LifeParticipant IssueGender
1
INPUT Policy LifeParticipant UnderwritingClass
1
INPUT Policy LifeParticipant TobaccoPremiumBasis
1
INPUT Policy LifeParticipant TempTableRating
1
INPUT Policy LifeParticipant PermTableRating
1
INPUT Policy Number of LifeParticipant
1
INPUT Policy LifeParticipant PermFlatExtraAmount
0
INPUT Policy LifeParticipant TempFlatExtraAmount
0
INPUT Policy Coverage CurrentNumberOfUnits
1000
INPUT Policy Life DivOnDepositAmt
0
INPUT Policy Life DivOnDepositIntRate
0
INPUT Policy Life DivType
2
INPUT Payment Mode
1
INPUT Forced Payment Mode
0
INPUT Mode Premium Calc Option
0
INPUT Commission Premium Calc Ind
0
INPUT Specified Phase
0
INPUT Specified Element
C
INPUT Specified Element Index
0
INPUT Premium Type
P
INPUT Premium Subtype
R
INPUT Rate Info Passed Ind
1
INPUT Payment Form
0
INPUT Rate Assumption
C
INPUT Policy Coverage LifeCovTypeCode
1
INPUT Policy Coverage PremiumPerUnit
10
INPUT Policy LifeParticipant ParticipantRoleCode
1
INPUT Message Language
9
INPUT Policy Number Of CoverageOption
0
INPUT Policy LifeParticipant number of SubstandardRating
0
INPUT Invest Rate Type
11
INPUT Invest Rate Sub Type
1
INPUT Illus FaceAmtDesignType
1000500001
INPUT Policy Coverage RequestedEffDur
1
INPUT Policy Coverage RequestedMaturityDur
20
INPUT Policy Coverage CurrentAmt
1000
INPUT Illus DivType[2]
162
INPUT Illus DivType[3]
161
INPUT Illus DivType[4]
162
INPUT Illus DivType[5]
161
INPUT Illus WithdrawalDesignType
1000500001
INPUT Policy Number of Loan
0
X53 19c36d8 19b8c30 19c5700 19c6300 0 0 2
ULLoan Maximum Pref Loan Amount
ULLoan Maximum Pref Loan Amount
100
Input TransEffDate
01/01/2011
INPUT Calling Program

INPUT Policy EffDate
01/01/2006
INPUT Policy ProductCode
UL1PA
INPUT Policy Loan LoanIntTiming
1
INPUT Policy Loan LoanIntType
2
INPUT Calling System
I1
INPUT Policy CarrierCode
00
INPUT Policy ProductVersionCode

INPUT Policy Jurisdiction
1000
INPUT Message Language
English
INPUT Policy number of Coverage
1
INPUT Policy Coverage IndicatorCode
1
INPUT Policy Coverage LifeCovStatus
1
INPUT Policy Coverage EffDate
01/01/2006
INPUT Policy Coverage TermDate
12/31/2999
INPUT Policy Coverage CurrentNumberOfUnits
1000
INPUT Policy LifeParticipant IssueAge
35
INPUT Policy Coverage ProductCode
WL1PA
INPUT Policy Coverage ProductVersionCode
1
INPUT Policy LifeParticipant IssueGender
1
INPUT Policy LifeParticipant UnderwritingClass
1
INPUT Policy LifeParticipant TobaccoPremiumBasis
1
INPUT Policy LifeParticipant TempTableRating
1
INPUT Policy LifeParticipant PermTableRating
1
INPUT Policy Number of LifeParticipant
1
INPUT Policy LifeParticipant PermFlatExtraAmount
0
INPUT Policy LifeParticipant TempFlatExtraAmount
0
INPUT Policy Number of ParAccumValues
0
INPUT Policy Life DivType
2
INPUT Payment Mode
2
INPUT Forced Payment Mode
0
INPUT Mode Premium Calc Option
0
INPUT Commission Premium Calc Ind
0
INPUT Specified Phase
0
INPUT Specified Element
C
INPUT Specified Element Index
0
INPUT Premium Type
P
INPUT Premium Subtype
R
INPUT Rate Info Passed Ind
1
INPUT Payment Form
0
INPUT Rate Assumption
C
INPUT Policy Coverage LifeCovTypeCode
1
INPUT Policy Coverage PremiumPerUnit
10
INPUT Policy LifeParticipant ParticipantRoleCode
1
INPUT Policy Number Of CoverageOption
0
INPUT Policy LifeParticipant number of SubstandardRating
0
INPUT Policy Number of Loan
1
INPUT Policy Life CashValueAmt
1000
INPUT Policy Loan LoanType
1
INPUT Policy Loan LoanType[1]
2
INPUT Policy Loan LoanOriginationDate
01/01/2006
X51 19c5700 19c36d8 0 0 0 0 2
ULLoan Pref Loan Validation
ULLoan Pref Loan Validation
1
Input TransEffDate
01/01/2011
INPUT Calling Program

INPUT Policy EffDate
01/01/2006
INPUT Policy ProductCode
UL1PA
INPUT Policy Loan LoanIntTiming
1
INPUT Policy Loan LoanIntType
2
INPUT Calling System
I1
INPUT Policy CarrierCode
00
INPUT Policy ProductVersionCode

INPUT Policy Jurisdiction
1000
INPUT Message Language
English
INPUT Policy number of Coverage
1
INPUT Policy Coverage IndicatorCode
1
INPUT Policy Coverage LifeCovStatus
1
INPUT Policy Coverage EffDate
01/01/2006
INPUT Policy Coverage TermDate
12/31/2999
INPUT Policy Coverage CurrentNumberOfUnits
1000
INPUT Policy LifeParticipant IssueAge
35
INPUT Policy Coverage ProductCode
WL1PA
INPUT Policy Coverage ProductVersionCode
1
INPUT Policy LifeParticipant IssueGender
1
INPUT Policy LifeParticipant UnderwritingClass
1
INPUT Policy LifeParticipant TobaccoPremiumBasis
1
INPUT Policy LifeParticipant TempTableRating
1
INPUT Policy LifeParticipant PermTableRating
1
INPUT Policy Number of LifeParticipant
1
INPUT Policy LifeParticipant PermFlatExtraAmount
0
INPUT Policy LifeParticipant TempFlatExtraAmount
0
INPUT Policy Number of ParAccumValues
0
INPUT Policy Life DivType
2
INPUT Payment Mode
2
INPUT Forced Payment Mode
0
INPUT Mode Premium Calc Option
0
INPUT Commission Premium Calc Ind
0
INPUT Specified Phase
0
INPUT Specified Element
C
INPUT Specified Element Index
0
INPUT Premium Type
P
INPUT Premium Subtype
R
INPUT Rate Info Passed Ind
1
INPUT Payment Form
0
INPUT Rate Assumption
C
INPUT Policy Coverage LifeCovTypeCode
1
INPUT Policy Coverage PremiumPerUnit
10
INPUT Policy LifeParticipant ParticipantRoleCode
1
INPUT Policy Number Of CoverageOption
0
INPUT Policy LifeParticipant number of SubstandardRating
0
INPUT Policy Number of Loan
2
INPUT Policy Loan LoanType
2
INPUT Policy Loan LoanType[1]
2
X35 19c6300 19b8c30 19c7458 19c85b0 0 0 2
OUTPUT Life RegularLoanBalance
OUTPUT Life RegularLoanBalance
1128.7318697443
INPUT Calling Program

INPUT Policy EffDate
01/01/2006
INPUT Policy Loan LoanOriginationDate
01/01/2006
INPUT Policy Loan LoanAmt
1000
INPUT Policy ProductCode
UL1PA
Input TransEffDate
01/01/2008
INPUT Policy LifeParticipant IssueAge
35
INPUT Policy LifeParticipant IssueGender
1
INPUT Policy LifeParticipant UnderwritingClass
1
INPUT Policy LifeParticipant TobaccoPremiumBasis
1
INPUT Policy Coverage BandCode
2
INPUT Policy Jurisdiction
1000
INPUT Policy Loan LoanType
2
INPUT Calling System
I1
INPUT Policy CarrierCode
00
INPUT Policy ProductVersionCode

INPUT Policy Loan LoanIntTiming
0
INPUT Policy number of FinancialActivity
1
INPUT Policy FinancialActivity FinActivityType
2
INPUT Policy FinancialActivity FinEffDate
01/01/2007
INPUT Policy FinancialActivity FinActivityNetAmount
100
INPUT Policy Loan LoanOriginationDate[1]
01/01/2006
INPUT Policy LifeParticipant IssueAge[1]
35
INPUT Policy LifeParticipant IssueGender[1]
1
INPUT Policy LifeParticipant UnderwritingClass[1]
1
INPUT Policy LifeParticipant TobaccoPremiumBasis[1]
1
INPUT Policy Coverage BandCode[1]
0
INPUT Policy Loan LoanType[1]
2
INPUT Policy Loan LoanAmt[1]
500
INPUT Policy Number of Loan
01
INPUT Policy Loan LoanIntMethod
0
INPUT Policy FinancialActivity FinActivityNetAmt
0
INPUT Message Language
English
INPUT Policy Coverage IndicatorCode
1
X26 19c7458 19c6300 0 19c7ef8 0 0 2
OUTPUT Loan LoanBalance(loanIndex)
'OUTPUT Loan LoanBalance'(0)
1015.8586827699
INPUT Calling Program

INPUT Policy EffDate
01/01/2006
INPUT Policy Loan LoanOriginationDate
01/01/2006
INPUT Policy Loan LoanAmt
1000
INPUT Policy ProductCode
UL1PA
Input TransEffDate
01/01/2008
INPUT Policy LifeParticipant IssueAge
35
INPUT Policy LifeParticipant IssueGender
1
INPUT Policy LifeParticipant UnderwritingClass
1
INPUT Policy LifeParticipant TobaccoPremiumBasis
1
INPUT Policy Coverage BandCode
0
INPUT Policy Jurisdiction
1000
INPUT Policy Loan LoanType
2
INPUT Calling System
I1
INPUT Policy CarrierCode
00
INPUT Policy ProductVersionCode

INPUT Policy Loan LoanIntTiming
0
INPUT Policy number of FinancialActivity
1
INPUT Policy FinancialActivity FinActivityType
2
INPUT Policy FinancialActivity FinEffDate
01/01/2007
INPUT Policy FinancialActivity FinActivityNetAmount
100
INPUT Policy Loan LoanIntMethod
0
INPUT Policy FinancialActivity FinActivityNetAmt
100
INPUT Message Language
English
INPUT Policy Coverage IndicatorCode
1
X34 19c7ef8 19c6300 0 0 0 0 2
OUTPUT Loan LoanBalance(loanIndex)
'OUTPUT Loan LoanBalance'(1)
564.3659348722
INPUT Calling Program

INPUT Policy EffDate
01/01/2006
INPUT Policy Loan LoanOriginationDate
01/01/2006
INPUT Policy Loan LoanAmt
1000
INPUT Policy ProductCode
UL1PA
Input TransEffDate
01/01/2008
INPUT Policy LifeParticipant IssueAge
35
INPUT Policy LifeParticipant IssueGender
1
INPUT Policy LifeParticipant UnderwritingClass
1
INPUT Policy LifeParticipant TobaccoPremiumBasis
1
INPUT Policy Coverage BandCode
0
INPUT Policy Jurisdiction
1000
INPUT Policy Loan LoanType
2
INPUT Calling System
I1
INPUT Policy CarrierCode
00
INPUT Policy ProductVersionCode

INPUT Policy Loan LoanIntTiming
0
INPUT Policy number of FinancialActivity
1
INPUT Policy FinancialActivity FinActivityType
2
INPUT Policy FinancialActivity FinEffDate
01/01/2007
INPUT Policy FinancialActivity FinActivityNetAmount
100
INPUT Policy Loan LoanOriginationDate[1]
01/01/2006
INPUT Policy LifeParticipant IssueAge[1]
35
INPUT Policy LifeParticipant IssueGender[1]
1
INPUT Policy LifeParticipant UnderwritingClass[1]
1
INPUT Policy LifeParticipant TobaccoPremiumBasis[1]
1
INPUT Policy Coverage BandCode[1]
0
INPUT Policy Loan LoanType[1]
2
INPUT Policy Loan LoanAmt[1]
500
INPUT Policy Loan LoanIntMethod
0
INPUT Policy FinancialActivity FinActivityNetAmt
0
INPUT Message Language
English
INPUT Policy Coverage IndicatorCode
1
X44 19c85b0 19b8c30 0 19c90d0 0 0 2
ULLoan Current Unloaned Cash Value
ULLoan Current Unloaned Cash Value("C")
29610.404
Input TransEffDate
01/01/2007
INPUT Calling Program

INPUT Policy number of Coverage
1
INPUT Policy Coverage IndicatorCode
1
INPUT Policy Coverage LifeCovStatus
1
INPUT Policy Coverage EffDate
01/01/2006
INPUT Policy Coverage TermDate
12/31/2999
INPUT Policy EffDate
01/01/2006
INPUT Policy Coverage CurrentNumberOfUnits
1000
INPUT Policy LifeParticipant IssueAge
35
INPUT Policy ProductCode
UL1PA
INPUT Calling System
I1
INPUT Policy CarrierCode
00
INPUT Policy ProductVersionCode

INPUT Policy Jurisdiction
1000
INPUT Policy Coverage ProductCode
WL1PA
INPUT Policy Coverage ProductVersionCode
1
INPUT Policy LifeParticipant IssueGender
1
INPUT Policy LifeParticipant UnderwritingClass
1
INPUT Policy LifeParticipant TobaccoPremiumBasis
1
INPUT Policy LifeParticipant TempTableRating
1
INPUT Policy LifeParticipant PermTableRating
1
INPUT Policy Number of LifeParticipant
1
INPUT Policy LifeParticipant PermFlatExtraAmount
0
INPUT Policy LifeParticipant TempFlatExtraAmount
0
INPUT Policy Number of ParAccumValues
0
INPUT Policy Life DivType
0
INPUT Policy Number of Loan
1
INPUT Policy Coverage BandCode
0
INPUT Policy Loan LoanType
2
INPUT Policy Loan LoanIntTiming
0
INPUT Policy Loan LoanOriginationDate
01/01/2007
INPUT Policy Loan LoanAmt
1000
INPUT Policy number of FinancialActivity
0
INPUT Policy LifeParticipant IssueAge[1]
35
INPUT Policy LifeParticipant IssueGender[1]
1
INPUT Policy LifeParticipant UnderwritingClass[1]
1
INPUT Policy LifeParticipant TobaccoPremiumBasis[1]
1
INPUT Policy Coverage BandCode[1]
0
INPUT Policy Loan LoanType[1]
2
INPUT Policy Life CashValueAmt
30610.404
INPUT Policy Loan LoanIntMethod
0
INPUT Message Language
English
X43 19c90d0 19b8c30 0 19ca288 0 0 2
ULLoan Interest Deduction(startDate; endDate)
ULLoan Interest Deduction("C";"01/01/2006"; "01/01/2007")
57.5
Input TransEffDate
01/01/2007
INPUT Calling Program

INPUT Policy number of Coverage
1
INPUT Policy Coverage IndicatorCode
1
INPUT Policy Coverage LifeCovStatus
1
INPUT Policy Coverage EffDate
01/01/2006
INPUT Policy Coverage TermDate
12/31/2999
INPUT Policy EffDate
01/01/2006
INPUT Policy Coverage CurrentNumberOfUnits
1000
INPUT Policy LifeParticipant IssueAge
35
INPUT Policy ProductCode
UL1PA
INPUT Calling System
I1
INPUT Policy CarrierCode
00
INPUT Policy ProductVersionCode

INPUT Policy Jurisdiction
1000
INPUT Policy Coverage ProductCode
WL1PA
INPUT Policy Coverage ProductVersionCode
1
INPUT Policy LifeParticipant IssueGender
1
INPUT Policy LifeParticipant UnderwritingClass
1
INPUT Policy LifeParticipant TobaccoPremiumBasis
1
INPUT Policy LifeParticipant TempTableRating
1
INPUT Policy LifeParticipant PermTableRating
1
INPUT Policy Number of LifeParticipant
1
INPUT Policy LifeParticipant PermFlatExtraAmount
0
INPUT Policy LifeParticipant TempFlatExtraAmount
0
INPUT Policy Number of ParAccumValues
0
INPUT Policy Life DivType
0
INPUT Policy Number of Loan
1
INPUT Policy Coverage BandCode
0
INPUT Policy Loan LoanType
2
INPUT Policy Loan LoanIntTiming
0
INPUT Policy Loan LoanOriginationDate
01/01/2007
INPUT Policy Loan LoanAmt
1000
INPUT Policy number of FinancialActivity
0
INPUT Policy LifeParticipant IssueAge[1]
35
INPUT Policy LifeParticipant IssueGender[1]
1
INPUT Policy LifeParticipant UnderwritingClass[1]
1
INPUT Policy LifeParticipant TobaccoPremiumBasis[1]
1
INPUT Policy Coverage BandCode[1]
0
INPUT Policy Loan LoanType[1]
2
INPUT Policy Loan LoanIntMethod
0
INPUT Message Language
English
X19 19ca288 19b8c30 0 19cafe0 0 0 2
ULLoan Proj Interest Rate(rateAssumption; yearIndex; loanIndex)
ULLoan Proj Interest Rate("C";1)
0.0575
INPUT Policy ProductCode
UL1PA
INPUT Calling Program

INPUT Calling System
I1
Input TransEffDate
01/01/2006
INPUT Policy LifeParticipant IssueAge
35
INPUT Policy LifeParticipant IssueGender
1
INPUT Policy LifeParticipant UnderwritingClass
1
INPUT Policy LifeParticipant TobaccoPremiumBasis
1
INPUT Illus FaceAmtDesignType
1000500001
INPUT Policy number of Coverage
1
INPUT Policy Coverage CurrentAmt
100000
INPUT Policy Jurisdiction
1000
INPUT Policy CarrierCode
00
INPUT Policy ProductVersionCode

INPUT Policy EffDate
01/01/2006
INPUT Policy Coverage BandCode
0
INPUT Message Language
English
INPUT Policy Coverage IndicatorCode
1
X30 19cafe0 19b8c30 0 0 0 0 2
ULLoan Base Balance(startDate; endDate; loanIndex)
ULLoan Current Balance("C";0)
1014.7091643916
INPUT Policy Loan LoanOriginationDate
01/01/2006
INPUT Policy Loan LoanAmt
1000
INPUT Policy FinancialActivity FinEffDate
03/15/2006
INPUT Calling Program

INPUT Policy EffDate
01/01/2006
INPUT Policy ProductCode
UL1PA
INPUT Policy LifeParticipant IssueAge
35
INPUT Policy LifeParticipant IssueGender
1
INPUT Policy LifeParticipant UnderwritingClass
1
INPUT Policy LifeParticipant TobaccoPremiumBasis
1
Input TransEffDate
04/01/2006
INPUT Policy Coverage BandCode
0
INPUT Policy Jurisdiction
1000
INPUT Policy Loan LoanType
2
INPUT Calling System
I1
INPUT Policy CarrierCode
00
INPUT Policy ProductVersionCode

INPUT Policy Loan LoanIntTiming
2
INPUT Policy number of FinancialActivity
2
INPUT Policy FinancialActivity FinActivityType
2
INPUT Policy FinancialActivity FinActivityNetAmt
0
INPUT Policy FinancialActivity FinEffDate[1]
03/16/2006
INPUT Policy FinancialActivity FinActivityType[1]
2
INPUT Policy FinancialActivity FinActivityNetAmt[1]
0
INPUT Policy Loan LoanOriginationDate[1]
0
INPUT Policy FinancialActivity FinEffDate[2]
0
INPUT Policy Loan LoanIntMethod
1
INPUT Message Language
English
INPUT Policy Coverage IndicatorCode
1
X16 19cb6d0 3f4048 0 76e93d86 0 0 2
ULLoan Maximum Pref Loan Amount
ULLoan Maximum Pref Loan Amount
100
Input TransEffDate
01/01/2006
INPUT Calling Program
VPMSTEST
INPUT Calling System
CL
INPUT Policy EffDate
01/01/2006
INPUT Policy ProductCode
UL1PA
INPUT Policy Loan LoanIntTiming
1
INPUT Policy Loan LoanIntType
2
INPUT PolicyProduct LoanProvision FirstYearAvailable
0
INPUT PolicyProduct LoanProvision MaxAvailableCalculation
7
INPUT PolicyProduct LoanProvision MaxAvailablePercent
0
INPUT Policy Number of Loan
0
INPUT Policy Life CashValueAmt
1000
INPUT Policy CarrierCode
00
INPUT Policy ProductVersionCode

INPUT Policy Jurisdiction
1000
X17 76e93d86 3f4048 0 6e03c45f 0 0 2
OUTPUT Maximum Pref Loan Amount
OUTPUT Maximum Pref Loan Amount
100
Input TransEffDate
01/01/2006
INPUT Calling Program
VPMSTEST
INPUT Calling System
CL
INPUT Policy ProductCode
UL1PA
INPUT Policy Loan LoanIntTiming
1
INPUT Policy Loan LoanIntType
2
INPUT Policy CarrierCode
00
INPUT Policy ProductVersionCode

INPUT Policy Jurisdiction
1000
INPUT Policy EffDate
01/01/2006
INPUT PolicyProduct LoanProvision FirstYearAvailable
0
INPUT PolicyProduct LoanProvision MaxAvailableCalculation
1
INPUT Policy Number of Loan
0
INPUT Policy Life CashValueAmt
1000
INPUT PolicyProduct LoanProvision MaxAvailablePercent
75
INPUT Policy Life PaymentAmt
800
X22 6e03c45f 3f4048 0 5f9c1939 0 0 2
OUTPUT MaxLoanAmount
OUTPUT MaxLoanAmount
978.22
Input TransEffDate
01/01/2006
INPUT Calling Program
VPMSTEST
INPUT Calling System
CL
INPUT Policy ProductCode
JSVUL1PA
INPUT Policy Loan LoanIntTiming
1
INPUT Policy Loan LoanIntType
2
INPUT Policy CarrierCode
00
INPUT Policy ProductVersionCode

INPUT Policy Jurisdiction
1000
INPUT Policy EffDate
01/01/2006
INPUT PolicyProduct LoanProvision FirstYearAvailable
0
INPUT PolicyProduct LoanProvision MaxAvailableCalculation
1
INPUT Policy Number of Loan
0
INPUT Policy Life CashValueAmt
1000
INPUT PolicyProduct LoanProvision MaxAvailablePercent
75
INPUT Policy Life PaymentAmt
800
INPUT Policy ChargeTotalAmt
0.22
INPUT Policy Arrangement ArrType
31
INPUT Policy number of Coverage
1
INPUT Policy Coverage SurrTargetPrem
11888.2
INPUT Policy Coverage SurrChargeITD
0
X80 5f9c1939 3f4048 0 0 0 0 2
OUTPUT MAXLOANAMOUNT
OUTPUT MAXLOANAMOUNT

INPUT CALLING PROGRAM
CKULLNMB
INPUT CALLING SYSTEM
CL
INPUT MESSAGE LANGUAGE
9
INPUT TRANSEFFDATE
09/01/2012
INPUT POLICY POLNUMBER
PVU100009D
INPUT POLICY PRODUCTCODE
JSVUL1PA
INPUT POLICY PRODUCTTYPE
3
INPUT POLICY PRODUCTVERSIONCODE

INPUT POLICY CARRIERCODE
00
INPUT POLICY CHARGETOTALAMT
0.22
INPUT POLICY EFFDATE
06/01/2010
INPUT POLICY JURISDICTION
22
INPUT POLICYPRODUCT AGECALCULATIONTYPE
2
INPUT POLICYPRODUCT GUARINTRATE
3.500
INPUT POLICYPRODUCT MORTALITYORMORBIDITYTABLE
136
INPUT POLICYPRODUCT NUMBER OF FEE
0
INPUT POLICY LIFE CASHVALUEAMT
6926.04
INPUT POLICY LIFE PAYMENTAMT
0.00
INPUT POLICY LIFE SURRENDERCHARGEAMT
1188.82
INPUT POLICY ARRANGEMENT ARRTYPE
31
INPUT POLICY NUMBER OF COVERAGE
1
INPUT POLICY COVERAGE BANDCODE[0]
0
INPUT POLICY COVERAGE CURRENTAMT[0]
1000000.00
INPUT POLICY COVERAGE DEATHBENEFITOPTTYPE[0]
1
INPUT POLICY COVERAGE EFFDATE[0]
06/01/2010
INPUT POLICY COVERAGE INDICATORCODE[0]
1
INPUT POLICY COVERAGE INITCOVAMT[0]
1000000.00
INPUT POLICY COVERAGE PRODUCTCODE[0]
JSVUL1PA
INPUT POLICY COVERAGE PRODUCTVERSIONCODE[0]
1
INPUT POLICY COVERAGE SURRCHARGEITD[0]
0.00
INPUT POLICY COVERAGE SURRTARGETPREM[0]
11888.20
INPUT POLICY COVERAGEOPTION PRODUCTCODE[0;0]
ADBPA
INPUT POLICY COVERAGEOPTION PRODUCTCODE[0;1]
WSPPA
INPUT POLICY COVERAGEPRODUCT DBDECREASEORDERTYPE[0]
1
INPUT POLICY COVERAGEPRODUCT LIVESTYPE[0]
3
INPUT POLICY COVERAGEPRODUCT MATURITYAGE[0]
121
INPUT POLICY NUMBER OF LIFEPARTICIPANT[0]
2
INPUT POLICY LIFEPARTICIPANT ISSUEAGE[0;0]
30
INPUT POLICY LIFEPARTICIPANT ISSUEAGE[0;1]
30
INPUT POLICY LIFEPARTICIPANT ISSUEGENDER[0;0]
2
INPUT POLICY LIFEPARTICIPANT ISSUEGENDER[0;1]
1
INPUT POLICY LIFEPARTICIPANT LIFEPARTICIPANTROLECODE[0;0]
1
INPUT POLICY LIFEPARTICIPANT LIFEPARTICIPANTROLECODE[0;1]
6
INPUT POLICY LIFEPARTICIPANT NUMBER OF SUBSTANDARDRATING[0;0]
1
INPUT POLICY LIFEPARTICIPANT NUMBER OF SUBSTANDARDRATING[0;1]
1
INPUT POLICY LIFEPARTICIPANT PERMFLATEXTRAAMT[0;0]
0.00
INPUT POLICY LIFEPARTICIPANT PERMFLATEXTRAAMT[0;1]
0.00
INPUT POLICY LIFEPARTICIPANT PERMTABLERATING[0;0]
1
INPUT POLICY LIFEPARTICIPANT PERMTABLERATING[0;1]
1
INPUT POLICY LIFEPARTICIPANT SUBSTANDARDRATING TEMPFLATENDDATE[0;0;0]
01/01/1900
INPUT POLICY LIFEPARTICIPANT SUBSTANDARDRATING TEMPFLATENDDATE[0;1;0]
01/01/1900
INPUT POLICY LIFEPARTICIPANT SUBSTANDARDRATING TEMPFLATEXTRAAMT[0;0;0]
0.00
INPUT POLICY LIFEPARTICIPANT SUBSTANDARDRATING TEMPFLATEXTRAAMT[0;1;0]
0.00
INPUT POLICY LIFEPARTICIPANT SUBSTANDARDRATING TEMPFLATSTARTDATE[0;0;0]
01/01/1900
INPUT POLICY LIFEPARTICIPANT SUBSTANDARDRATING TEMPFLATSTARTDATE[0;1;0]
01/01/1900
INPUT POLICY LIFEPARTICIPANT TEMPFLATENDDATE[0;0]
01/01/1900
INPUT POLICY LIFEPARTICIPANT TEMPFLATENDDATE[0;1]
01/01/1900
INPUT POLICY LIFEPARTICIPANT TEMPFLATENDDURATION[0;0]
0.00
INPUT POLICY LIFEPARTICIPANT TEMPFLATENDDURATION[0;1]
0.00
INPUT POLICY LIFEPARTICIPANT TEMPFLATEXTRAAMT[0;0]
0.00
INPUT POLICY LIFEPARTICIPANT TEMPFLATEXTRAAMT[0;1]
0.00
INPUT POLICY LIFEPARTICIPANT TEMPFLATSTARTDATE[0;0]
01/01/1900
INPUT POLICY LIFEPARTICIPANT TEMPFLATSTARTDATE[0;1]
01/01/1900
INPUT POLICY LIFEPARTICIPANT TEMPTABLERATING[0;0]
1
INPUT POLICY LIFEPARTICIPANT TEMPTABLERATING[0;1]
1
INPUT POLICY LIFEPARTICIPANT TEMPTABLERATINGENDDATE[0;0]
01/01/1900
INPUT POLICY LIFEPARTICIPANT TEMPTABLERATINGENDDATE[0;1]
01/01/1900
INPUT POLICY LIFEPARTICIPANT TOBACCOPREMIUMBASIS[0;0]
2
INPUT POLICY LIFEPARTICIPANT TOBACCOPREMIUMBASIS[0;1]
2
INPUT POLICY LIFEPARTICIPANT UNDERWRITINGCLASS[0;0]
1
INPUT POLICY LIFEPARTICIPANT UNDERWRITINGCLASS[0;1]
1
INPUT POLICY NUMBER OF LOAN
1
INPUT POLICY LOAN LOANAMT[0]
200.00
INPUT POLICY LOAN LOANINTMETHOD[0]
2
INPUT POLICY LOAN LOANINTTIMING
1
INPUT POLICY LOAN LOANORIGINATIONDATE[0]
08/01/2012
INPUT POLICY LOAN LOANTYPE[0]
2
INPUT POLICY LOAN REPAYDUEDATE[0]
01/01/1900
INPUT PolicyProduct LoanProvision RateVariation TableRefKey
02
O0 3f3f04 0 0 0 0 0 0

E0 3f3f70 0 0 0 0 0 0

L0 3f3fdc 0 0 0 0 0 0

B0 3f418c 0 0 0 0 0 0

P3 3f40b4 0 19cbeb8 0 0 0 2

--description
Loans can be taken against the cash value of Univeral Life or Variable Universal Life contracts. The model will support loans taken at any date after issue of the policy, dependent on the total projected amount of the loans not exceeding the maximum loan amount. The model will support additional loan segments on subsequent dates. The model will support the following methods of loan reductions:Cash payment reduction Projection of loan values will include both fixed and variable interest, calculated both in advance and in arrears. The model will return the current and projected cash value of the loan. The model will return the maximum loan amount and maximum remaining loan amount, based on the current loan value, cash value of the policy. It will not handle the calculation of the current or projected cash value of the policy  this will be obtained from the CashValueProjections model. RELEASE LOG:RELEASE 1301 - SCARAB/JIRA issues pA2118RELEASE 1101 - PAC019 Rate Access via InputsRELEASE 1101 - PAC013 calcType
LICENSENAME
"CSC US internal use only - Workbench"
COMPILERVERSION
"4.6.1    "
P13 19cbeb8 3f40b4 19cc7c0 0 0 0 2
Universal Life
IncType
mandatory
IncRule

IncValue

OUTPUT Comment
"Model:   Maximum Loan amount calculations for Universal Life products. Date:     12/03/2008  Modification Log: DateModelerChange Description 12/03/2008CSCInitial model"
OUTPUT Runtime Version
"1.0.00"
OUTPUT Runtime Date
"12/12/2016"
OUTPUT Source Version Computer
"VPMS_SERVER"
OUTPUT Source Version File
"ULLoans.pms"
OUTPUT Source Version Number
'GEN VersionInfo'
OUTPUT Source Version Date
"12/12/2016"
OUTPUT Source Version Author
"CSC"
OUTPUT Source Version Comment
"PA1603 Delivery"
OUTPUT Audit History Block
"12/12/2016 PA1603 Delivery"
P13 19cc7c0 19cbeb8 0 0 0 0 2
Loans
IncType
mandatory
IncRule

IncValue

OUTPUT Life RegularLoanBalance
'ULLoan Total Current Balance'('GEN Vector Blank')
OUTPUT Projected Life RegularLoanBalance(rateAssumption; yearIndex)
IF ( /* loan amount is negative */ 'ULLoan Total Projected Balance'(rateAssumption;yearIndex;'ULLoan Loan Vector Build'(rateAssumption;yearIndex;'GEN Vector Blank';'Vector ULCD CVProj Parms'(rateAssumption;yearIndex))) < 0 ;    /* Return zero */ 0 ;    /* Return loan amount */ 'ULLoan Total Projected Balance'(rateAssumption;yearIndex;'ULLoan Loan Vector Build'(rateAssumption;yearIndex;'GEN Vector Blank';'Vector ULCD CVProj Parms'(rateAssumption;yearIndex))))
OUTPUT Loan LoanBalance(loanIndex)
'ULLoan Current Balance'('GEN Vector Blank';loanIndex)
OUTPUT MaxLoanAmount
'ULLoan Maximum Loan Amount'('GEN Vector Blank')
OUTPUT Total Capitalized Interest(loanIndex)
IF ('PI LoanProvision LoanIntTiming'('Policy ProductCode';'Policy EffDate';'Constant LoanType Regular') = 'Constant IntTiming Advance' ;   'ULLoan Total Current Interest'('GEN Vector Blank') ;   0)
OUTPUT Loan LoanIntAmountDue(loanIndex)
IF ('PI LoanProvision LoanIntTiming'('Policy ProductCode';'Policy EffDate';'Constant LoanType Regular') = 'Constant IntTiming Advance' ;   'ULLoan Current Interest'('GEN Vector Blank';loanIndex) ;   0)
OUTPUT Projected Total Capitalized Interest(rateAssumption; yearIndex)
IF ('PI LoanProvision LoanIntTiming'('Policy ProductCode';'Policy EffDate';'Constant LoanType Regular') = 'Constant IntTiming Advance' ;   'ULLoan Total Projected Current Interest'(rateAssumption;yearIndex;'ULLoan Loan Vector Build'(rateAssumption;yearIndex;'GEN Vector Blank';'Vector ULCD CVProj Parms'(rateAssumption;yearIndex))) ;   0)
OUTPUT Maximum Pref Loan Amount
'ULLoan Maximum Pref Loan Amount'
OUTPUT Illus LoanAmt(rateAssumption; yearIndex)
'ULLoan LoanAmt'(rateAssumption;yearIndex;'ULLoan Loan Vector Build'(rateAssumption;yearIndex;'GEN Vector Blank';'Vector ULCD CVProj Parms'(rateAssumption;yearIndex)))
OUTPUT Illus LoanRepayment(rateAssumption; yearIndex)
'ULLoan Total Loan RepaymentAmt'(rateAssumption;yearIndex;'ULLoan Loan Vector Build'(rateAssumption;yearIndex;'GEN Vector Blank';'Vector ULCD CVProj Parms'(rateAssumption;yearIndex)))
F0 3f4120 0 19ccc08 0 0 0 0

F1 19ccc08 3f4120 19cce98 0 0 0 2
:ULLoan
Funktion

F1 19cce98 19ccc08 19ccf78 19d04c0 0 0 2
-- Current Loan Balance --
Funktion

F1 19ccf78 19cce98 19cd0c8 0 0 0 2
ULLoan Total Current Balance(calcType)
Funktion
SUMX(loanIndex;0;'Policy Number of Loan' - 1;'ULLoan Current Balance'(calcType;#loanIndex))
F1 19cd0c8 19ccf78 19cd2a0 19cf970 0 0 2
ULLoan Current Balance(calcType; loanIndex)
Funktion
MAX(IF ('Policy Loan LoanIntMethod'(loanIndex) = 2 ;   'ULLoan Current Balance at Time'(calcType;loanIndex;TransEffDate) ;   'ULLoan Base Balance At Time'(calcType;loanIndex;TransEffDate) + 'ULLoan Current Interest At Time'(calcType;loanIndex;TransEffDate));0)
F1 19cd2a0 19cd0c8 19cd358 0 0 0 2
ULLoan Current Balance at Time(calcType; loanIndex; point_in_time_date)
Funktion
'GEN Round'('ULLoan Current Balance Accrual'(calcType;point_in_time_date;0;loanIndex) - SUMX(financialActivityIndex;0;'Policy Number of FinancialActivity' - 1;'ULLoan Repayments For Period'(calcType;#financialActivityIndex;loanIndex;0;'Policy Loan LoanOriginationDate'(loanIndex);point_in_time_date));10)
F1 19cd358 19cd2a0 0 19cdb88 0 0 2
ULLoan Current Balance Accrual(calcType; endDate; loanBalance; loanIndex)
Funktion
IF ( /*At Issue*/ 'DATE Are Dates Equal'(endDate;'Policy EffDate') ;    /* Yes: add loan if on issue */ loanBalance + IF ( /*Loan on issue*/ 'DATE Are Dates Equal'('Policy Loan LoanOriginationDate'(loanIndex);'Policy EffDate') ;      /*Yes: add loan amount*/ 'Policy Loan LoanAmt'(loanIndex) ;      /*No*/ 0  ) ;  /*No: Accrue loan balance*/ 'ULLoan Current Balance Accrual'(calcType;'ULLoan Calc Strict Last Anniversary Date'('Policy EffDate';endDate);loanBalance;loanIndex) * 'ULLoan Interest Factor For Period'('ULLoan Curr Interest Rate'(calcType;'ULLoan Calc Strict Last Anniversary Date'('Policy EffDate';endDate);loanIndex);endDate;'ULLoan Calc Strict Last Anniversary Date'('Policy EffDate';endDate)) + IF ( /*Loan in first year*/ 'DATE Date In Range'('Policy Loan LoanOriginationDate'(loanIndex);DATE('ULLoan Calc Strict Last Anniversary Date'('Policy EffDate';endDate);1;0;0);endDate) ;    /*Yes: Add loan amount with interest*/ 'Policy Loan LoanAmt'(loanIndex) * 'ULLoan Interest Factor For Period'('ULLoan Curr Interest Rate'(calcType;'ULLoan Calc Strict Last Anniversary Date'('Policy EffDate';endDate);loanIndex);endDate;'Policy Loan LoanOriginationDate'(loanIndex)) ;    /*No*/ 0))
F1 19cdb88 19cd2a0 0 19ce580 0 0 2
ULLoan Activity Accrual For Period(calcType; activityNetAmt; loanIndex; activityDate; startDate; endDate)
Funktion
IF ( /*Activity in date range*/ 'DATE Date In Range'(activityDate;date(startDate;1;0;0);endDate) ;    /*Yes: Add amount, with interest*/ IF ( /*Activity Date before prev Anniv*/ 'DATE Is Date1 Greater Than Date2'(activityDate;'ULLoan Calc Strict Last Anniversary Date'('Policy EffDate';endDate)) ;      /*Yes: Accumulate till Activity Date*/ activityNetAmt * 'ULLoan Interest Factor For Period'('ULLoan Curr Interest Rate'(calcType;'ULLoan Calc Strict Last Anniversary Date'('Policy EffDate';endDate);loanIndex);endDate;activityDate) ;      /*No: Continue yearly Accrual*/ 'ULLoan Activity Accrual For Period'(calcType;activityNetAmt * 'ULLoan Interest Factor For Period'('ULLoan Curr Interest Rate'(calcType;'ULLoan Calc Strict Last Anniversary Date'('Policy EffDate';endDate);loanIndex);endDate;'ULLoan Calc Strict Last Anniversary Date'('Policy EffDate';endDate));loanIndex;'ULLoan Calc Strict Last Anniversary Date'('Policy EffDate';activityDate);startDate;'ULLoan Calc Strict Last Anniversary Date'('Policy EffDate';endDate))  ) ;  /*No: Determine if at Issue*/ IF ( /*At Issue*/ 'DATE Are Dates Equal'(startDate;activityDate) ;    /*Yes: Add with Interest*/ IF ( /*At Start*/ 'DATE Are Dates Equal'(endDate;activityDate) ;      /*End Accrual*/ activityNetAmt ;      /*Continue Accrual*/ IF ( /*Activity Date before prev Anniv*/ 'DATE Is Date1 Greater Than Date2'(activityDate;'ULLoan Calc Strict Last Anniversary Date'('Policy EffDate';endDate)) ;        /*Yes: Accumulate till anniv*/ activityNetAmt * 'ULLoan Interest Factor For Period'('ULLoan Curr Interest Rate'(calcType;'ULLoan Calc Strict Last Anniversary Date'('Policy EffDate';endDate);loanIndex);endDate;activityDate) ;        /*No: Continue yearly Accrual*/ 'ULLoan Activity Accrual For Period'(calcType;activityNetAmt * 'ULLoan Interest Factor For Period'('ULLoan Curr Interest Rate'(calcType;'ULLoan Calc Strict Last Anniversary Date'('Policy EffDate';endDate);loanIndex);endDate;'ULLoan Calc Strict Last Anniversary Date'('Policy EffDate';endDate));loanIndex;activityDate;startDate;'ULLoan Calc Strict Last Anniversary Date'('Policy EffDate';endDate))    )) ;  /*No*/ 0))
F1 19ce580 19cd2a0 19ce9b8 0 0 0 2
ULLoan Repayments For Period(calcType;financialActivityIndex; loanIndex; loanBalance; startDate; endDate)
Funktion
IF ( /*Activity is Loan Payment*/ (('FinActivityType is Loan Payment'('Policy FinancialActivity FinActivityType'(financialActivityIndex)) || 'FinActivityType is Loan Payment From Dividends'('Policy FinancialActivity FinActivityType'(financialActivityIndex))) && 'DATE Date In Range'('Policy FinancialActivity FinEffDate'(financialActivityIndex);DATE(startDate;0;0;0);endDate)) ;    /*Yes: Add amount with interest*/ 'ULLoan Activity Accrual For Period'(calcType;'ULLoan Payment Amount Remaining'(calcType;LoanIndex;0;'ULLoan Payment Amount on Day'(0;financialActivityIndex;0);'Policy FinancialActivity FinEffDate'(financialActivityIndex));loanIndex;'Policy FinancialActivity FinEffDate'(financialActivityIndex);startDate;endDate) ;    /*No*/ 0)
F1 19ce9b8 19ce580 0 19cf060 0 0 2
ULLoan Payment Amount Remaining(calcType; endLoanIndex; currentLoanIndex; activityGrossAmnt; financialActivityDate)
Funktion
IF ( /*All loans cycled through*/ currentLoanIndex = endLoanIndex ;    /*Yes: Use maximum of activity amount possible*/ MIN('ULLoan Current Balance Accrual'(calcType;financialActivityDate;0;currentLoanIndex) - SUMX(financialActivityIndex;0;'Policy Number of FinancialActivity' - 1;'ULLoan Repayments For Period'(calcType;#financialActivityIndex;currentLoanIndex;0;'Policy EffDate';DATE(financialActivityDate;-1;0;0))) * 'ULLoan Interest Factor For Period'('ULLoan Curr Interest Rate'(calcType;'ULLoan Calc Strict Last Anniversary Date'('Policy EffDate';financialActivityDate);currentLoanIndex);financialActivityDate;DATE(financialActivityDate;-1;0;0));activityGrossAmnt) ;    /*No: Continue to previous loans*/ IF ( /*Loan settled*/ 'ULLoan Current Balance at Time'(calcType;currentLoanIndex;financialActivityDate) = 0 ;      /*Yes: Pass full activity amount to next loan*/ 'ULLoan Payment Amount Remaining'(calcType;endLoanIndex;currentLoanIndex + 1;activityGrossAmnt - 'ULLoan Payment Amount Remaining'(calcType;currentLoanIndex;currentLoanIndex;activityGrossAmnt;financialActivityDate);financialActivityDate) ;      /*No: Pass reduced amount to next loan*/ 'ULLoan Payment Amount Remaining'(calcType;endLoanIndex;currentLoanIndex + 1;MAX(activityGrossAmnt - 'ULLoan Current Balance Accrual'(calcType;financialActivityDate;0;currentLoanIndex);0);financialActivityDate)  ))
F1 19cf060 19ce580 0 0 0 0 2
ULLoan Payment Amount on Day(currentFinancialActivityIndex; selectedFinancialActivityIndex; activityGrossAmount)
Funktion
IF ( /*All financial activities cycled through*/ currentFinancialActivityIndex = 'Policy Number of FinancialActivity' ;    /*Yes: Use total amount for day*/ activityGrossAmount ;    /*No: Continue with summation*/ IF ( /*Lower indexed activity*/ currentFinancialActivityIndex < selectedFinancialActivityIndex ;     IF ( /*Yes: Already had activity on this day?*/ 'DATE Are Dates Equal'('Policy FinancialActivity FinEffDate'(currentFinancialActivityIndex);'Policy FinancialActivity FinEffDate'(selectedFinancialActivityIndex)) ;        /*Yes: Don't use this activity (previously accounted for*/ 0 ;        /*No: Continue with summation*/ 'ULLoan Payment Amount on Day'(currentFinancialActivityIndex + 1;selectedFinancialActivityIndex;0)    ) ;   IF ( /*No: This (cycled) activity on same date?*/ 'DATE Are Dates Equal'('Policy FinancialActivity FinEffDate'(currentFinancialActivityIndex);'Policy FinancialActivity FinEffDate'(selectedFinancialActivityIndex)) ;      /*Yes: Add amount to running total, continue with summation*/ 'ULLoan Payment Amount on Day'(currentFinancialActivityIndex + 1;selectedFinancialActivityIndex;activityGrossAmount + 'Policy FinancialActivity FinActivityNetAmt'(currentFinancialActivityIndex)) ;      /*No: Continue with summation, with current amount*/ 'ULLoan Payment Amount on Day'(currentFinancialActivityIndex + 1;selectedFinancialActivityIndex;activityGrossAmount)  )))
F1 19cf970 19ccf78 19cfab8 0 0 0 2
ULLoan Total Current Interest(calcType)
Funktion
SUMX(loanIndex;0;'Policy Number of Loan' - 1;'ULLoan Current Interest'(calcType;#loanIndex))
F1 19cfab8 19cf970 0 19cfba0 0 0 2
ULLoan Current Interest(calcType;loanIndex)
Funktion
'ULLoan Current Balance at Time'(calcType;loanIndex;TransEffDate) - 'ULLoan Base Balance At Time'(calcType;loanIndex;TransEffDate)
F1 19cfba0 19cf970 19cff68 0 0 0 2
ULLoan Current Interest At Time(calcType;loanIndex; pointInTimeDate)
Funktion
'ULLoan Current Balance at Time'(calcType;loanIndex;pointInTimeDate) - 'ULLoan Base Balance At Time'(calcType;loanIndex;pointInTimeDate)
F1 19cff68 19cfba0 0 19d0020 0 0 2
ULLoan Base Balance At Time(calcType; loanIndex; pointInTimeDate)
Funktion
'ULLoan Base Balance Iteration'(calcType;loanIndex;'Policy Number of FinancialActivity' - 1;'Calc Last Monthiversary Date'('Policy Loan LoanOriginationDate'(loanIndex);date(pointInTimeDate;-1;0;0));pointInTimeDate)
F1 19d0020 19cfba0 0 0 0 0 2
ULLoan Base Balance Iteration(calcType; loanIndex; financialActivityIndex; startDate; endDate)
Funktion
IF ( /*At Loan Origination*/ financialActivityIndex < 0 || 'DATE Are Dates Equal'('Policy Loan LoanOriginationDate'(loanIndex);startDate) ;    /*Yes: Use Initial Loan Amoun*/ 'Policy Loan LoanAmt'(loanIndex) ;    /*No: Calculate remaining base loan amount*/ IF ( /*Financial Activities in date range*/ 'DATE Date In Range'('Policy FinancialActivity FinEffDate'(max(financialActivityIndex;0));startDate;endDate) ;      /*Determine whether base loan amount decreases*/ MIN('ULLoan Base Balance Iteration'(calcType;loanIndex;financialActivityIndex;startDate;date('Policy FinancialActivity FinEffDate'(max(financialActivityIndex;0));-1;0;0));'ULLoan Current Balance at Time'(calcType;loanIndex;'Policy FinancialActivity FinEffDate'(max(financialActivityIndex;0)))) ;      /*Cycle through next period*/ 'ULLoan Base Balance Iteration'(calcType;loanIndex;financialActivityIndex - 1;'Calc Last Monthiversary Date'('Policy Loan LoanOriginationDate'(loanIndex);date(startDate;-1;0;0));startDate)  ))
F1 19d04c0 19ccc08 19d0880 19d1b78 0 0 2
-- Projected Loan Balance --
Funktion

F1 19d0880 19d04c0 19d0938 19d1070 0 0 2
ULLoan Total Projected Balance(calcType; yearIndex; vectorULloans)
Funktion
IF ( //Loans not used in 7702 projectionNOT('Std Calling System Is Illustration Based') || 'CalcType 7702 Is Active'(calcType) || 'CalcType Target Is Active'(calcType) ;   0 ;   'ULLoan Projected Balance'(calcType;yearIndex;vectorULloans)) /*IF('ULLoan NumberofLoans'(calcType; yearIndex; vectorULloans)>0;IF('PI LoanProvision LoanIntTiming'('Policy ProductCode'; 'Policy EffDate'; 'Constant LoanType Regular') = 'Constant IntTiming Arrears';SUMX(loanIndex; 0; 'ULLoan NumberofLoans'(calcType; yearIndex; vectorULloans)-1;          'ULLoan Projected Balance'(calcType; yearIndex; #loanIndex; vectorULloans))    -    SUMX(loanIndex; 0; 'ULLoan NumberofLoans'(calcType; yearIndex; vectorULloans)-1;'ULLoan Projected Interest'(calcType; yearIndex; #loanIndex; vectorULloans));SUMX(loanIndex; 0; 'ULLoan NumberofLoans'(calcType; yearIndex; vectorULloans)-1;'ULLoan Projected Balance'(calcType; yearIndex; #loanIndex; vectorULloans)));0)*/ 
F1 19d0938 19d0880 19d0a48 0 0 0 2
ULLoan Projected Balance(calcType; yearIndex; vectorULloans)
Funktion
MAX(0;'GEN Round'('ULLoan Projected Balance Accrual'(calcType;yearIndex;vectorULloans);2)) + IF ('ULLoan Projected Balance Accrual'(calcType;yearIndex;vectorULloans) < 0 && 'ULLoan Projected Balance Accrual'(calcType;yearIndex - 1;'ULLoan Loan Vector Build'(calcType;yearIndex - 1;'SharedVector ULLoans SolveParmsVector'(vectorULloans);'SharedVector ULLoans AddInfoVector'(vectorULloans))) > 0 ;   MESSAGE('Messages SystemMessage'("CA1055";'Message Language';v_("Loans";"Loan Projected Balance Accrual";yearIndex;ROUND(-'ULLoan Projected Balance Accrual'(calcType;yearIndex;vectorULloans);2)));0) ;   0)
F1 19d0a48 19d0938 19d0e58 0 0 0 2
ULLoan Projected Balance Accrual(calcType; yearIndex; vectorULloans)
Funktion
IF (yearIndex = 0 ;   0 ;   ('ULLoan Projected Balance Accrual'(calcType;yearIndex - 1;'ULLoan Loan Vector Build'(calcType;yearIndex - 1;'SharedVector ULLoans SolveParmsVector'(vectorULloans);'SharedVector ULLoans AddInfoVector'(vectorULloans))) + 'ULLoan LoanAmt'(calcType;yearIndex;vectorULloans) - 'ULLoan Projected Premium Repayment'(calcType;yearIndex;vectorULloans)) * 'ULLoan Interest Factor Modal'(calcType;yearIndex))
F1 19d0e58 19d0a48 0 0 0 0 2
ULLoan Projected Premium Repayment(calcType; yearIndex; vectorULloans)
Funktion
'ULLoan RepaymentAmt'(calcType;yearIndex;vectorULloans) * 'ULLoan Annuity Payment Accumulation'('ULLoan Interest Rate Modal'(calcType;yearIndex);'ULLoan PaymentMode')
F1 19d1070 19d04c0 19d1188 13919a2c 0 0 2
ULLoan Total Projected Current Interest(calcType; yearIndex; vectorULloans)
Funktion
 /*SUMX(loanIndex; 0; 'ULLoan NumberofLoans'(calcType; yearIndex; vectorULloans)-1; 'ULLoan Projected Interest'(calcType; yearIndex; #loanIndex; vectorULloans))*/ IF ( //Loans not used in 7702 projectionNOT('Std Calling System Is Illustration Based') || 'CalcType 7702 Is Active'(calcType) || 'CalcType Target Is Active'(calcType) ;   0 ;   'ULLoan Projected Interest'(calcType;yearIndex;vectorULloans))
F1 19d1188 19d1070 0 0 0 0 2
ULLoan Projected Interest(calcType; yearIndex; vectorULloans)
Funktion
'GEN Round'('ULLoan Projected Balance'(calcType;yearIndex;vectorULloans) - 'ULLoan Projected Balance'(calcType;yearIndex - 1;'ULLoan Loan Vector Build'(calcType;yearIndex - 1;'SharedVector ULLoans SolveParmsVector'(vectorULloans);'SharedVector ULLoans AddInfoVector'(vectorULloans))) - 'ULLoan LoanAmt'(calcType;yearIndex;vectorULloans) + 'ULLoan Projected Premium Repayment'(calcType;yearIndex;vectorULloans);2)
F1 13919a2c 19d04c0 0 7ad8137c 0 0 2
ULLoan Projected PreferredLoan Balance(calcType; yearIndex; vectorULloans)
Funktion
IF ('ULLoan Total Projected Balance'(calcType;yearIndex;vectorULloans) > 0 && 'ULLoan Preferred Loans Allowed'(calcType) ;   MIN('ULLoan Total Projected Balance'(calcType;yearIndex;vectorULloans);'ULLoan Projected Maximum Pref Loan Amount'(calcType;yearIndex;vectorULloans)) ;   0)
F1 7ad8137c 19d04c0 0 55c10139 0 0 2
ULLoan Projected RegularLoan Balance(calcType; yearIndex; vectorULloans)
Funktion
'ULLoan Total Projected Balance'(calcType;yearIndex;vectorULloans) - 'ULLoan Projected PreferredLoan Balance'(calcType;yearIndex;vectorULloans)
F1 55c10139 19d04c0 0 0 0 0 2
ULLoan Total Loan RepaymentAmt(calcType; yearIndex; vectorULloans)
Funktion
'ULLoan Projected Premium Repayment'(calcType;yearIndex;vectorULloans)
F1 19d1b78 19ccc08 19d1f88 19d5570 0 0 2
-- Current Maximum Loan Remaining --
Funktion

F1 19d1f88 19d1b78 19d20f0 19d43f8 0 0 2
ULLoan Maximum Loan Amount(calcType)
Funktion
MAX('ULLoan Current Unloaned Cash Value'(calcType) - 'ULLoan Total Min Balance Amount'(calcType);0)
F1 19d20f0 19d1f88 19d2250 19d42c8 0 0 2
ULLoan Total Min Balance Amount(calcType)
Funktion
'ULLoan Primary Min Balance Amount'(calcType) + 'ULLoan Secondary Min Balance Amount'(calcType) + 'ULLoan Tertiary Min Balance Amount'(calcType)
F1 19d2250 19d20f0 0 19d2800 0 0 2
ULLoan Primary Min Balance Amount(calcType)
Funktion
IF (LEFT('PI LoanProvision MinBalanceCalcRule MinBalanceCalcRuleType'('Policy ProductCode';'Policy EffDate';'Constant BalanceType Remaining';1);5) ALIKE "ERROR" ;    /* Yes - No Primary Min Balance Rule*/ 0 ;    /*No - Primary Min Balance Rule Exists*/ 'ULLoan Min Balance Amount'(calcType;'PI LoanProvision MinBalanceCalcRule MinBalanceCalcRuleType'('Policy ProductCode';'Policy EffDate';'Constant BalanceType Remaining';1);'Constant BalanceType Remaining';1))
F1 19d2800 19d20f0 0 19d28e8 0 0 2
ULLoan Secondary Min Balance Amount(calcType)
Funktion
IF (LEFT('PI LoanProvision MinBalanceCalcRule MinBalanceCalcRuleType'('Policy ProductCode';'Policy EffDate';'Constant BalanceType Remaining';2);5) ALIKE "ERROR" ;    /* Yes - No Secondary Min Balance Rule*/ 0 ;    /*No - Secondary Min Balance Rule Exists*/ 'ULLoan Min Balance Amount'(calcType;'PI LoanProvision MinBalanceCalcRule MinBalanceCalcRuleType'('Policy ProductCode';'Policy EffDate';'Constant BalanceType Remaining';2);'Constant BalanceType Remaining';2))
F1 19d28e8 19d20f0 0 19d2b60 0 0 2
ULLoan Tertiary Min Balance Amount(calcType)
Funktion
IF (LEFT('PI LoanProvision MinBalanceCalcRule MinBalanceCalcRuleType'('Policy ProductCode';'Policy EffDate';'Constant BalanceType Remaining';3);5) ALIKE "ERROR" ;    /* Yes - No Tertiary Min Balance Rule*/ 0 ;    /*No - Tertiary Min Balance Rule Exists*/ 'ULLoan Min Balance Amount'(calcType;'PI LoanProvision MinBalanceCalcRule MinBalanceCalcRuleType'('Policy ProductCode';'Policy EffDate';'Constant BalanceType Remaining';3);'Constant BalanceType Remaining';3))
F1 19d2b60 19d20f0 19d3570 0 0 0 2
ULLoan Min Balance Amount(calcType; typeAssumption; balanceType; sequenceKey)
Funktion
MAX(CASE( /*Minimum remaining unloaned CV balance calculation type*/ typeAssumption;   //flat amount1 : 'PI LoanProvision MinBalanceCalcRule FlatAmount'('Policy ProductCode';'Policy EffDate';balanceType;sequenceKey);   //number of months of COI2 : 'PI LoanProvision MinBalanceCalcRule MinMonthCOI'('Policy ProductCode';'Policy EffDate';balanceType;sequenceKey) * 'StdPolicy ChargeTotalAmt';   //monthly deduction to the next anniversary3 : 'ULLoan Deductions to Next Anniversary'(TransEffDate;'ULLoan Calc Strict Next Anniversary Date'('Policy EffDate';TransEffDate));   //full surrender charge5 : 'ULLoan Full Surrender Charge'(calcType);   //percent of surrender value6 : (1 - 'PI LoanProvision MinBalanceCalcRule MinPct'('Policy ProductCode';'Policy EffDate';balanceType;sequenceKey) / 100) * 'ULLoan Surrender Value';   //percent of unloaned cash value7 : (1 - 'PI LoanProvision MinBalanceCalcRule MinPct'('Policy ProductCode';'Policy EffDate';balanceType;sequenceKey) / 100) * 'ULLoan Current Unloaned Cash Value'(calcType);   //loan Interest to next anniversary8 : 'ULLoan Interest Deduction'(calcType;TransEffDate;'ULLoan Calc Strict Next Anniversary Date'('Policy EffDate';TransEffDate));   //loan Interest to scheduled repayment date9 : 'ULLoan Interest Deduction'(calcType;TransEffDate;'Policy Loan RepayDueDate'(0));   //Policy RepayDueDate expects loanIndex//none11 : 0;   //charges to the next anniversary16 : 'ULLoan Deductions to Next Anniversary'(TransEffDate;'ULLoan Calc Strict Next Anniversary Date'('Policy EffDate';TransEffDate));   //else, none : 0);0)
F1 19d3570 19d2b60 0 19d3670 0 0 2
ULLoan Full Surrender Charge(calcType)
Funktion
'ULSC Surrender Charge'(calcType)
F1 19d3670 19d2b60 0 19d37c0 0 0 2
ULLoan Deductions to Next Anniversary(startDate; endDate)
Funktion
'StdPolicy ChargeTotalAmt' * 'Number of Months'(startDate;endDate)
F1 19d37c0 19d2b60 0 19d3c50 0 0 2
ULLoan Surrender Value
Funktion
'Policy Life CashValueAmt' - 'Policy Life SurrenderChargeAmt'
F1 19d3c50 19d2b60 19d3d08 0 0 0 2
ULLoan Interest Deduction(calcType; startDate; endDate)
Funktion
SUMX(loanIndex;0;'Policy Number of Loan' - 1;'ULLoan Current Balance'(calcType;#loanIndex) * IF ('PI LoanProvision LoanIntTiming'('Policy ProductCode';'Policy EffDate';'Constant LoanType Regular') = 'Constant IntTiming Advance' ;   'ULLoan AdvanceIntFactor'(calcType;startDate;#loanIndex) ;   'ULLoan ArrearsIntFactor'(calcType;'Policy Loan LoanOriginationDate'(#loanIndex);startDate;endDate;#loanIndex)))
F1 19d3d08 19d3c50 0 19d3e10 0 0 2
ULLoan ArrearsIntFactor(calcType;loanDate; startDate; endDate; loanIndex)
Funktion
IF ('Years Between Dates'(loanDate;endDate) > 1 ;   'ULLoan Curr Interest Rate'(calcType;startDate;loanIndex) ;   ((1 + 'ULLoan Curr Interest Rate'(calcType;startDate;loanIndex)) ^ ('DATE Days Difference'(endDate;startDate) / 'ULLoan Days in Policy Year'(startDate)) - 1))
F1 19d3e10 19d3c50 0 0 0 0 2
ULLoan AdvanceIntFactor(calcType; startDate; loanIndex)
Funktion
'ULLoan Curr Interest Rate'(calcType;startDate;loanIndex)
F1 19d42c8 19d1f88 0 0 0 0 2
ULLoan Current Unloaned Cash Value(calcType)
Funktion
'Policy Life CashValueAmt' - 'ULLoan Total Current Balance'(calcType)
F1 19d43f8 19d1b78 19d48d8 0 0 0 2
ULLoan Maximum Pref Loan Amount
Funktion
IF ( /*Preferred Loan Available*/ 'ULLoan Pref Loan Validation' ;    /*Yes: Calculate maximum preferred loan amount*/ CASE( /*Preferred Loan Calculation Type*/ 'PI LoanProvision MaxAvailableCalculation'('Policy ProductCode';'Policy EffDate';'Constant LoanType Preferred');     //Not applicable. Preferred loans are not allowed.0 : 0;     /*The maximum preferred loan amount is equal to a percent of the total cash value. This option limits the preferred loan requests to one per policy year and does not support annual reallocation. */ 1 : 'Policy Life CashValueAmt' * 'PI LoanProvision MaxAvailablePercent'('Policy ProductCode';'Policy EffDate';'Constant LoanType Preferred') / 100;     /*2 The maximum preferred loan amount is calculated as the gain on the policy.Do not reallocate on the policy anniversary. */ 2 : 'Policy Life CashValueAmt' - 'ULLoan Premium Payments';     : 0)   ;    /*No: Return 0*/ 0)
F1 19d48d8 19d43f8 19d4d58 19d50b8 0 0 2
ULLoan Pref Loan Validation
Funktion
'ULLoan Pref Loan Duration Exceeds Minimum' = 0 && CASE( /*Preferred Loan Calculation Type*/ 'PI LoanProvision MaxAvailableCalculation'('Policy ProductCode';'Policy EffDate';'Constant LoanType Preferred');   //Not applicable. Preferred loans are not allowed.0 : 0;   /*The maximum preferred loan amount is equal to a percent of the total cash value. This option limits the preferred loan requests to one per policy year and does not support annual reallocation. */ 1 : 'ULLoan Pref Loan First Of Year' = 0;   /*2 The maximum preferred loan amount is calculated as the gain on the policy.Do not reallocate on the policy anniversary. */ 2 : 1;   : 0)
F1 19d4d58 19d48d8 0 19d4fc8 0 0 2
ULLoan Pref Loan First Of Year
Funktion
SUMX(loanIndex;0;'Policy Number of Loan' - 1;IF ( /*Loan is preferred & taken in this duration year*/ 'Policy Loan LoanType'(#loanIndex) = 1 && 'DATE Date In Range'('Policy Loan LoanOriginationDate'(#loanIndex);'Calc Last Anniversary Date'('Policy EffDate';TransEffDate);'Calc Next Anniversary Date'('Policy EffDate';TransEffDate)) ;    /*Yes*/ 1 ;    /*No*/ 0))
F1 19d4fc8 19d48d8 0 0 0 0 2
ULLoan Pref Loan Duration Exceeds Minimum
Funktion
IF ( /*Duration exceeds minimum prescribed*/ 'Duration Year'(TransEffDate;'Policy EffDate') >= 'PI LoanProvision FirstYearAvailable'('Policy ProductCode';'Policy EffDate';'Constant LoanType Preferred') ;    /*Yes*/ 0 ;    /*No*/ 1)
F1 19d50b8 19d43f8 0 0 0 0 2
ULLoan Premium Payments
Funktion
'Policy Life PaymentAmt'
F1 19d5570 19ccc08 19d5658 19d8b40 0 0 2
-- Projected Maximum Loan Remaining --
Funktion

F1 19d5658 19d5570 19d5768 19d7d20 0 0 2
ULLoan Projected Maximum Loan Amount(calcType; yearIndex; vectorULloans)
Funktion
MAX('ULLoan Projected Unloaned Cash Value'(calcType;yearIndex;vectorULloans) - 'ULLoan Projected Total Min Balance Amount'(calcType;yearIndex;vectorULloans);0)
F1 19d5768 19d5658 19d5c50 19d7738 0 0 2
ULLoan Projected Total Min Balance Amount(calcType; yearIndex; vectorULloans)
Funktion
'ULLoan Projected Primary Min Balance Amount'(calcType;yearIndex;vectorULloans) + 'ULLoan Projected Secondary Min Balance Amount'(calcType;yearIndex;vectorULloans) + 'ULLoan Projected Tertiary Min Balance Amount'(calcType;yearIndex;vectorULloans)
F1 19d5c50 19d5768 0 19d6140 0 0 2
ULLoan Projected Primary Min Balance Amount(calcType; yearIndex; vectorULloans)
Funktion
IF (LEFT('PI LoanProvision MinBalanceCalcRule MinBalanceCalcRuleType'('Policy ProductCode';'Policy EffDate';'Constant BalanceType Remaining';1);5) ALIKE "error" ;    /* Yes - No Primary Min Balance Rule*/ 0 ;    /*No - Primary Min Balance Rule Exists*/ 'ULLoan Projected Min Balance Amount'(calcType;yearIndex;vectorULloans;'PI LoanProvision MinBalanceCalcRule MinBalanceCalcRuleType'('Policy ProductCode';'Policy EffDate';'Constant BalanceType Remaining';1);'Constant BalanceType Remaining';1))
F1 19d6140 19d5768 0 19d6258 0 0 2
ULLoan Projected Secondary Min Balance Amount(calcType; yearIndex; vectorULloans)
Funktion
IF (LEFT('PI LoanProvision MinBalanceCalcRule MinBalanceCalcRuleType'('Policy ProductCode';'Policy EffDate';'Constant BalanceType Remaining';2);5) ALIKE "error" ;    /* Yes - No Secondary Min Balance Rule*/ 0 ;    /*No - Secondary Min Balance Rule Exists*/ 'ULLoan Projected Min Balance Amount'(calcType;yearIndex;vectorULloans;'PI LoanProvision MinBalanceCalcRule MinBalanceCalcRuleType'('Policy ProductCode';'Policy EffDate';'Constant BalanceType Remaining';2);'Constant BalanceType Remaining';2))
F1 19d6258 19d5768 0 19d6918 0 0 2
ULLoan Projected Tertiary Min Balance Amount(calcType; yearIndex; vectorULloans)
Funktion
IF (LEFT('PI LoanProvision MinBalanceCalcRule MinBalanceCalcRuleType'('Policy ProductCode';'Policy EffDate';'Constant BalanceType Remaining';3);5) ALIKE "error" ;    /* Yes - No Tertiary Min Balance Rule*/ 0 ;    /*No - Tertiary Min Balance Rule Exists*/ 'ULLoan Projected Min Balance Amount'(calcType;yearIndex;vectorULloans;'PI LoanProvision MinBalanceCalcRule MinBalanceCalcRuleType'('Policy ProductCode';'Policy EffDate';'Constant BalanceType Remaining';3);'Constant BalanceType Remaining';3))
F1 19d6918 19d5768 19d7160 0 0 0 2
ULLoan Projected Min Balance Amount(calcType; yearIndex; vectorULloans; typeAssumption; balanceType; sequenceKey)
Funktion
MAX(CASE( /*Minimum remaining unloaned CV balance calculation type*/ typeAssumption;   //flat amount1 : 'PI LoanProvision MinBalanceCalcRule FlatAmount'('Policy ProductCode';'Policy EffDate';balanceType;sequenceKey);   //monthly deduction to the next anniversary3 : 'ULLoan Projected Deductions to Next Anniversary'(vectorULloans);   //full surrender charge5 : 'ULLoan Projected Full Surrender Charge'(calcType;yearIndex);   //percent of surrender value6 : IF (isnumber('PI LoanProvision MinBalanceCalcRule MinPct'('Policy ProductCode';'Policy EffDate';balanceType;sequenceKey)) ;     'PI LoanProvision MinBalanceCalcRule MinPct'('Policy ProductCode';'Policy EffDate';balanceType;sequenceKey) ;     0  ) / 100 * 'ULLoan Projected Surrender Value'(calcType;yearIndex;vectorULloans); //percent of unloaned cash value7 : (1 - IF (isnumber('PI LoanProvision MinBalanceCalcRule MinPct'('Policy ProductCode';'Policy EffDate';balanceType;sequenceKey)) ;   'PI LoanProvision MinBalanceCalcRule MinPct'('Policy ProductCode';'Policy EffDate';balanceType;sequenceKey) ;   0) / 100) * 'ULLoan Projected Unloaned Cash Value'(yearIndex;calcType;vectorULloans); //loan interest to next anniversary8 : 'ULLoan Projected Interest Deduction'(calcType;yearIndex;'Increase Date By Period'('Policy EffDate';yearIndex;1);'Increase Date By Period'('Policy EffDate';yearIndex + 1;1);vectorULloans); //loan interest to scheduled repayment date9 : 'ULLoan Projected Interest Deduction'(calcType;yearIndex;'Policy EffDate';'Increase Date By Period'('Policy EffDate';yearIndex;1);vectorULloans); //none11 : 0; //else : 0);0)
F1 19d7160 19d6918 0 19d7358 0 0 2
ULLoan Projected Surrender Value(calcType; yearIndex; vectorULloans)
Funktion
'ULLoan Projected Unloaned Cash Value'(calcType;yearIndex;vectorULloans) - 'ULSC Projected Full Surrender Charge'(calcType;yearIndex;" ") //'WLCashValue Proj Total Cash Value'(calcType; yearIndex; vectorWLProj)
F1 19d7358 19d6918 19d7a08 19d74b8 0 0 2
ULLoan Projected Interest Deduction(calcType; yearIndex; startDate; endDate; vectorULloans)
Funktion
'ULLoan Projected Balance'(calcType;yearIndex;vectorULloans) * IF ('PI LoanProvision LoanIntTiming'('Policy ProductCode';'Policy EffDate';'Constant LoanType Regular') = 'Constant IntTiming Advance' ;   'ULLoan Proj AdvanceIntFactor'(calcType;yearIndex) ;   'ULLoan Proj ArrearsIntFactor'(calcType;yearIndex))
F1 19d7a08 19d7358 0 19d7f70 0 0 2
ULLoan Proj ArrearsIntFactor(calcType; yearIndex)
Funktion
'ULLoan Proj Interest Rate'(calcType;yearIndex) / 100
F1 19d7f70 19d7358 0 0 0 0 2
ULLoan Proj AdvanceIntFactor(calcType; yearIndex)
Funktion
'ULLoan Proj Interest Rate'(calcType;yearIndex) / 100
F1 19d74b8 19d6918 0 19d75f0 0 0 2
ULLoan Projected Full Surrender Charge(calcType; yearIndex)
Funktion
'ULSC Projected Full Surrender Charge'(calcType;yearIndex;'GEN Vector Blank')
F1 19d75f0 19d6918 0 0 0 0 2
ULLoan Projected Deductions to Next Anniversary(vectorULloans)
Funktion
'SharedVector ULLoans MonthlyCharge'(vectorULloans) * 12
F1 19d7738 19d5658 0 19d7c10 0 0 2
ULLoan Projected Maximum Loan Amount Start of Year(calcType; yearIndex; vectorULloans)
Funktion
 //IF(/*At policy inception*/yearIndex = 1; ///*CV = 0, no loans available*///0; ///*Else maximum loan amount as end of previous year*/'ULLoan Projected Maximum Loan Amount'(calcType;yearIndex /*- 1*/ ;vectorULloans) //)
F1 19d7c10 19d5658 0 0 0 0 2
ULLoan Projected Unloaned Cash Value(calcType; yearIndex; vectorULloans)
Funktion
'SharedVector ULLoans PrevCVEOM'(vectorULloans) - 'ULLoan Total Projected Balance'(calcType;yearIndex - 1;vectorULloans)
F1 19d7d20 19d5570 19d89a8 0 0 0 2
ULLoan Projected Maximum Pref Loan Amount(calcType; yearIndex; vectorULloans)
Funktion
MIN('ULLoan Projected Maximum Loan Amount'(calcType;yearIndex;vectorULloans);IF ( /*Preferred Loan Available*/ 'ULLoan Projected Pref Loan Validation'(calcType;yearIndex;vectorULloans) ;    /*Yes: Calculate maximum preferred loan amount*/ CASE( /*Preferred Loan Calculation Type*/ 'PI LoanProvision MaxAvailableCalculation'('Policy ProductCode';'Policy EffDate';'Constant LoanType Preferred') && NOT('Illustration Type is DeferredComp'('STD Illus Type Code'));     //Not applicable. Preferred loans are not allowed.0 : 0;     /*The maximum preferred loan amount is equal to a percent of the total cash value. This option limits the preferred loan requests to one per policy year and does not support annual reallocation. */ 1 : 'ULLoan Projected Unloaned Cash Value'(calcType;yearIndex;vectorULloans) * 'PI LoanProvision MaxAvailablePercent'('Policy ProductCode';'Policy EffDate';'Constant LoanType Preferred') / 100;     /*2 The maximum preferred loan amount is calculated as the gain on the policy.Do not reallocate on the policy anniversary. */ 2 :  // 'WLCashValue Proj Total Cash Value'(calcType; yearIndex; vectorWLProj) -MAX('ULLoan Projected Unloaned Cash Value'(calcType;yearIndex;vectorULloans) - 'ULLoan Projected Premium Payments'(yearIndex;vectorULloans);0);     : 0)   ;    /*No: Return 0*/ 0))
F1 19d89a8 19d7d20 0 19d7fe8 0 0 2
ULLoan Projected Maximum Pref Loan Amount Start of Year(calcType; yearIndex; vectorULloans)
Funktion
IF ( /*At policy inception*/ yearIndex = 1 ;    /*CV = 0, no loans available*/ 0 ;    /*Else maximum loan amount as end of previous year*/ 'ULLoan Projected Maximum Pref Loan Amount'(calcType;yearIndex - 1;vectorULloans))
F1 19d7fe8 19d7d20 19d80e8 19d8a20 0 0 2
ULLoan Projected Pref Loan Validation(calcType; yearIndex; vectorULloans)
Funktion
'ULLoan Projected Pref Loan Duration Exceeds Minimum'(yearIndex) = 0 && CASE( /*Preferred Loan Calculation Type*/ 'PI LoanProvision MaxAvailableCalculation'('Policy ProductCode';'Policy EffDate';'Constant LoanType Preferred');   //Not applicable. Preferred loans are not allowed.0 : 0;   /*The maximum preferred loan amount is equal to a percent of the total cash value. This option limits the preferred loan requests to one per policy year and does not support annual reallocation. */ 1 : 'ULLoan Projected Pref Loan First Of Year'(calcType;yearIndex;vectorULloans) = 0;   /*2 The maximum preferred loan amount is calculated as the gain on the policy.Do not reallocate on the policy anniversary. */ 2 : 1;   : 0)
F1 19d80e8 19d7fe8 0 19d8200 0 0 2
ULLoan Projected Pref Loan First Of Year(calcType; yearIndex; vectorULloans)
Funktion
SUMX(loanIndex;0;'ULLoan NumberofLoans'(calcType;yearIndex;vectorULloans) - 1;IF ( /*Loan is preferred & taken in this duration year*/ 'ULLoan Proj LoanType'(calcType;#loanIndex;vectorULloans) = 1 && 'ULLoan Proj StartYear'(calcType;#loanIndex;vectorULloans) = yearIndex ;    /*Yes*/ 1 ;    /*No*/ 0))
F1 19d8200 19d7fe8 0 0 0 0 2
ULLoan Projected Pref Loan Duration Exceeds Minimum(yearIndex)
Funktion
IF ( /*Duration exceeds minimum prescribed*/ yearIndex >= 'PI LoanProvision FirstYearAvailable'('Policy ProductCode';'Policy EffDate';'Constant LoanType Preferred') ;    /*Yes*/ 0 ;    /*No*/ 1)
F1 19d8a20 19d7d20 0 0 0 0 2
ULLoan Projected Premium Payments(yearIndex; vectorULloans)
Funktion
'SharedVector ULLoans PeriodicPremium'(vectorULloans;yearIndex)
F1 19d8b40 19ccc08 19d8c20 19d96e8 0 0 2
-- Loan Interest Functions --
Funktion

F1 19d8c20 19d8b40 0 19d8d60 0 0 2
ULLoan Annuity Payment Accumulation(interestRate; paymentMode)
Funktion
((1 + interestRate) ^ paymentMode - 1) / interestRate
F1 19d8d60 19d8b40 3612502a 19d99e0 0 0 2
ULLoan Interest Factor For Period(interestRate; endDate; startDate)
Funktion
IF ( /*Interest is in Advance*/ 'PI LoanProvision LoanIntTiming'('Policy ProductCode';'Policy EffDate';'Constant LoanType Regular') = 'Constant IntTiming Advance' ;   1 / (1 - interestRate) ^ ('DATE Days Difference'(endDate;startDate) / 'ULLoan Days in Policy Year'(startDate)) ;   (1 + interestRate) ^ ('DATE Days Difference'(endDate;startDate) / 'ULLoan Days in Policy Year'(startDate)))
F1 3612502a 19d8d60 8219a0f 19d9120 0 0 2
ULLoan Curr Interest Rate(calcType; startDate; loanIndex)
Funktion
IF ('PI Use Attributes'("Policy Loan LoanInterestRate") ;   'Policy Loan LoanInterestRate'(loanIndex) ;   Rate('Policy ProductCode';"LOANINT";'Policy Effdate';'ULLoan RateVector'(calcType;'Duration Year'(startDate;'Policy EffDate');loanIndex)) / 100)
F1 8219a0f 3612502a 0 0 0 0 2
ULLoan RateVector(calcType; yearIndex; loanIndex)
Funktion
V_('Policy LifeParticipant IssueAge'(calcType;0;0);yearIndex;'Policy LifeParticipant IssueGender'(calcType;0;0);'Policy LifeParticipant UnderwritingClass'(calcType;0;0;yearIndex);'Policy LifeParticipant TobaccoPremiumBasis'(calcType;0;0;yearIndex);1; //'Policy Coverage BandCode'(loanIndex; TransEffDur);'Policy Jurisdiction';'PI LoanProvision RateVariation TableRefKey'('Policy ProductCode';TransEffDate;'Policy Loan LoanType'(loanIndex)); //Table code'GEN Vector Blank' //  "AgeCalculationType" Not used)
F1 19d9120 19d8d60 d981ea5 0 0 0 2
ULLoan Proj Interest Rate(calcType; yearIndex)
Funktion
IF (('PI LoanProvision LoanIntType'('Policy ProductCode';'Policy Effdate';'Constant LoanType Regular') = 'Constant LoanInt Fixed') ;   'PI LoanProvision RateVariation InvestRate'('Policy ProductCode';'Policy Effdate';'PI LoanProvision LoanIntType'('Policy ProductCode';'Policy Effdate';'Constant LoanType Regular')) ;   Rate('Policy ProductCode';"LOANINT";'Policy Effdate';'ULLoan Proj RateVector'(calcType;yearIndex))) / 100
F1 d981ea5 19d9120 0 0 0 0 2
ULLoan Proj RateVector(calcType; yearIndex)
Funktion
V_('Policy LifeParticipant IssueAge'(calcType;0;0);yearIndex;'Policy LifeParticipant IssueGender'(calcType;0;0);'Policy LifeParticipant UnderwritingClass'(calcType;0;0;yearIndex);'Policy LifeParticipant TobaccoPremiumBasis'(calcType;0;0;yearIndex);1; //'Policy Coverage BandCode'(loanIndex; TransEffDur);'Policy Jurisdiction';'PI LoanProvision RateVariation TableRefKey'('Policy ProductCode';TransEffDate;1); //Table code'GEN Vector Blank' //  "AgeCalculationType" Not used)
F1 19d99e0 19d8b40 19d95e0 0 0 0 2
ULLoan Interest Factor Modal(calcType; yearIndex)
Funktion
IF ( /*Interest is in Advance or Fixed Charged Rate*/ 'PI LoanProvision LoanIntTiming'('Policy ProductCode';'Policy EffDate';'Constant LoanType Regular') = 'Constant IntTiming Arrears' || 'PI LoanProvision LoanIntType'('Policy ProductCode';'Policy Effdate';'Constant LoanType Regular') = 'Constant LoanInt Fixed' ;    /*Yes*/ 1 + 'ULLoan Interest Rate Modal'(calcType;yearIndex) ;    /*No*/ 1 + 'ULLoan Interest Rate Modal'(calcType;yearIndex) / (1 + 'ULLoan Interest Rate Modal'(calcType;yearIndex)))
F1 19d95e0 19d99e0 0 0 0 0 2
ULLoan Interest Rate Modal(calcType; yearIndex)
Funktion
'ULLoan Proj Interest Rate'(calcType;yearIndex)
F1 19d96e8 19ccc08 19d97c0 19db018 0 0 2
-- Loan Stream --
Funktion

F1 19d97c0 19d96e8 19d98d0 19d9ae0 0 0 2
ULLoan RepaymentAmt(calcType; yearIndex; vectorULloans)
Funktion
IF ( /* *Running an illustration*/ 'Std Calling System is Illustration Based' ;    /*Yes*/ CASE('Illus Loan DesignType';    1000500002 : 'ULLoan Premium Amount Solve'(calcType;yearIndex;vectorULloans);    1000500001 : 'ULLoan Illus Loan RepaymentAmt'(calctype;yearIndex;vectorULloans);    1000500003 : 0;     : ERROR("Loan Stream Design Type unknown"))   ;    /*No*/ 'Policy Loan LoanPaymentAmt'(yearIndex))
F1 19d98d0 19d97c0 0 196ff6d9 0 0 2
ULLoan Premium Amount Solve(calcType; yearIndex; vectorULloans)
Funktion
'ULLoan LoanAmt'(calcType;yearIndex;vectorULloans) / 'ACT NPV EOY'('Policy Loan LoanRepayNumYear'(calcType);'ULLoan Proj Interest Rate'(calcType;yearIndex)) // 'ULLoan Curr Interest Rate'(calcType; 'ULLoan Proj StartDate'(calcType; loanIndex; vectorWLProj); loanIndex; 1))
F1 196ff6d9 19d97c0 0 0 0 0 2
ULLoan Illus Loan RepaymentAmt(calcType; yearIndex; vectorULloans)
Funktion
IF ('Illus LoanRepaymentAmt'(yearIndex) = 0 ;   0 ;   MIN('ULLoan Projected Balance'(calcType;yearIndex - 1;'ULLoan Loan Vector Build'(calcType;yearIndex - 1;'SharedVector ULLoans SolveParmsVector'(vectorULloans);'SharedVector ULLoans AddInfoVector'(vectorULloans)));'Illus LoanRepaymentAmt'(yearIndex)))
F1 19d9ae0 19d96e8 0 19d9c38 0 0 2
ULLoan Illus Policy Premium(calcType; yearIndex)
Funktion
IF (yearIndex < 1 ;   0 ;   'ULLoan Illus Policy Premium'(calcType;yearIndex - 1) + SUMX(mnthIndx;1;12;'Std Illustration Premium'(calcType;yearIndex;#mnthIndx)))
F1 19d9c38 19d96e8 19d9d38 19d9e50 0 0 2
ULLoan LoanAmt(calcType; yearIndex; vectorULloans)
Funktion
IF ('ULLoan Illus LoanAmt'(calcType;yearIndex;vectorULloans) <= 0 ;   0 ;   MIN(MAX( //'Illus LoanAmt'('ULLoan Illus Loan YearIndex'(//calcType; 1; loanIndex; vectorULloans)) 'ULLoan Illus LoanAmt'(calcType;yearIndex;vectorULloans) - 'PI LoanProvision MinSingleLoan'('Policy ProductCode';DATE('Policy EffDate';0;0;yearIndex);'Constant LoanType Regular');0) /*end max*/  + 'PI LoanProvision MinSingleLoan'('Policy ProductCode';DATE('Policy EffDate';0;0;yearIndex);'Constant LoanType Regular');'ULLoan Projected Maximum Loan Amount Start of Year'(calcType;yearIndex;vectorULloans)))
F1 19d9d38 19d9c38 0 40895a6 0 0 2
ULLoan Illus Loan YearIndex(calcType; yearCount; loanIndex; vectorULloans)
Funktion
 /*IF ('Policy Number of Loan' > 0 ; IF('ULLoan NumberofLoans'(calcType; yearCount; vectorULloans) - 1 >= loanIndex;yearCount;'ULLoan Illus Loan YearIndex'(calcType; yearCount+ 1; loanIndex; vectorULloans)   ) ;0)*/ 'ULLoan Illus Ln YearIndex'(calcType;0;-1;loanIndex;vectorULloans)
F1 40895a6 19d9c38 0 0 0 0 2
ULLoan Illus Ln YearIndex(calcType; yearCount; LnIdx; loanIndex; vectorULloans )
Funktion
IF (LnIdx = loanIndex || yearCount = 'PIDRV CoverageProduct MaturityDuration'(calcType;'Policy EffDate';0) ;   yearCount - 1 ;   'ULLoan Illus Ln YearIndex'(calcType;yearCount + 1;IF ('ULLoan Illus LoanAmt'(calcType;yearCount;vectorULloans) /*+ 'TradDocs Flex Loan Amount'(calcType;yearCount)*/  > 'PI LoanProvision MinSingleLoan'('Policy ProductCode';'Policy EffDate';'Constant LoanType Regular') ;     LnIdx + 1 ;     LnIdx  );loanIndex;vectorULloans))
F1 19d9e50 19d96e8 0 19da170 0 0 2
ULLoan PaymentMode
Funktion
IF ( /* *Running an illustration*/ 'Std Calling System is Illustration Based' ;    /*Yes*/ 1 ;    /*No*/ 'Policy Loan LoanPaymentMode')
F1 19da170 19d96e8 0 19da270 0 0 2
ULLoan Proj LoanType(calcType; loanIndex; vectorULloans)
Funktion
IF ( /* *Running an illustration*/ 'Std Calling System is Illustration Based' ;    /*True*/ IF ( //'Policy Number Of Loan' > 0 ;'ULLoan NumberofLoans'(calcType;'ULLoan Illus Loan YearIndex'(calcType;1;loanIndex;vectorULloans);vectorULloans) > 0 ;     IF ( //'Illus LoanAmt'('ULLoan Illus Loan YearIndex'(calcType; 1; loanIndex; vectorULloans)) > 'ULLoan Illus LoanAmt'(calcType;'ULLoan Illus Loan YearIndex'(calcType;1;loanIndex;vectorULloans);vectorULloans) > 'ULLoan Projected Maximum Pref Loan Amount Start of Year'(calcType;'ULLoan Illus Loan YearIndex'(calcType;1;loanIndex;vectorULloans);vectorULloans) && loanIndex = 'ULLoan NumberofLoans'(calcType;'ULLoan Illus Loan YearIndex'(calcType;1;loanIndex;vectorULloans);vectorULloans) - 1 ;       1 ;        //Regular Loan2 //Preferred    ) ;   0) ; 'Policy Loan LoanType'(loanIndex))
F1 19da270 19d96e8 0 19da370 0 0 2
ULLoan Proj StartYear(calcType; loanIndex; vectorULloans)
Funktion
IF ( /* *Running an illustration*/ 'Std Calling System is Illustration Based' ;    /*Yes*/ 'ULLoan Illus Loan YearIndex'(calcType;1;loanIndex;vectorULloans) ;    /*No*/ 'Duration year'('Policy Loan LoanOriginationDate'(loanIndex);'Policy EffDate'))
F1 19da370 19d96e8 0 19dad08 0 0 2
ULLoan Proj StartDate(calcType; loanIndex; vectorULloans)
Funktion
IF ( /* *Running an illustration*/ 'Std Calling System is Illustration Based' ;    /*Yes*/ DATE('Policy EffDate';0;0;'ULLoan Illus Loan YearIndex'(calcType;1;loanIndex;vectorULloans) - 1) ;    /*No*/ 'Policy Loan LoanOriginationDate'(loanIndex))
F1 19dad08 19d96e8 19daf10 67918f8a 0 0 2
ULLoan NumberofLoans(calcType; yearIndex; vectorULloans)
Funktion
IF ( /* *Running an illustration*/ 'Std Calling System is Illustration Based' ;    /*Yes*/ IF (yearIndex <= 0 ;     0 ;     'ULLoan NumberofLoans'(calcType;yearIndex - 1;vectorULloans) + 'ULLoan NumberOfLoan in Year'(calcType;yearIndex;vectorULloans)  ) ;  /*No*/ 'Policy Number of Loan')
F1 19daf10 19dad08 0 0 0 0 2
ULLoan NumberOfLoan in Year(calcType; yearIndex; vectorULloans)
Funktion
 /*IF ( //'Policy Number Of Loan' > 0  ; 'ULLoan NumberofLoans'(calcType; yearIndex; vectorULloans)> 0;*/ IF ( //'Illus LoanAmt'(calcType; yearIndex) > 0;'ULLoan Illus LoanAmt'(calcType;yearIndex;vectorULloans) > 0 ;    /*True*/ IF ('ULLoan Projected Maximum Loan Amount Start of Year'(calcType;yearIndex;vectorULloans) > 0 ;      /*True*/ IF ('ULLoan Projected Maximum Pref Loan Amount Start of Year'(calcType;yearIndex;vectorULloans) > 0 && 'Illus LoanAmt'(calcType;yearIndex) //'ULLoan Illus LoanAmt'(yearIndex; vectorULloans)  > 'ULLoan Projected Maximum Pref Loan Amount Start of Year'(calcType;yearIndex;vectorULloans) ;        /*True*/ 1 ;        //changed from 2/*False*/1    ) ;    /*False*/ 0) ;  /*False*/ 0)
F1 67918f8a 19d96e8 0 0 0 0 2
ULLoan Illus LoanAmt(calcType; yearIndex; vectorULloans)
Funktion
IF ('Disbursement Option is Loans'('Illus DisbDesignType') || 'Disbursement Option is Withdrawals Switch to Loans'('Illus DisbDesignType') ;   'Illus LoanAmt'(calcType;yearIndex) + 'ULDisbSolve Loan Amount'(calcType;yearIndex) ;   0) + IF (('Illustration Type is DeferredComp'('STD Illus Type Code') && 'SharedVector ULLoans LoanInfoPassed'(vectorULloans)) ; 'SharedVector ULLoans LoanAmount'(yearIndex;vectorULloans) ; 0)
F1 19db018 19ccc08 19dbe58 4c4dd17 0 0 2
-- Date Functions --
Funktion

F1 19dbe58 19db018 0 19db278 0 0 2
ULLoan Days in Policy Year(date1)
Funktion
IF ( /*On anniversary*/ 'DATE Are Dates Equal'(date1;'Calc Next Anniversary Date'('Policy EffDate';date1)) ;    /*Yes: use this year*/ 'DATE Days Difference'(DATE(date1;0;0;1);date1) ;    /*No: use year that date falls in*/ 'DATE Days Difference'('Calc Next Anniversary Date'('Policy EffDate';date1);DATE('Calc Next Anniversary Date'('Policy EffDate';date1);0;0;-1)))
F1 19db278 19db018 0 19db380 0 0 2
ULLoan Calc Strict Last Anniversary Date(issueDate; pointInTimeDate)
Funktion
IF ( /*If issue date = current date, do not calculate previous anniversary*/ 'DATE Are Dates Equal'(issueDate;pointInTimeDate) ;    /*YesUse current (issue) date*/ issueDate ;    /*No: Calc strict last anniversary*/ 'Calc Last Anniversary Date'(issueDate;DATE(pointInTimeDate;-1;0;0)))
F1 19db380 19db018 0 0 0 0 2
ULLoan Calc Strict Next Anniversary Date(issueDate; pointInTimeDate)
Funktion
'Calc Next Anniversary Date'(issueDate;DATE(pointInTimeDate;1;0;0))
F1 4c4dd17 19ccc08 19c7e636 0 0 0 2
-- Misc --
Funktion

F1 19c7e636 4c4dd17 0 44353d1f 0 0 2
ULLoan Loan Vector Build(calcType; yearIndex; vectorSolveParms; vectorAddlInfo)
Funktion
'CVProjection Build ULloan Vector'(calcType;vectorSolveParms;'ULDocs ProjIntRate'(calcType;yearIndex);vectorAddlInfo;yearIndex)
F1 44353d1f 4c4dd17 0 0 0 0 2
ULLoan Preferred Loans Allowed(calcType)
Funktion
 //'PI PolicyProduct LoanProvision Index'('LoanType Preferred') <> 99ISNUMBER('PI LoanProvision LoanType'('Policy Coverage ProductCode'(calcType;0);'Policy EffDate';'Constant LoanType Preferred'))
A0 3f41f8 0 0 0 0 0 0

T0 3f4264 0 0 0 0 0 0

I0 3f42d0 0 19ddc48 0 0 0 0

I0 19ddc48 3f42d0 0 0 0 0 0
ULSurrenderCharges.pms
-
O0
E0
L0
B0
P2
19cbeb8
19cc7c0
F85
19ccc08
19cce98
19ccf78
19cd0c8
19cd2a0
19cd358
19cdb88
19ce580
19cf970
19cfab8
19cfba0
19cff68
19d0020
19d04c0
19d0880
19d0938
19d0a48
19d0e58
19d1070
19d1188
13919a2c
7ad8137c
55c10139
19d1b78
19d1f88
19d20f0
19d2250
19d2800
19d28e8
19d2b60
19d3570
19d3670
19d37c0
19d3c50
19d42c8
19d43f8
19d48d8
19d4d58
19d4fc8
19d50b8
19d5570
19d5658
19d5768
19d5c50
19d6140
19d6258
19d6918
19d7160
19d7358
19d7a08
19d7f70
19d74b8
19d75f0
19d7738
19d7c10
19d7d20
19d89a8
19d7fe8
19d80e8
19d8200
19d8a20
19d8b40
19d8c20
19d8d60
3612502a
19d9120
d981ea5
19d99e0
19d95e0
19d96e8
19d97c0
19d98d0
196ff6d9
19d9ae0
19d9c38
19d9d38
40895a6
19d9e50
19da170
19da270
19da370
19dad08
67918f8a
19db018
4c4dd17
A0
T0
!144
19cc7c0 3 -1
Description: Returns the total current loan balance at Transaction Effective Date Modification Log:1/12/2011 - PAC013 calcType - BT - Restructure7/2/2010 - PAC013 calcType - BT - Initially adding calcType parm01/18/2008 CSC Initial Calculation/Rule
19cc7c0 4 -1
Description: Returns the total projected loan balance at yearIndex Modification Log:07/10/2013 PA1401-26 KC added yearIndex parm9/2/2011 pA1975 CMC removed vector as an input parm1/12/2011 - PAC013 calcType - BT - Restructure7/2/2010 - PAC013 calcType - BT - Initially adding calcType parm01/18/2008 CSC Initial Calculation/Rule
19cc7c0 5 -1
Description: Returns the current loan balance at Transaction Effective Date Modification Log:1/12/2011 - PAC013 calcType - BT - Restructure7/2/2010 - PAC013 calcType - BT - Initially adding calcType parm01/18/2008 CSC Initial Calculation/Rule
19cc7c0 6 -1
Description: Returns the maximum loan amount available (both standard and preferred loans) Modification Log:1/12/2011 - PAC013 calcType - BT - Restructure7/2/2010 - PAC013 calcType - BT - Initially adding calcType parm01/18/2008 CSC Initial Calculation/Rule
19cc7c0 7 -1
Description: Returns the total Capitalized Interest Modification Log:9/2/2011 pA1975 CMC referenced new Loan PI functions and new interest method constant.1/12/2011 - PAC013 calcType - BT - Restructure7/2/2010 - PAC013 calcType - BT - Initially adding calcType parm5/14/2009 - PA1013 - wdp - Added loanIndex parameter to output03/26/2008 CSC Initial Calculation/Rule
19cc7c0 8 -1
Description: Returns the Capitalized Interest by loanIndex Modification Log:9/2/2011 pA1975 CMC referenced new Loan PI functions and new interest method constant.1/12/2011 - PAC013 calcType - BT - Restructure7/2/2010 - PAC013 calcType - BT - Initially adding calcType parm5/14/2009 -PA1013 - wdp - Additional loanIndex parameter to Policy Loan LoanIntMethod03/26/2008 CSC Initial Calculation/Rule
19cc7c0 9 -1
Description: Returns the total Capitalized Interest Modification Log:07/10/2013 PA1401-26 KC added yearIndex parm9/2/2011 pA1975 CMC removed loan index and vector parms1/12/2011 - PAC013 calcType - BT - Restructure7/2/2010 - PAC013 calcType - BT - Initially adding calcType parm5/14/2009 -PA1013 - wdp - Added loanIndex parameter to output03/26/2008 CSC Initial Calculation/Rule
19cc7c0 10 -1
Description: Returns the Maximum Preferred Loan Amount Modification Log:01/08/2009VPM028Initial Calculation/Rule
19cc7c0 11 -1
Modification Log:07/10/2013 PA1401-26 KC added yearIndex parm9/2/2011 pA1975 CMC added output
19cc7c0 12 -1
Modification Log:07/10/2013 PA1401-26 KC added yearIndex parm9/2/2011 pA1975 CMC added output
19ccf78 -2 -2
Description: Returns the total current loan balance at Transaction Effective Date Modification Log:7/2/2010 - PAC013 calcType - BT - Initially adding calcType parm01/24/2008 Allowed for FIFO processing of repayments01/22/2008 Seperated Proj & Current calculations01/18/2008 CSC Initial Calculation/Rule
19ccf78 0 1

19cd0c8 -2 -2
Description: Returns the current loan balance at Transaction Effective Date Modification Log:7/2/2010 - PAC013 calcType - BT - Initially adding calcType parm5/14/2009 - PA1013 - wdp - Additional loanIndex parameter to Policy Loan LoanIntMethod01/24/2008 Allowed for FIFO processing of repayments01/22/2008 Seperated Proj & Current calculations01/18/2008 CSC Initial Calculation/Rule
19cd0c8 0 2

19cd2a0 -2 -2
Description: Returns the current loan balance at a specific time Modification Log:7/2/2010 - PAC013 calcType - BT - Initially adding calcType parm01/24/2008 Allowed for FIFO processing of repayments01/22/2008 Seperated Proj & Current calculations01/18/2008 CSC Initial Calculation/Rule
19cd2a0 0 1

19cd358 -2 -2
Description: Returns the loan debit balance accrual till end Date Modification Log:9/2/2011 pA1975 CMC removed loan index7/2/2010 - PAC013 calcType - BT - Initially adding calcType parm01/24/2008 Modified to use per loan processing01/22/2008 CSC Initial Calculation/Rule
19cd358 0 2

19cdb88 -2 -2
Description: Returns the loan activity over the period Modification Log:9/2/2011 pA1975 CMC removed loan index7/2/2010 - PAC013 calcType - BT - Initially adding calcType parm03/24/2008 Corrected yearly accraul (for interest rate tat varies by year)01/24/2008 Modified to include 'At Issue' function01/22/2008 CSC Initial Calculation/Rule
19ce580 -2 -2
Description: Returns the loan repayments for period Modification Log:7/2/2010 - PAC013 calcType - BT - Initially adding calcType parm01/31/2008 Modified to use sum of payments on day, if multiple payment occur on the same day01/24/2008 Modified to include both cash & dividend payments01/22/2008 CSC Initial Calculation/Rule
19ce9b8 -2 -2
Description: Returns the amount of the payment relevant to a specific loan, using FIFO logic Modification Log:9/2/2011 pA1975 CMC removed loan index7/2/2010 - PAC013 calcType - BT - Initially adding calcType parm01/31/2008 Modification: Rounding Error Fixed01/24/2008 CSC Initial Calculation/Rule
19cf060 -2 -2
Description: Returns the total loan repayments on a day (if multiple occur) Modification Log:01/31/2008 CSC Initial Calculation/Rule01/24/2008 Modified to include both cash & dividend payments
19cf970 -2 -2
Description: Returns the total capitalized interest Modification Log:7/2/2010 - PAC013 calcType - BT - Initially adding calcType parm03/25/2008 CSC Initial Calculation/Rule
19cfab8 -2 -2
Description: Returns the capitalized interest per loanIndex Modification Log:7/2/2010 - PAC013 calcType - BT - Initially adding calcType parm03/25/2008 CSC Initial Calculation/Rule
19cfba0 -2 -2
Description: Returns the capitalized interest at a time Modification Log:7/2/2010 - PAC013 calcType - BT - Initially adding calcType parm03/25/2008 CSC Initial Calculation/Rule
19cfba0 0 2

19cff68 -2 -2
Description: Returns the base loan amount (excl capitalized interest) at a time Modification Log:7/2/2010 - PAC013 calcType - BT - Initially adding calcType parm03/25/2008 CSC Initial Calculation/Rule
19cff68 0 1

19d0020 -2 -2
Description: Calculates the base loan amount (excl capitalized interest) Modification Log:7/2/2010 - PAC013 calcType - BT - Initially adding calcType parm12/08/2008 TB: Removed max check and added check at top to determine if transaction < startdate12/03/2008 CSC added max check in case no financial activity03/25/2008 CSC Initial Calculation/Rule
19d0020 0 1

19d0880 -2 -2
Description: Returns the total projected loan balance Modification Log:9/2/2011 pA1975 CMC removed loan index from lower function so SUMX no longer necessary08/22/2011 pA Regression CMC updated for new product definition items.7/2/2010 - PAC013 calcType - BT - Initially adding calcType parm09/22/2009 CMC added check for loans in order to avoid unnecessary input01/22/2008 Seperated Proj & Current calculations01/18/2008 CSC Initial Calculation/Rule
19d0938 -2 -2
Description: Returns the projected loan balance Modification Log:4/22/2014 - pA1501 - rm - Replaced standard function ROUND with 'GEN Round'9/2/2011 pA1975 CMC removed loan index7/2/2010 - PAC013 calcType - BT - Initially adding calcType parm01/22/2008 Seperated Proj & Current calculations01/18/2008 CSC Initial Calculation/Rule
19d0a48 -2 -2
Description: Returns the projected loan balance with dividends Modification Log:9/2/2011 pA1975 CMC removed loan index8/22/2011 pA1975 CMC updatd to build the correct loan vector for calls to previous years.7/2/2010 - PAC013 calcType - BT - Initially adding calcType parm10/29/2008 CSC added vectorULloans to interest factor modal, changed < to <= to get around projected interest lookup for year zero01/31/2008 Modified Advance Loan Projections01/22/2008 CSC Initial Calculation/Rule
19d0e58 -2 -2
Description: Returns the projected loan premium repayments for a period Modification Log:9/2/2011 pA1975 CMC removed loan index7/2/2010 - PAC013 calcType - BT - Initially adding calcType parm11/24/2009 PAC002 DT changed parameter to the correct vectorULloans02/19/2008 Modified to use Annuity function01/31/2008 Modified Advance Loan Projections01/22/2008 CSC Initial Calculation/Rule
19d1070 -2 -2
Description: Returns the total capitalized interest Modification Log:9/2/2011 pA1975 CMC removed loan index from lower function so SUMX no longer necessary7/2/2010 - PAC013 calcType - BT - Initially adding calcType parm03/25/2008 CSC Initial Calculation/Rule
19d1188 -2 -2
Description: Returns the capitalized interest per loanIndex Modification Log:9/2/2011 pA1975 CMC removed loan index08/22/2011 pA1975 CMC updated for at loan start calc7/2/2010 - PAC013 calcType - BT - Initially adding calcType parm03/25/2008 CSC Initial Calculation/Rule
13919a2c -2 -2
Description:  Calculates the preferred loan balance Modification Log:9/2/2011 pA1975 CMC Initial Function
7ad8137c -2 -2
Description:  Calculates the regular loan balance Modification Log:9/2/2011 pA1975 CMC Initial Function
55c10139 -2 -2
Modification Log:9/2/2011 pA1975 CMC added Function
19d1f88 -2 -2
Description: Returns the maximum loan amount available Modification Log:7/2/2010 - PAC013 calcType - BT - Initially adding calcType parm01/18/2008 CSC Initial Calculation/Rule
19d1f88 0 2

19d20f0 -2 -2
Modification Log:7/2/2010 - PAC013 calcType - BT - Initially adding calcType parm
19d20f0 0 1

19d2250 -2 -2
Description: first minimum balance rule used to determine maximum loan calculations. Modification Log:08/22/2011 pA1975 CMC updates for key changes in product definition7/2/2010 - PAC013 calcType - BT - Initially adding calcType parm11/14/2008 CMC Initial Calc
19d2800 -2 -2
Description: Second minimum balance rule used to determine maximum loan calculations. Modification Log:08/22/2011 pA1975 CMC updates for key changes in product definition7/2/2010 - PAC013 calcType - BT - Initially adding calcType parm11/14/2008 CMC Initial Calc
19d28e8 -2 -2
Description: Third minimum balance rule used to determine maximum loan calculations. Modification Log:08/22/2011 pA1975 CMC updates for key changes in product definition7/2/2010 - PAC013 calcType - BT - Initially adding calcType parm11/14/2008 CMC Initial Calc
19d2b60 -2 -2
Description: Returns minimum loan balance amount for a specified duration Modification Log:08/22/2011 pA1975 CMC updates for key changes in product definition7/2/2010 - PAC013 calcType - BT - Initially adding calcType parm11/14/2008 CMC Loan Clean up02/08/2008 CSC Initial Calculation/Rule
19d3570 -2 -2
Modification Log:7/2/2010 - PAC013 calcType - BT - Initially adding calcType parm
19d3670 -2 -2
Modifications log:10/14/2008 CSC corrected name of function by adding "Std"
19d37c0 -2 -2
Description: Returns surrende value Modification Log:01/21/2008 CSC Initial Calculation/Rule
19d3c50 -2 -2
Description: Returns Interest Deduction Modification Log:9/2/2011 pA1975 CMC Updated for new Loan PI functions7/2/2010 - PAC013 calcType - BT - Initially adding calcType parm01/21/2008 CSC Initial Calculation/Rule
19d3d08 -2 -2
Modification Log:7/2/2010 - PAC013 calcType - BT - Initially adding calcType parm
19d3e10 -2 -2
Modification Log:7/2/2010 - PAC013 calcType - BT - Initially adding calcType parm
19d42c8 -2 -2
Description: Returns the total current unloaned cash value Modification Log:7/2/2010 - PAC013 calcType - BT - Initially adding calcType parm01/18/2008 CSC Initial Calculation/Rule
19d42c8 0 1

19d43f8 -2 -2
Description: Returns the maximum preferred loan amount available Modification Log:9/2/2011 pA1975 CMC Update for PI function change01/18/2008 CSC Initial Calculation/Rule
19d48d8 -2 -2
Description: Validates whether a Preferred Loan is available. Returns 0 if passed. Modification Log:08/22/2011 pA1975 CMC updates for key changes in product definition02/11/2008 CSC Initial Calculation/Rule
19d4d58 -2 -2
Description: Validates first Preferred Loan of duration year. Returns 0 if passed. Modification Log:02/11/2008 CSC Initial Calculation/Rule
19d4fc8 -2 -2
Description: Validates current duration compared with minimum for Preferred Loans. Returns 0 if passed. Modification Log:08/22/2011 pA1975 CMC updates for key changes in product definition02/11/2008 CSC Initial Calculation/Rule
19d4fc8 0 2

19d50b8 -2 -2
Description: Returns the premium payments for current loan calculations Modification Log:02/11/2008 CSC Initial Calculation/Rule
19d5658 -2 -2
Description: Returns the projected maximum loan amount available at the end of the year Modification Log:7/2/2010 - PAC013 calcType - BT - Initially adding calcType parm02/08/2008 CSC Initial Calculation/Rule
19d5768 -2 -2
7/2/2010 - PAC013 calcType - BT - Initially adding calcType parm
19d5c50 -2 -2
Description: first minimum balance rule used to determine maximum loan calculations. Modification Log:08/22/2011 pA1975 CMC updated for new product definition items.7/2/2010 - PAC013 calcType - BT - Initially adding calcType parm11/14/2008 CMC Initial Calc
19d6140 -2 -2
Description: Second minimum balance rule used to determine maximum loan calculations. Modification Log:08/22/2011 pA1975 CMC updated for new product definition items.7/2/2010 - PAC013 calcType - BT - Initially adding calcType parm11/14/2008 CMC Initial Calc
19d6258 -2 -2
Description: Third minimum balance rule used to determine maximum loan calculations. Modification Log:08/22/2011 pA1975 CMC updated for new product definition items.7/2/2010 - PAC013 calcType - BT - Initially adding calcType parm11/14/2008 CMC Initial Calc
19d6918 -2 -2
Description: Returns projected minimum loan balance amount for a specified duration Modification Log:08/22/2011 pA1975 CMC updated for new product definition items.7/2/2010 - PAC013 calcType - BT - Initially adding calcType parm11/24/2009 PAC002 DT Under 8: change start & end Dates from policy eff date till current, to current to next year. Loan interest from now till the next anniversary should be considered.11/14/2008 CMC Loan Clean up10/28/2008 CSC check for null/blank from table to avoid "number expected error"02/08/2008 CSC Initial Calculation/Rule
19d7160 -2 -2
Description: Returns projected surrende value Modification Log:1/26/2011 - PAC013 CMC removed extra coverage and coverage option index1/12/2011 - PAC013 calcType - BT - Restructure7/2/2010 - PAC013 calcType - BT - Initially adding calcType parm02/08/2008 CSC Initial Calculation/Rule
19d7358 -2 -2
Description: Returns projected Interest Deduction Modification Log:9/2/2011 pA1975 CMC removed loan index so SUMX no longer necessary7/2/2010 - PAC013 calcType - BT - Initially adding calcType parm02/08/2008 CSC Initial Calculation/Rule
19d7a08 -2 -2
Modification Log:9/2/2011 pA1975 CMC removed loan index7/2/2010 - PAC013 calcType - BT - Initially adding calcType parm
19d7f70 -2 -2
Modification Log:9/2/2011 pA1975 CMC removed loan index7/2/2010 - PAC013 calcType - BT - Initially adding calcType parm
19d74b8 -2 -2
Modification Log:1/26/2011 - PAC013 CMC removed extra coverage and coverage option index1/12/2011 - PAC013 calcType - BT - Restructure7/2/2010 - PAC013 calcType - BT - Initially adding calcType parm
19d7738 -2 -2
Description: Returns the projected maximum loan amount available, at the start of the year Modification Log:7/2/2010 - PAC013 calcType - BT - Initially adding calcType parm10/29/2008 CSC removed at inception check as UL can have loan in first year02/21/2008 CSC Initial Calculation/Rule
19d7c10 -2 -2
Description: Returns the total projected unloaned cash value Modification Log:7/2/2010 - PAC013 calcType - BT - Initially adding calcType parm02/08/2008 CSC Initial Calculation/Rule
19d7d20 -2 -2
Description: Returns the projected maximum preferred loan amount available at the end of the year Modification Log:08/22/2011 pA1975 CMC updated for new product definition items.7/2/2010 - PAC013 calcType - BT - Initially adding calcType parm11/24/2009 - PAC002 - DT - TEMP Do not allow pref loans under SERP02/08/2008 CSC Initial Calculation/Rule
19d89a8 -2 -2
Description: Returns the projected maximum preferred loan amount available at the start of the year Modification Log:7/2/2010 - PAC013 calcType - BT - Initially adding calcType parm02/21/2008 CSC Initial Calculation/Rule
19d7fe8 -2 -2
Description: Validates whether a Preferred Loan is available. Returns 0 if passed. Modification Log:08/22/2011 pA1975 CMC updated for new product definition items.7/2/2010 - PAC013 calcType - BT - Initially adding calcType parm02/11/2008 CSC Initial Calculation/Rule
19d80e8 -2 -2
Description: Validates first Preferred Loan of duration year. Returns 0 if passed. Modification Log:11/11/2010 pA Regression Testing CMC change to count based on loan amount instead of loan count input7/2/2010 - PAC013 calcType - BT - Initially adding calcType parm02/11/2008 CSC Initial Calculation/Rule
19d8200 -2 -2
Description: Validates current duration compared with minimum for Preferred Loans. Returns 0 if passed. Modification Log:08/22/2011 pA1975 CMC updated for new product definition items.02/11/2008 CSC Initial Calculation/Rule
19d8a20 -2 -2
Description: Returns the premium payments for projection loan calculations Modification Log:02/11/2008 CSC Initial Calculation/Rule
19d8c20 -2 -2
Description: Returns the present value of regular modal cash values at a fixed interest rate over the period Modification Log:02/19/2008 CSC Initial Calculation/Rule
19d8d60 -2 -2
Description: Returns the loan interest factor over a period.  Determines the Interest Factor due for the period from 'startDate' to 'endDate', at given force of interest 'rate' Modification Log:9/2/2011 pA1975 CMC removed loan index01/18/2008 CSC Initial Calculation/Rule
19d8d60 0 2

3612502a -2 -2
Description: Returns the loan interest rate Modification Log:07/10/2013 PA1401-26 KC added yearIndex parm8/24/2010 - PAC019 - Rate Access Var - BT - change input8/13/2010 - PAC019 Rate Access Var - BT - change name8/11/2010 - PAC019 Rate Access Var - BT - add rate input7/2/2010 - PAC013 calcType - BT - Initially adding calcType parm01/31/2008 Modfied LoanIntType to include loanIndex01/25/2008 Modified to use RWL1PA rate access for variable rate01/18/2008 CSC Initial Calculation/Rule
8219a0f -2 -2
Description: Returns the vector used for rate model lookups Modification Log:05/05/2014 - CL1401 - rm - Restored original function parameter order to (calcType; yearIndex; loanIndex)07/10/2013 PA1401-26 KC added yearIndex parm06/20/2012 pA2118 CMC Change TableIdentity to TableRefKey7/2/2010 - PAC013 calcType - BT - Initially adding calcType parm11/24/2009 PAC002 DT added02/08/2008 CSC Initial Calculation/Rule
19d9120 -2 -2
Description: Returns the loan interest rate Modification Log:9/2/2011 pA1975 CMC removed loan index8/26/2011 pA1975 CMC updated for fixed and variable interest8/13/2010 - PAC019 Rate Access Var - BT - change name8/11/2010 - PAC019 Rate Access Var - BT - add rate input7/2/2010 - PAC013 calcType - BT - Initially adding calcType parm01/31/2008 Modfied LoanIntType to include loanIndex01/25/2008 Modified to use RWL1PA rate access for variable rate01/18/2008 CSC Initial Calculation/Rule
d981ea5 -2 -2
Description: Returns the vector used for rate model lookups Modification Log:07/10/2013 PA1401-26 KC added yearIndex parm06/20/2012 pA2118 CMC Change TableIdentity to TableRefKey9/2/2011 pA1975 CMC removed loan index7/2/2010 - PAC013 calcType - BT - Initially adding calcType parm02/08/2008 CSC Initial Calculation/Rule
19d99e0 -2 -2
Description: Returns the loan interest factor for projections Modification Log:9/2/2011 pA1975 CMC removed loan index, mode factor, and vector.  Adde yearIndex08/26/2011 pA1975 CMC Updated to calc rate for Advanced Variable interest only.7/2/2010 - PAC013 calcType - BT - Initially adding calcType parm10/29/2008 CSC added vectorulloans to parm for interest rate modal, commented out modefactor as not parm to function01/24/2008 CSC Initial Calculation/Rule
19d95e0 -2 -2
Description: Returns the modal loan interest rate for projections Modification Log:9/2/2011 pA1975 CMC removed loan index7/2/2010 - PAC013 calcType - BT - Initially adding calcType parm10/31/2008 CSC removed divide by 100 as already done01/24/2008 CSC Initial Calculation/Rule
19d97c0 -2 -2
Description: Returns the repayment amount, depending on the use (calculation / illustration) Modification Log:9/2/2011 pA1975 CMC removed loan index08/22/2011 pA1975 CMC updated to use new loan repayment allocation function7/2/2010 - PAC013 calcType - BT - Initially adding calcType parm06/19/2009 - PA1277 - wdp -  Fixed 'Policy Loan LoanPaymentAmt'(yearIndex) and changed to 'Policy Loan LoanPaymentAmt'(loanIndex)02/08/2008 CSC Initial Calculation/Rule
19d98d0 -2 -2
Modification Log:9/2/2011 pA1975 CMC removed loan index7/2/2010 - PAC013 calcType - BT - Initially adding calcType parm
196ff6d9 -2 -2
Description:  Calculations the amount of loan repayment to apply to each loan segment. Modifcation Log:9/2/2011 pA1975 CMC  Initial Function
19d9ae0 -2 -2
Modification Log :7/2/2010 - PAC013 calcType - BT - Initially adding calcType parm11/10/2009 - PA1001 - NT - performance enhancements
19d9c38 -2 -2
Description: Returns the loan principle amount, depending on the use (calculation / illustration) Modification Log:9/2/2011 pA1975 CMC removed loan index08/22/2011 pA1975 CMC updates for key changes in product definition7/2/2010 - PAC013 calcType - BT - Initially adding calcType parm11/24/2009 PAC002 DT Use "Loan Illus LoanAmt". This includes loans other than from inputs.11/04/2008 CSC added check for number of loans so does not require all attributes if no loans present02/08/2008 CSC Initial Calculation/Rule
19d9d38 -2 -2
Description: Returns the year index, for use in illustrations Modification Log:7/2/2010 - PAC013 calcType - BT - Initially adding calcType parm11/24/2009 PAC002 DT corrected12/03/2008 CSC Added policy number of loans check02/08/2008 CSC Initial Calculation/Rule
40895a6 -2 -2
Modification log:10/07/2010 pA1975 CMC updates for key changes in product definition and stop at Maturity instead of 121.7/2/2010 - PAC013 calcType - BT - Initially adding calcType parm11/24/2009 - PAC002 - DL - Use "Loan Illus LoanAmt". This includes loans other than from inputs.
19d9e50 -2 -2
Description: Returns the payment mode, depending on the use (calculation / illustration) Modification Log:9/2/2011 pA1975 CMC removed loan index02/08/2008 CSC Initial Calculation/Rule
19da170 -2 -2
Descripton:  Sets the type of loan (preferred vs regular loans) Modifications log:7/2/2010 - PAC013 calcType - BT - Initially adding calcType parm11/24/2009 PAC002 DT use NumberofLoans function11/7/2008 CSC added check for number of loans so all attributes not needed if no loans
19da270 -2 -2
Description: Returns the start year of a loan, for use in illustrations Modification Log:7/2/2010 - PAC013 calcType - BT - Initially adding calcType parm02/08/2008 CSC Initial Calculation/Rule
19da370 -2 -2
Description: Returns the start date of a loan, for use in illustrations Modification Log:7/2/2010 - PAC013 calcType - BT - Initially adding calcType parm02/08/2008 CSC Initial Calculation/Rule
19dad08 -2 -2
Description: Returns the number of loans, depending on the use (calculation / illustration) Modification Log:7/2/2010 - PAC013 calcType - BT - Initially adding calcType parm02/08/2008 CSC Initial Calculation/Rule
19daf10 -2 -2
Description:  Number of loans in a given policy year. Modifications log:08/22/2011 pA1975 CMC preferred loans no longer considered a separate loan so changed the number from 2 to 17/2/2010 - PAC013 calcType - BT - Initially adding calcType parm11/24/2009 PAC002 DT Use "Loan Illus LoanAmt". This includes loans other than from inputs.11/4/2008 CSC added policy number of loan check
67918f8a -2 -2
Description: Loan Amount requested Modification Log:10/11/2011 pA Regression CMC added withdrawals switching to loans.08/22/2011 pA1975 CMC added call to disbursement solve loans.11/11/2010 pA Regression Testing CMC change to look for illustration distribution type instead of loan count.7/2/2010 - PAC013 calcType - BT - Initially adding calcType parm06/17/2010 - Performance - rm - Rearranged calc.  Only get illus loan input if loans are being illustrated.11/24/2009 PAC002 DT added
19dbe58 -2 -2
Description: Returns number of days in a policy year Modification Log:01/18/2008 CSC Initial Calculation/Rule
19db278 -2 -2
Description: Returns previous policy anniversary; if on anniversary, returns the previous anniversary (one year ago). Modification Log:01/22/2008 CSC Initial Calculation/Rule
19db380 -2 -2
Description: Returns next policy anniversary; if on anniversary, returns the next anniversary (one year in time). Modification Log:01/22/2008 CSC Initial Calculation/Rule
19c7e636 -2 -2
Description:  Calls function that builds Loan Vector  Modification Log:9/2/2011 pA1975 CMC Initial Function
44353d1f -2 -2
Modification Log:9/2/2011 pA1975 CMC initial function
3f60a8 -2 -2
Twice the loan as described below. Expect 1795 (897.5 * 2)
3f63b0 -2 -2
Loan of 1000 acrrued for two years at 5%, with repayments of 100 at the end of the years. Expect 897.5 ((1000*1.05 - 100) * 1.05 -100)
3fdbd0 -2 -2
Maximum Loan Amount for WL1PA product. Expect 28083.52 (See below)
3fe650 -2 -2
With unloaned Cash Value of 30610.40, and existing loan with balance 1000, the maximum new loan such that the total loan balance on anniversary (including interest at 5.25%) is that CV, is 28083.52 ((28083.52+1000)*1.0525 = 30610.40). Expect 1526.885. (30610.40 - 28083.52 - 1000)
3ff940 -2 -2
From WLCashValueProjections. Expect 30610.404.
19a26c8 -2 -2
With unloaned Cash Value of 30610.40 the maximum new loan such that the total loan balance on anniversary (including interest at 5%) is that CV, is 29152.77 (29152.77*1.05 = 30610.40). Expect 1457.638 (30610.40 - 29152.77)
19a3568 -2 -2
Modal payments of 5200 semi-annually for 5 years (including first payment of new year). Expect 57200 (5200 * (5 * 2 +1))
19a5300 -2 -2
Maximum Projected Loan Amount for WL1PA. Expect 213350.20 (see below)
19a7178 -2 -2
Loan Interest Factor for current calculations. Expect 1.05 (annual- one year, arrears)
19a73e0 -2 -2
For illustrations use mode 1 (annual). Expect 1.
19a75a8 -2 -2
Loan Stream number of loans, with one extra loan. Expect 2.
19a8290 -2 -2
Commented out due to stack overflow. Sucessfully runs externally.
19b5280 -2 -2
Non Leap Year. Expect 365.
19b5440 -2 -2
Leap Year. Expect 366.
19b55e8 -2 -2
Strict last anniversary. Expect 01/01/2007.
19b5698 -2 -2
Strict next anniversary. Expect 01/01/2009.
19b5bc8 -2 -2
Maximum Projected Loan Amount for WL1PA. Expect 213350.20 (see below)
19b9878 -2 -2
Total Loan Balance (two loans as set out below). Expect 1552.4375 (999.875 + 552.5625)
19ba0e8 -2 -2
Loan (0) of 1000, accrued for one year at 5%, then repayment of 100, all accrued for one year at 5.25%. Expect 999.875 ((1000*1.05 - 100)*1.0525)
19bada8 -2 -2
Loan (1) of 500, accrued for one year at 5%, repayment goes to Loan (0), all accrued for one year at 5.25%. Expect 552.5625 (500*1.05*1.0525)
19bb458 -2 -2
Loan (0) of 1000, accrued for one year at 5%, then repayment of 100, all accrued for one year at 5.25%. Expect 999.875 ((1000*1.05 - 100)*1.0525)
19bbde8 -2 -2
Accrual of Loan (0) Balance 1000 at LIR of 5% for one year. Expect 1050 (1000*1.05)
19bc560 -2 -2
Accrual of 1000 at LIR of 5% for one year. Expect 1050 (1000*1.05)
19bcb90 -2 -2
Two loans of 1000 each, repayments total 1500. Expect repayments for loan (1) 500 - interest on loan (0) for a year (at 5%): 1500 - 1000*(1.05) = 450
19bd210 -2 -2
Loan (0) & (1) 1000 & 2000 outstanding each. Payment of 1500. Loan (1) gets remainder after paying Loan (0). Expect 500 (1500 - 1000).
19be270 -2 -2
Current financial activity (1), with no lower (0) and one higher (2) indexed activity on the same day. Expect 250 (150 + 100)
19bed50 -2 -2
Financial activity 1, with a lower indexed activity (0) on the same day. Expect 0.
19beef0 -2 -2
Projected CV of 1267444.10 (from WLCVProj), premiums payments total of 60000. For WL1PA Max Pref Loan Amount is CV - total premiums. Expect 1207444.10 (1267444.10 - 60000)
19bf430 -2 -2
Projected CV of 1267444.10 (from WLCVProj), premiums payments total of 60000. For WL1PA Max Pref Loan Amount is CV - total premiums. Expect 1207444.10 (1267444.10 - 60000)
19c36d8 -2 -2
Projected CV of 85588.90 (from WLCVProj), premiums payments total of 57200. For WL1PA Max Pref Loan Amount is CV - total premiums. Expect 28388.90 (85588.90 - 57200)
19c5700 -2 -2
Preferred loan validation. For WL1PA preferred loans available after 5 years- currently in year 6. Expect 1 (valid).
19c6300 -2 -2
Total Loan Balance (two loans as set out below). Expect 1552.4375 (999.875 + 552.5625)
19c7458 -2 -2
Loan (0) of 1000, accrued for one year at 5%, then repayment of 100, all accrued for one year at 5.25%. Expect 999.875 ((1000*1.05 - 100)*1.0525)
19c7ef8 -2 -2
Loan (1) of 500, accrued for one year at 5%, repayment goes to Loan (0), all accrued for one year at 5.25%. Expect 552.5625 (500*1.05*1.0525)
19c85b0 -2 -2
Cash Value from WLCashValueProjections of 30610.404. Loan of 1000, immediately. Expect 29610.404 (30610.404 - 1000)
19c90d0 -2 -2
With unloaned Cash Value of 30610.40, and existing loan with balance 1000, the maximum new loan such that the total loan balance on anniversary (including interest at 5%) is that CV, is 28152.77 ((28152.77+1000)*1.05 = 30610.40). Expect 1457.638 (30610.40 - 28152.77 - 1000)
;Offset=00000000
